System.register(["./three-legacy-Cqe1lxw8.js"],function(t,e){"use strict";var s,i,n,a,o,r,c,h,d,l,u,p,w;return{setters:[t=>{s=t.W,i=t.P,n=t.S,a=t.a,o=t.A,r=t.D,c=t.b,h=t.M,d=t.c,l=t.d,u=t.C,p=t.e,w=t.V}],execute:function(){const t="gameCanvas",e="loading",m="ui";class v{constructor(){this.scene=null,this.camera=null,this.renderer=null,this.canvas=null,this.isLoaded=!1,this.isMobile=this.detectMobile(),this.starCount=0,this.levelNumber=1,console.log("üåä Ocean Adventure - Initializing...")}async initialize(){try{this.setupCanvas(),this.setupRenderer(),this.setupScene(),this.setupCamera(),this.setupLights(),this.setupEventListeners(),this.hideLoading(),this.showUI(),this.startGameLoop(),this.isLoaded=!0,console.log("üéÆ Ocean Adventure - Ready to play!")}catch(t){console.error("‚ùå Failed to initialize game:",t)}}setupCanvas(){if(this.canvas=document.getElementById(t),!this.canvas)throw new Error("Game canvas not found")}setupRenderer(){this.renderer=new s({canvas:this.canvas,antialias:!this.isMobile,alpha:!1}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.setClearColor(4386,1),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=i}setupScene(){this.scene=new n,this.createUnderwaterEnvironment(),this.createPlayer(),this.createSampleStars()}setupCamera(){this.camera=new a(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,5,10),this.camera.lookAt(0,0,0)}setupLights(){const t=new o(4210816,.4);this.scene.add(t);const e=new r(8900331,.8);e.position.set(0,50,0),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,this.scene.add(e)}createUnderwaterEnvironment(){const t=new c(100,100),e=new h({color:9127187}),s=new d(t,e);s.rotation.x=-Math.PI/2,s.position.y=-5,s.receiveShadow=!0,this.scene.add(s);for(let i=0;i<10;i++){const t=new l(.5+1.5*Math.random()),e=new h({color:(new u).setHSL(.3*Math.random(),.7,.5)}),s=new d(t,e);s.position.set(80*(Math.random()-.5),2*Math.random()-4,80*(Math.random()-.5)),s.castShadow=!0,this.scene.add(s)}}createPlayer(){const t=new p(.5,1.5),e=new h({color:65416});this.player=new d(t,e),this.player.position.set(0,0,0),this.player.castShadow=!0,this.scene.add(this.player)}createSampleStars(){this.stars=[];for(let t=0;t<5;t++){const t=new l(.3),e=new h({color:16766720,emissive:16766720,emissiveIntensity:.3}),s=new d(t,e);s.position.set(20*(Math.random()-.5),8*Math.random()-2,20*(Math.random()-.5)),s.userData={rotationSpeed:.02+.02*Math.random()},this.stars.push(s),this.scene.add(s)}}setupEventListeners(){window.addEventListener("resize",()=>this.onWindowResize()),window.addEventListener("keydown",t=>this.onKeyDown(t)),this.isMobile&&this.setupTouchControls()}setupTouchControls(){this.setupVirtualJoystick(),this.setupMobileButtons(),this.touchState={startX:0,startY:0,currentX:0,currentY:0,isActive:!1},this.canvas.addEventListener("touchstart",t=>{if(t.preventDefault(),t.touches.length>0){const e=t.touches[0];this.touchState.startX=e.clientX,this.touchState.startY=e.clientY,this.touchState.currentX=e.clientX,this.touchState.currentY=e.clientY,this.touchState.isActive=!0}}),this.canvas.addEventListener("touchmove",t=>{if(t.preventDefault(),t.touches.length>0&&this.touchState.isActive){const e=t.touches[0];this.touchState.currentX=e.clientX,this.touchState.currentY=e.clientY;const s=this.touchState.currentX-this.touchState.startX,i=this.touchState.currentY-this.touchState.startY,n=.05,a=3;Math.abs(s)>20&&(this.player.position.x+=s/a*n*.01),Math.abs(i)>20&&(this.player.position.z+=i/a*n*.01),this.updateCamera()}}),this.canvas.addEventListener("touchend",t=>{t.preventDefault(),this.touchState.isActive=!1}),this.canvas.addEventListener("touchcancel",t=>{t.preventDefault(),this.touchState.isActive=!1})}setupVirtualJoystick(){const t=document.getElementById("virtualJoystick"),e=document.getElementById("joystickKnob");if(!t||!e)return;const s={isActive:!1,centerX:0,centerY:0,currentX:0,currentY:0};t.addEventListener("touchstart",i=>{if(i.preventDefault(),i.stopPropagation(),i.touches.length>0){const n=i.touches[0],a=t.getBoundingClientRect();s.isActive=!0,s.centerX=a.left+a.width/2,s.centerY=a.top+a.height/2,s.currentX=n.clientX,s.currentY=n.clientY,this.updateJoystickKnob(e,s,a)}}),t.addEventListener("touchmove",i=>{if(i.preventDefault(),i.stopPropagation(),i.touches.length>0&&s.isActive){const n=i.touches[0],a=t.getBoundingClientRect();s.currentX=n.clientX,s.currentY=n.clientY;const o=s.currentX-s.centerX,r=s.currentY-s.centerY,c=Math.sqrt(o*o+r*r),h=a.width/2-20;if(c>5){const t=o/h,e=r/h;this.player.position.x+=.15*t*.03,this.player.position.z+=.15*e*.03,this.updateCamera()}this.updateJoystickKnob(e,s,a)}}),t.addEventListener("touchend",t=>{t.preventDefault(),t.stopPropagation(),s.isActive=!1,e.style.transform="translate(-50%, -50%)"}),t.addEventListener("touchcancel",t=>{t.preventDefault(),t.stopPropagation(),s.isActive=!1,e.style.transform="translate(-50%, -50%)"})}updateJoystickKnob(t,e,s){const i=e.currentX-e.centerX,n=e.currentY-e.centerY,a=Math.sqrt(i*i+n*n),o=s.width/2-20;if(a<=o)t.style.transform=`translate(calc(-50% + ${i}px), calc(-50% + ${n}px))`;else{const e=Math.atan2(n,i),s=Math.cos(e)*o,a=Math.sin(e)*o;t.style.transform=`translate(calc(-50% + ${s}px), calc(-50% + ${a}px))`}}setupMobileButtons(){const t=document.getElementById("swimUpBtn"),e=document.getElementById("swimDownBtn");t&&(t.addEventListener("touchstart",t=>{t.preventDefault(),t.stopPropagation(),this.mobileButtonState={swimUp:!0}}),t.addEventListener("touchend",t=>{t.preventDefault(),t.stopPropagation(),this.mobileButtonState={swimUp:!1}})),e&&(e.addEventListener("touchstart",t=>{t.preventDefault(),t.stopPropagation(),this.mobileButtonState={swimDown:!0}}),e.addEventListener("touchend",t=>{t.preventDefault(),t.stopPropagation(),this.mobileButtonState={swimDown:!1}})),this.mobileButtonState={swimUp:!1,swimDown:!1}}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onKeyDown(t){const e=.2;switch(t.code){case"ArrowUp":case"KeyW":this.player.position.z-=e;break;case"ArrowDown":case"KeyS":this.player.position.z+=e;break;case"ArrowLeft":case"KeyA":this.player.position.x-=e;break;case"ArrowRight":case"KeyD":this.player.position.x+=e;break;case"Space":this.player.position.y+=.1;break;case"ShiftLeft":this.player.position.y-=.1}this.updateCamera()}updateCamera(){const t=new w(0,5,10),e=this.player.position.clone().add(t);this.camera.position.lerp(e,.1),this.camera.lookAt(this.player.position)}startGameLoop(){const t=()=>{requestAnimationFrame(t),this.update(),this.render()};t()}update(){if(this.isLoaded){if(this.isMobile&&this.mobileButtonState){const t=.2;this.mobileButtonState.swimUp&&(this.player.position.y+=.5*t,this.updateCamera()),this.mobileButtonState.swimDown&&(this.player.position.y-=.5*t,this.updateCamera())}this.stars.forEach(t=>{t.rotation.y+=t.userData.rotationSpeed,t.rotation.x+=.5*t.userData.rotationSpeed}),this.checkStarCollection()}}checkStarCollection(){this.stars.forEach((t,e)=>{this.player.position.distanceTo(t.position)<1&&(this.scene.remove(t),this.stars.splice(e,1),this.starCount++,this.updateUI(),console.log(`‚≠ê Star collected! Total: ${this.starCount}`),0===this.stars.length&&this.levelComplete())})}levelComplete(){console.log("üéâ Level Complete!"),this.levelNumber++,this.createSampleStars(),this.updateUI()}updateUI(){document.getElementById("starCount").textContent=this.starCount,document.getElementById("levelNumber").textContent=this.levelNumber}render(){this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}hideLoading(){const t=document.getElementById(e);t&&t.classList.add("hidden")}showUI(){const t=document.getElementById(m);t&&t.classList.remove("hidden"),this.updateUI()}detectMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}window.addEventListener("DOMContentLoaded",async()=>{const t=new v;await t.initialize()}),window.addEventListener("webglcontextlost",t=>{t.preventDefault(),console.warn("WebGL context lost")}),window.addEventListener("webglcontextrestored",()=>{console.log("WebGL context restored")})}}});
//# sourceMappingURL=index-legacy-CkkllAY4.js.map
