{"version":3,"file":"index-CU_19vw3.js","sources":["../../src/core/Physics.js","../../src/core/ParticleSystem.js","../../src/components/Player.js","../../src/main.js"],"sourcesContent":["/**\n * Physics Engine for Ocean Adventure\n *\n * Implements collision detection and underwater physics simulation\n * including buoyancy, drag, and environmental forces.\n */\n\nimport * as THREE from 'three'\n\n/**\n * Collision system supporting AABB and sphere-based collision detection\n */\nexport class CollisionSystem {\n  constructor() {\n    this.colliders = []\n    this.staticColliders = []\n  }\n\n  /**\n   * Add a collider to the system\n   * @param {Object} collider - Collider object with geometry and position\n   * @param {boolean} isStatic - Whether the collider is static (doesn't move)\n   */\n  addCollider(collider, isStatic = false) {\n    const list = isStatic ? this.staticColliders : this.colliders\n    list.push(collider)\n  }\n\n  /**\n   * Remove a collider from the system\n   * @param {Object} collider - Collider to remove\n   */\n  removeCollider(collider) {\n    let index = this.colliders.indexOf(collider)\n    if (index !== -1) {\n      this.colliders.splice(index, 1)\n      return\n    }\n\n    index = this.staticColliders.indexOf(collider)\n    if (index !== -1) {\n      this.staticColliders.splice(index, 1)\n    }\n  }\n\n  /**\n   * Check for collisions between two objects\n   * @param {Object} objectA - First object with position and geometry\n   * @param {Object} objectB - Second object with position and geometry\n   * @returns {boolean} Whether objects are colliding\n   */\n  checkCollision(objectA, objectB) {\n    // Sphere-sphere collision detection\n    if (\n      objectA.collisionType === 'sphere' &&\n      objectB.collisionType === 'sphere'\n    ) {\n      return this.checkSphereCollision(objectA, objectB)\n    }\n\n    // AABB-AABB collision detection\n    if (objectA.collisionType === 'box' && objectB.collisionType === 'box') {\n      return this.checkAABBCollision(objectA, objectB)\n    }\n\n    // Sphere-AABB collision detection\n    if (\n      (objectA.collisionType === 'sphere' && objectB.collisionType === 'box') ||\n      (objectA.collisionType === 'box' && objectB.collisionType === 'sphere')\n    ) {\n      return this.checkSphereAABBCollision(objectA, objectB)\n    }\n\n    return false\n  }\n\n  /**\n   * Check sphere-sphere collision\n   * @param {Object} sphereA - First sphere\n   * @param {Object} sphereB - Second sphere\n   * @returns {boolean} Whether spheres are colliding\n   */\n  checkSphereCollision(sphereA, sphereB) {\n    const distance = sphereA.position.distanceTo(sphereB.position)\n    const radiusSum = sphereA.radius + sphereB.radius\n    return distance <= radiusSum\n  }\n\n  /**\n   * Check AABB-AABB collision\n   * @param {Object} boxA - First box\n   * @param {Object} boxB - Second box\n   * @returns {boolean} Whether boxes are colliding\n   */\n  checkAABBCollision(boxA, boxB) {\n    const minA = boxA.position\n      .clone()\n      .sub(boxA.size.clone().multiplyScalar(0.5))\n    const maxA = boxA.position\n      .clone()\n      .add(boxA.size.clone().multiplyScalar(0.5))\n    const minB = boxB.position\n      .clone()\n      .sub(boxB.size.clone().multiplyScalar(0.5))\n    const maxB = boxB.position\n      .clone()\n      .add(boxB.size.clone().multiplyScalar(0.5))\n\n    return (\n      minA.x <= maxB.x &&\n      maxA.x >= minB.x &&\n      minA.y <= maxB.y &&\n      maxA.y >= minB.y &&\n      minA.z <= maxB.z &&\n      maxA.z >= minB.z\n    )\n  }\n\n  /**\n   * Check sphere-AABB collision\n   * @param {Object} objectA - First object (sphere or box)\n   * @param {Object} objectB - Second object (sphere or box)\n   * @returns {boolean} Whether objects are colliding\n   */\n  checkSphereAABBCollision(objectA, objectB) {\n    const sphere = objectA.collisionType === 'sphere' ? objectA : objectB\n    const box = objectA.collisionType === 'box' ? objectA : objectB\n\n    const boxMin = box.position\n      .clone()\n      .sub(box.size.clone().multiplyScalar(0.5))\n    const boxMax = box.position\n      .clone()\n      .add(box.size.clone().multiplyScalar(0.5))\n\n    // Find closest point on box to sphere center\n    const closestPoint = new THREE.Vector3(\n      Math.max(boxMin.x, Math.min(sphere.position.x, boxMax.x)),\n      Math.max(boxMin.y, Math.min(sphere.position.y, boxMax.y)),\n      Math.max(boxMin.z, Math.min(sphere.position.z, boxMax.z))\n    )\n\n    const distance = sphere.position.distanceTo(closestPoint)\n    return distance <= sphere.radius\n  }\n\n  /**\n   * Check all collisions for a given object\n   * @param {Object} object - Object to check collisions for\n   * @returns {Array} Array of colliding objects\n   */\n  checkCollisions(object) {\n    const collisions = []\n\n    // Check against dynamic colliders\n    for (const collider of this.colliders) {\n      if (collider !== object && this.checkCollision(object, collider)) {\n        collisions.push(collider)\n      }\n    }\n\n    // Check against static colliders\n    for (const collider of this.staticColliders) {\n      if (this.checkCollision(object, collider)) {\n        collisions.push(collider)\n      }\n    }\n\n    return collisions\n  }\n}\n\n/**\n * Underwater physics simulation\n */\nexport class UnderwaterPhysics {\n  constructor() {\n    this.buoyancyForce = 2.0 // Further reduced buoyancy force (was 4.0)\n    this.dragCoefficient = 0.95 // Water resistance (0-1, lower = more drag)\n    this.currentDirection = new THREE.Vector3(0.1, 0, 0.05) // Gentle underwater current\n    this.currentStrength = 0.02\n  }\n\n  /**\n   * Apply buoyancy force to an object\n   * @param {Object} body - Physics body with velocity and position\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyBuoyancy(body, deltaTime) {\n    const buoyancy = new THREE.Vector3(0, this.buoyancyForce * deltaTime, 0)\n    body.velocity.add(buoyancy)\n  }\n\n  /**\n   * Apply drag force to an object\n   * @param {Object} body - Physics body with velocity\n   */\n  applyDrag(body) {\n    body.velocity.multiplyScalar(this.dragCoefficient)\n  }\n\n  /**\n   * Apply underwater current to an object\n   * @param {Object} body - Physics body with velocity\n   * @param {number} currentStrength - Strength multiplier for current effect\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyCurrent(body, currentStrength = 1.0, deltaTime) {\n    const currentForce = this.currentDirection\n      .clone()\n      .multiplyScalar(this.currentStrength * currentStrength * deltaTime)\n    body.velocity.add(currentForce)\n  }\n\n  /**\n   * Apply all underwater physics effects\n   * @param {Object} body - Physics body\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyUnderwaterEffects(body, deltaTime) {\n    this.applyBuoyancy(body, deltaTime)\n    this.applyDrag(body)\n    this.applyCurrent(body, 1.0, deltaTime)\n  }\n}\n\n/**\n * Main Physics Engine\n */\nexport class PhysicsEngine {\n  constructor() {\n    this.gravity = new THREE.Vector3(0, -9.8, 0)\n    this.waterDensity = 1000 // kg/m¬≥\n    this.collisionSystem = new CollisionSystem()\n    this.underwaterPhysics = new UnderwaterPhysics()\n    this.rigidBodies = []\n    this.isUnderwater = true // For now, everything is underwater\n  }\n\n  /**\n   * Add a rigid body to the physics simulation\n   * @param {Object} body - Physics body to add\n   */\n  addRigidBody(body) {\n    this.rigidBodies.push(body)\n\n    // Add to collision system if it has collision properties\n    if (body.collisionType) {\n      this.collisionSystem.addCollider(body, body.isStatic)\n    }\n  }\n\n  /**\n   * Remove a rigid body from the physics simulation\n   * @param {Object} body - Physics body to remove\n   */\n  removeRigidBody(body) {\n    const index = this.rigidBodies.indexOf(body)\n    if (index !== -1) {\n      this.rigidBodies.splice(index, 1)\n      this.collisionSystem.removeCollider(body)\n    }\n  }\n\n  /**\n   * Update all physics bodies\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    for (const body of this.rigidBodies) {\n      this.updateBody(body, deltaTime)\n    }\n  }\n\n  /**\n   * Update a single physics body\n   * @param {Object} body - Physics body to update\n   * @param {number} deltaTime - Time since last frame\n   */\n  updateBody(body, deltaTime) {\n    if (body.isStatic) {\n      return\n    }\n\n    // Initialize velocity if not present\n    if (!body.velocity) {\n      body.velocity = new THREE.Vector3()\n    }\n\n    // Store previous position for collision resolution\n    const previousPosition = body.position.clone()\n\n    // Apply forces based on environment\n    if (this.isUnderwater) {\n      this.underwaterPhysics.applyUnderwaterEffects(body, deltaTime)\n    } else {\n      // Apply gravity in air\n      const gravityForce = this.gravity.clone().multiplyScalar(deltaTime)\n      body.velocity.add(gravityForce)\n    }\n\n    // Apply velocity to position\n    const velocityDelta = body.velocity.clone().multiplyScalar(deltaTime)\n    body.position.add(velocityDelta)\n\n    // Check collisions and resolve\n    const collisions = this.collisionSystem.checkCollisions(body)\n    if (collisions.length > 0) {\n      this.resolveCollisions(body, collisions, previousPosition)\n    }\n  }\n\n  /**\n   * Resolve collisions for a body\n   * @param {Object} body - Physics body that collided\n   * @param {Array} collisions - Array of colliding objects\n   * @param {THREE.Vector3} previousPosition - Position before collision\n   */\n  resolveCollisions(body, collisions, previousPosition) {\n    // Check if any collisions are with collectibles that should not block movement\n    const blockingCollisions = collisions.filter(\n      collision => collision.type !== 'collectible' || collision.collected\n    )\n\n    // Only revert position and stop movement for blocking collisions\n    if (blockingCollisions.length > 0) {\n      // Simple collision resolution: revert to previous position and stop movement\n      body.position.copy(previousPosition)\n\n      // Reduce velocity on collision (bounce/friction)\n      body.velocity.multiplyScalar(0.3)\n    }\n\n    // Notify collision callbacks if present (for all collisions)\n    if (body.onCollision) {\n      body.onCollision(collisions)\n    }\n  }\n\n  /**\n   * Check collisions for all bodies\n   * @returns {Array} Array of collision pairs\n   */\n  checkCollisions() {\n    const collisionPairs = []\n\n    for (let i = 0; i < this.rigidBodies.length; i++) {\n      const bodyA = this.rigidBodies[i]\n      const collisions = this.collisionSystem.checkCollisions(bodyA)\n\n      for (const bodyB of collisions) {\n        collisionPairs.push([bodyA, bodyB])\n      }\n    }\n\n    return collisionPairs\n  }\n\n  /**\n   * Create a sphere collision body\n   * @param {THREE.Vector3} position - Position of the sphere\n   * @param {number} radius - Radius of the sphere\n   * @param {boolean} isStatic - Whether the body is static\n   * @returns {Object} Collision body\n   */\n  createSphereBody(position, radius, isStatic = false) {\n    return {\n      position: position.clone(),\n      velocity: new THREE.Vector3(),\n      collisionType: 'sphere',\n      radius: radius,\n      isStatic: isStatic,\n    }\n  }\n\n  /**\n   * Create a box collision body\n   * @param {THREE.Vector3} position - Position of the box\n   * @param {THREE.Vector3} size - Size of the box\n   * @param {boolean} isStatic - Whether the body is static\n   * @returns {Object} Collision body\n   */\n  createBoxBody(position, size, isStatic = false) {\n    return {\n      position: position.clone(),\n      velocity: new THREE.Vector3(),\n      collisionType: 'box',\n      size: size.clone(),\n      isStatic: isStatic,\n    }\n  }\n}\n","/**\n * Particle System for Ocean Adventure\n *\n * Creates underwater atmosphere with bubbles, light rays,\n * and collection effects for enhanced immersion.\n */\n\nimport * as THREE from 'three'\n\n/**\n * Individual particle class\n */\nclass Particle {\n  constructor(position, velocity, life, size, color) {\n    this.position = position.clone()\n    this.velocity = velocity.clone()\n    this.life = life\n    this.maxLife = life\n    this.size = size\n    this.color = color.clone()\n    this.alpha = 1.0\n    this.active = true\n  }\n\n  /**\n   * Update particle state\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    if (!this.active) {\n      return\n    }\n\n    // Update position\n    this.position.add(this.velocity.clone().multiplyScalar(deltaTime))\n\n    // Update life\n    this.life -= deltaTime\n\n    // Update alpha based on life remaining\n    this.alpha = this.life / this.maxLife\n\n    // Deactivate particle if life is over\n    if (this.life <= 0) {\n      this.active = false\n    }\n  }\n\n  /**\n   * Reset particle with new properties\n   * @param {THREE.Vector3} position - New position\n   * @param {THREE.Vector3} velocity - New velocity\n   * @param {number} life - New life span\n   * @param {number} size - New size\n   * @param {THREE.Color} color - New color\n   */\n  reset(position, velocity, life, size, color) {\n    this.position.copy(position)\n    this.velocity.copy(velocity)\n    this.life = life\n    this.maxLife = life\n    this.size = size\n    this.color.copy(color)\n    this.alpha = 1.0\n    this.active = true\n  }\n}\n\n/**\n * Main particle system class\n */\nexport class ParticleSystem {\n  constructor(scene, maxParticles = 1000) {\n    this.scene = scene\n    this.maxParticles = maxParticles\n    this.particles = []\n    this.emitters = []\n\n    // Create particle pool\n    this.initializeParticlePool()\n\n    // Create particle geometry and material\n    this.createParticleRenderSystem()\n\n    // Add default underwater emitters\n    this.createUnderwaterEmitters()\n  }\n\n  /**\n   * Initialize the particle pool for object reuse\n   */\n  initializeParticlePool() {\n    for (let i = 0; i < this.maxParticles; i++) {\n      const particle = new Particle(\n        new THREE.Vector3(),\n        new THREE.Vector3(),\n        1.0,\n        1.0,\n        new THREE.Color(0xffffff)\n      )\n      particle.active = false\n      this.particles.push(particle)\n    }\n  }\n\n  /**\n   * Create the rendering system for particles\n   */\n  createParticleRenderSystem() {\n    // Create geometry for point sprites\n    this.geometry = new THREE.BufferGeometry()\n\n    // Create arrays for particle attributes\n    this.positions = new Float32Array(this.maxParticles * 3)\n    this.colors = new Float32Array(this.maxParticles * 3)\n    this.sizes = new Float32Array(this.maxParticles)\n    this.alphas = new Float32Array(this.maxParticles)\n\n    // Set attributes\n    this.geometry.setAttribute(\n      'position',\n      new THREE.BufferAttribute(this.positions, 3)\n    )\n    this.geometry.setAttribute(\n      'color',\n      new THREE.BufferAttribute(this.colors, 3)\n    )\n    this.geometry.setAttribute('size', new THREE.BufferAttribute(this.sizes, 1))\n    this.geometry.setAttribute(\n      'alpha',\n      new THREE.BufferAttribute(this.alphas, 1)\n    )\n\n    // Create shader material for better underwater effects\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        pointTexture: { value: this.createParticleTexture() },\n      },\n      vertexShader: `\n        attribute float size;\n        attribute float alpha;\n        attribute vec3 color;\n        \n        varying float vAlpha;\n        varying vec3 vColor;\n        \n        void main() {\n          vAlpha = alpha;\n          vColor = color;\n          \n          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n          gl_PointSize = size * (300.0 / -mvPosition.z);\n          gl_Position = projectionMatrix * mvPosition;\n        }\n      `,\n      fragmentShader: `\n        uniform sampler2D pointTexture;\n        \n        varying float vAlpha;\n        varying vec3 vColor;\n        \n        void main() {\n          vec4 texColor = texture2D(pointTexture, gl_PointCoord);\n          gl_FragColor = vec4(vColor, vAlpha * texColor.a);\n        }\n      `,\n      transparent: true,\n      blending: THREE.AdditiveBlending,\n      depthWrite: false,\n    })\n\n    // Create points object\n    this.points = new THREE.Points(this.geometry, this.material)\n    this.scene.add(this.points)\n  }\n\n  /**\n   * Create texture for particles\n   * @returns {THREE.Texture} Particle texture\n   */\n  createParticleTexture() {\n    const canvas = document.createElement('canvas')\n    canvas.width = 64\n    canvas.height = 64\n\n    const context = canvas.getContext('2d')\n    const gradient = context.createRadialGradient(32, 32, 0, 32, 32, 32)\n    gradient.addColorStop(0, 'rgba(255,255,255,1)')\n    gradient.addColorStop(0.2, 'rgba(255,255,255,0.8)')\n    gradient.addColorStop(0.4, 'rgba(255,255,255,0.4)')\n    gradient.addColorStop(1, 'rgba(255,255,255,0)')\n\n    context.fillStyle = gradient\n    context.fillRect(0, 0, 64, 64)\n\n    const texture = new THREE.Texture(canvas)\n    texture.needsUpdate = true\n    return texture\n  }\n\n  /**\n   * Create underwater particle emitters\n   */\n  createUnderwaterEmitters() {\n    // Bubble emitter\n    this.addEmitter({\n      type: 'bubbles',\n      position: new THREE.Vector3(0, -10, 0),\n      rate: 5, // particles per second\n      life: 8.0,\n      size: { min: 2, max: 6 },\n      velocity: new THREE.Vector3(0, 2, 0),\n      velocityVariation: new THREE.Vector3(0.5, 0.5, 0.5),\n      color: new THREE.Color(0x87ceeb),\n      colorVariation: 0.1,\n      area: new THREE.Vector3(20, 2, 20), // Emission area\n    })\n\n    // Floating particles (debris/plankton)\n    this.addEmitter({\n      type: 'debris',\n      position: new THREE.Vector3(0, 0, 0),\n      rate: 3,\n      life: 15.0,\n      size: { min: 1, max: 3 },\n      velocity: new THREE.Vector3(0.1, 0.05, 0.1),\n      velocityVariation: new THREE.Vector3(0.3, 0.2, 0.3),\n      color: new THREE.Color(0xffffff),\n      colorVariation: 0.2,\n      area: new THREE.Vector3(40, 20, 40),\n    })\n\n    // Light rays effect (very sparse)\n    this.addEmitter({\n      type: 'lightRays',\n      position: new THREE.Vector3(0, 15, 0),\n      rate: 0.5,\n      life: 20.0,\n      size: { min: 8, max: 15 },\n      velocity: new THREE.Vector3(0, -0.5, 0),\n      velocityVariation: new THREE.Vector3(0.1, 0.2, 0.1),\n      color: new THREE.Color(0xffd700),\n      colorVariation: 0.1,\n      area: new THREE.Vector3(30, 5, 30),\n    })\n  }\n\n  /**\n   * Add a particle emitter\n   * @param {Object} emitterConfig - Configuration for the emitter\n   */\n  addEmitter(emitterConfig) {\n    const emitter = {\n      ...emitterConfig,\n      accumulator: 0.0, // For rate control\n      active: true,\n    }\n    this.emitters.push(emitter)\n  }\n\n  /**\n   * Emit a single particle\n   * @param {Object} emitter - Emitter configuration\n   */\n  emitParticle(emitter) {\n    // Find inactive particle\n    const particle = this.particles.find(p => !p.active)\n    if (!particle) {\n      return\n    } // No available particles\n\n    // Calculate random position within emission area\n    const position = emitter.position\n      .clone()\n      .add(\n        new THREE.Vector3(\n          (Math.random() - 0.5) * emitter.area.x,\n          (Math.random() - 0.5) * emitter.area.y,\n          (Math.random() - 0.5) * emitter.area.z\n        )\n      )\n\n    // Calculate random velocity\n    const velocity = emitter.velocity\n      .clone()\n      .add(\n        new THREE.Vector3(\n          (Math.random() - 0.5) * emitter.velocityVariation.x,\n          (Math.random() - 0.5) * emitter.velocityVariation.y,\n          (Math.random() - 0.5) * emitter.velocityVariation.z\n        )\n      )\n\n    // Calculate random size\n    const size =\n      emitter.size.min + Math.random() * (emitter.size.max - emitter.size.min)\n\n    // Calculate random color\n    const color = emitter.color.clone()\n    if (emitter.colorVariation > 0) {\n      color.offsetHSL(\n        (Math.random() - 0.5) * emitter.colorVariation,\n        0,\n        (Math.random() - 0.5) * emitter.colorVariation * 0.5\n      )\n    }\n\n    // Reset particle with new properties\n    particle.reset(position, velocity, emitter.life, size, color)\n  }\n\n  /**\n   * Create a burst of particles at a specific location\n   * @param {THREE.Vector3} position - Position to emit particles\n   * @param {Object} config - Burst configuration\n   */\n  createBurst(position, config = {}) {\n    const count = config.count || 20\n    const life = config.life || 2.0\n    const velocity = config.velocity || new THREE.Vector3(0, 1, 0)\n    const velocityVariation =\n      config.velocityVariation || new THREE.Vector3(2, 2, 2)\n    const color = config.color || new THREE.Color(0xffd700)\n    const size = config.size || { min: 2, max: 8 }\n\n    for (let i = 0; i < count; i++) {\n      const particle = this.particles.find(p => !p.active)\n      if (!particle) {\n        break\n      }\n\n      const burstVelocity = velocity\n        .clone()\n        .add(\n          new THREE.Vector3(\n            (Math.random() - 0.5) * velocityVariation.x,\n            (Math.random() - 0.5) * velocityVariation.y,\n            (Math.random() - 0.5) * velocityVariation.z\n          )\n        )\n\n      const particleSize = size.min + Math.random() * (size.max - size.min)\n\n      particle.reset(position.clone(), burstVelocity, life, particleSize, color)\n    }\n  }\n\n  /**\n   * Update particle system\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    // Update emitters\n    for (const emitter of this.emitters) {\n      if (!emitter.active) {\n        continue\n      }\n\n      emitter.accumulator += deltaTime\n      const emissionInterval = 1.0 / emitter.rate\n\n      while (emitter.accumulator >= emissionInterval) {\n        this.emitParticle(emitter)\n        emitter.accumulator -= emissionInterval\n      }\n    }\n\n    // Update particles\n    let activeCount = 0\n    for (let i = 0; i < this.particles.length; i++) {\n      const particle = this.particles[i]\n\n      if (particle.active) {\n        particle.update(deltaTime)\n\n        // Update render attributes\n        const index3 = activeCount * 3\n        this.positions[index3] = particle.position.x\n        this.positions[index3 + 1] = particle.position.y\n        this.positions[index3 + 2] = particle.position.z\n\n        this.colors[index3] = particle.color.r\n        this.colors[index3 + 1] = particle.color.g\n        this.colors[index3 + 2] = particle.color.b\n\n        this.sizes[activeCount] = particle.size\n        this.alphas[activeCount] = particle.alpha\n\n        activeCount++\n      }\n    }\n\n    // Update geometry\n    this.geometry.attributes.position.needsUpdate = true\n    this.geometry.attributes.color.needsUpdate = true\n    this.geometry.attributes.size.needsUpdate = true\n    this.geometry.attributes.alpha.needsUpdate = true\n\n    // Update draw range to only render active particles\n    this.geometry.setDrawRange(0, activeCount)\n\n    // Update shader uniforms\n    this.material.uniforms.time.value += deltaTime\n  }\n\n  /**\n   * Set emitter active state\n   * @param {string} type - Emitter type\n   * @param {boolean} active - Whether emitter should be active\n   */\n  setEmitterActive(type, active) {\n    const emitter = this.emitters.find(e => e.type === type)\n    if (emitter) {\n      emitter.active = active\n    }\n  }\n\n  /**\n   * Remove all particles\n   */\n  clear() {\n    for (const particle of this.particles) {\n      particle.active = false\n    }\n  }\n\n  /**\n   * Dispose of particle system resources\n   */\n  dispose() {\n    this.scene.remove(this.points)\n    this.geometry.dispose()\n    this.material.dispose()\n    if (this.material.uniforms.pointTexture.value) {\n      this.material.uniforms.pointTexture.value.dispose()\n    }\n  }\n}\n","/**\n * Player Component for Ocean Adventure\n *\n * Enhanced player controller with physics integration,\n * underwater movement mechanics, and collision handling.\n */\n\nimport * as THREE from 'three'\n\nexport class Player {\n  constructor(scene, physicsEngine) {\n    this.scene = scene\n    this.physicsEngine = physicsEngine\n\n    // Player properties\n    this.moveSpeed = 8.0\n    this.rotationSpeed = 3.0\n    this.maxVelocity = 5.0\n\n    // Movement state\n    this.movementVector = new THREE.Vector3()\n    this.isMoving = false\n\n    // Create player mesh and physics body\n    this.createPlayerMesh()\n    this.createPhysicsBody()\n\n    // Bind collision handler\n    this.physicsBody.onCollision = collisions =>\n      this.handleCollisions(collisions)\n  }\n\n  /**\n   * Create the visual representation of the player\n   */\n  createPlayerMesh() {\n    // Create player geometry (capsule for better collision detection)\n    const geometry = new THREE.CapsuleGeometry(0.5, 1.5, 4, 8)\n\n    // Use MeshPhongMaterial for better lighting effects\n    const material = new THREE.MeshPhongMaterial({\n      color: 0x00ff88,\n      transparent: true,\n      opacity: 0.9,\n      shininess: 50,\n      specular: 0x44aa66,\n      emissive: 0x002211,\n      emissiveIntensity: 0.1,\n    })\n\n    this.mesh = new THREE.Mesh(geometry, material)\n    this.mesh.castShadow = true\n    this.mesh.receiveShadow = true\n\n    // Set initial position - start underwater with some depth\n    this.mesh.position.set(0, 2, 0) // Start 3 meters below water surface (5 - 2 = 3m depth)\n\n    // Add to scene\n    this.scene.add(this.mesh)\n  }\n\n  /**\n   * Create physics body for collision detection and movement\n   */\n  createPhysicsBody() {\n    this.physicsBody = this.physicsEngine.createSphereBody(\n      this.mesh.position.clone(), // Use the mesh position which is now set to (0, 2, 0)\n      0.7, // Slightly larger radius for collision detection\n      false // Not static - player can move\n    )\n\n    // Add physics body to engine\n    this.physicsEngine.addRigidBody(this.physicsBody)\n  }\n\n  /**\n   * Handle input and update movement vector\n   * @param {Object} inputState - Current input state\n   */\n  handleInput(inputState) {\n    // Reset movement vector\n    this.movementVector.set(0, 0, 0)\n    this.isMoving = false\n\n    // Keyboard input\n    if (inputState.keys) {\n      if (inputState.keys.forward) {\n        this.movementVector.z -= 1\n        this.isMoving = true\n      }\n      if (inputState.keys.backward) {\n        this.movementVector.z += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.left) {\n        this.movementVector.x -= 1\n        this.isMoving = true\n      }\n      if (inputState.keys.right) {\n        this.movementVector.x += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.up) {\n        this.movementVector.y += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.down) {\n        this.movementVector.y -= 1\n        this.isMoving = true\n      }\n    }\n\n    // Touch/mobile input\n    if (inputState.joystick) {\n      this.movementVector.x += inputState.joystick.x\n      this.movementVector.z += inputState.joystick.y\n      if (\n        Math.abs(inputState.joystick.x) > 0.1 ||\n        Math.abs(inputState.joystick.y) > 0.1\n      ) {\n        this.isMoving = true\n      }\n    }\n\n    // Mobile buttons\n    if (inputState.mobileButtons) {\n      if (inputState.mobileButtons.swimUp) {\n        this.movementVector.y += 1\n        this.isMoving = true\n      }\n      if (inputState.mobileButtons.swimDown) {\n        this.movementVector.y -= 1\n        this.isMoving = true\n      }\n    }\n\n    // Normalize movement vector to prevent faster diagonal movement\n    if (this.movementVector.length() > 1) {\n      this.movementVector.normalize()\n    }\n\n    // Apply movement to physics body\n    this.applyMovement()\n  }\n\n  /**\n   * Apply movement forces to the physics body\n   */\n  applyMovement() {\n    if (!this.isMoving) {\n      // Apply stronger drag when not actively moving\n      this.physicsBody.velocity.multiplyScalar(0.9)\n      return\n    }\n\n    // Calculate movement force\n    const force = this.movementVector\n      .clone()\n      .multiplyScalar(this.moveSpeed * 0.016) // Assume ~60fps for consistent feel\n\n    // Add force to velocity\n    this.physicsBody.velocity.add(force)\n\n    // Clamp velocity to max speed\n    if (this.physicsBody.velocity.length() > this.maxVelocity) {\n      this.physicsBody.velocity.normalize().multiplyScalar(this.maxVelocity)\n    }\n\n    // Rotate player to face movement direction (optional visual enhancement)\n    if (this.movementVector.length() > 0.1) {\n      const targetRotation = Math.atan2(\n        this.movementVector.x,\n        this.movementVector.z\n      )\n      this.mesh.rotation.y = THREE.MathUtils.lerp(\n        this.mesh.rotation.y,\n        targetRotation,\n        this.rotationSpeed * 0.016\n      )\n    }\n  }\n\n  /**\n   * Update player state\n   */\n  update() {\n    // Sync mesh position with physics body (don't override physics with floating animation)\n    this.mesh.position.copy(this.physicsBody.position)\n\n    // Add gentle floating animation to visual representation only\n    const time = Date.now() * 0.001\n    const floatingOffset = Math.sin(time * 2) * 0.02\n    this.mesh.position.y += floatingOffset\n\n    // Don't update physics body position from mesh - let physics handle position\n    // The physics body position should be authoritative\n  }\n\n  /**\n   * Handle collisions with other objects\n   * @param {Array} collisions - Array of objects the player collided with\n   */\n  handleCollisions(collisions) {\n    for (const collision of collisions) {\n      // Handle different types of collisions\n      if (collision.type === 'collectible') {\n        this.handleCollectibleCollision(collision)\n      } else if (collision.type === 'obstacle') {\n        this.handleObstacleCollision(collision)\n      } else if (collision.type === 'environment') {\n        this.handleEnvironmentCollision(collision)\n      }\n    }\n  }\n\n  /**\n   * Handle collision with collectible items\n   * @param {Object} collectible - Collectible object\n   */\n  handleCollectibleCollision(collectible) {\n    // Collectibles will be handled by the game manager\n    // This is just for reference and future expansion\n    console.log('Player collected item:', collectible)\n  }\n\n  /**\n   * Handle collision with obstacles\n   * @param {Object} obstacle - Obstacle object\n   */\n  handleObstacleCollision(obstacle) {\n    // Bounce back slightly from obstacles\n    const direction = this.physicsBody.position\n      .clone()\n      .sub(obstacle.position)\n      .normalize()\n\n    this.physicsBody.velocity.add(direction.multiplyScalar(2))\n  }\n\n  /**\n   * Handle collision with environment objects\n   * @param {Object} _envObject - Environment object (unused for now)\n   */\n  handleEnvironmentCollision() {\n    // Environment collisions are handled by physics engine\n    // This can be used for special effects or sounds\n  }\n\n  /**\n   * Get current player position\n   * @returns {THREE.Vector3} Current position\n   */\n  getPosition() {\n    // Return physics body position (authoritative) instead of mesh position (includes floating animation)\n    return this.physicsBody.position.clone()\n  }\n\n  /**\n   * Set player position\n   * @param {THREE.Vector3} position - New position\n   */\n  setPosition(position) {\n    this.mesh.position.copy(position)\n    this.physicsBody.position.copy(position)\n  }\n\n  /**\n   * Get current velocity\n   * @returns {THREE.Vector3} Current velocity\n   */\n  getVelocity() {\n    return this.physicsBody.velocity.clone()\n  }\n\n  /**\n   * Check if player is moving\n   * @returns {boolean} Whether player is currently moving\n   */\n  getIsMoving() {\n    return this.isMoving || this.physicsBody.velocity.length() > 0.1\n  }\n\n  /**\n   * Dispose of player resources\n   */\n  dispose() {\n    // Remove from physics engine\n    this.physicsEngine.removeRigidBody(this.physicsBody)\n\n    // Remove mesh from scene\n    this.scene.remove(this.mesh)\n\n    // Dispose geometry and material\n    this.mesh.geometry.dispose()\n    this.mesh.material.dispose()\n  }\n}\n","/**\n * Ocean Adventure - Main Game Entry Point\n *\n * This is a placeholder implementation showing the basic structure\n * for the 3D underwater platform game. The actual game engine\n * implementation will be developed following the Copilot plan.\n */\n\nimport * as THREE from 'three'\nimport { PhysicsEngine } from './core/Physics.js'\nimport { ParticleSystem } from './core/ParticleSystem.js'\nimport { Player } from './components/Player.js'\n\n// Game configuration\nconst CONFIG = {\n  targetFPS: 60,\n  mobileFPS: 30,\n  canvasId: 'gameCanvas',\n  loadingId: 'loading',\n  uiId: 'ui',\n}\n\nclass OceanAdventure {\n  constructor() {\n    this.scene = null\n    this.camera = null\n    this.renderer = null\n    this.canvas = null\n    this.isLoaded = false\n    this.isMobile = this.detectMobile()\n\n    // Core systems\n    this.physicsEngine = null\n    this.particleSystem = null\n    this.player = null\n    this.environmentObjects = []\n\n    // Game state\n    this.starCount = 0\n    this.levelNumber = 1\n\n    // Input state\n    this.inputState = {\n      keys: {\n        forward: false,\n        backward: false,\n        left: false,\n        right: false,\n        up: false,\n        down: false,\n      },\n      joystick: { x: 0, y: 0 },\n      mobileButtons: { swimUp: false, swimDown: false },\n    }\n\n    // Timing\n    this.lastTime = 0\n\n    console.log('üåä Ocean Adventure - Initializing...')\n  }\n\n  async initialize() {\n    try {\n      this.setupCanvas()\n      this.setupRenderer()\n      this.setupScene()\n      this.setupCamera()\n      this.setupLights()\n\n      // Initialize core systems\n      this.initializePhysics()\n      this.initializeParticleSystem()\n\n      // Create game objects\n      this.createUnderwaterEnvironment()\n      this.createPlayer()\n      this.createSampleStars()\n\n      this.setupEventListeners()\n\n      // Hide loading screen and show UI\n      this.hideLoading()\n      this.showUI()\n\n      // Start game loop\n      this.startGameLoop()\n\n      this.isLoaded = true\n      console.log('üéÆ Ocean Adventure - Ready to play!')\n    } catch (error) {\n      console.error('‚ùå Failed to initialize game:', error)\n    }\n  }\n\n  setupCanvas() {\n    this.canvas = document.getElementById(CONFIG.canvasId)\n    if (!this.canvas) {\n      throw new Error('Game canvas not found')\n    }\n  }\n\n  setupRenderer() {\n    try {\n      this.renderer = new THREE.WebGLRenderer({\n        canvas: this.canvas,\n        antialias: !this.isMobile, // Disable antialiasing on mobile for performance\n        alpha: false,\n        powerPreference: this.isMobile ? 'low-power' : 'high-performance',\n        failIfMajorPerformanceCaveat: false, // Allow fallback rendering\n        preserveDrawingBuffer: false, // Better performance\n        premultipliedAlpha: false,\n        stencil: false, // Reduce memory usage\n      })\n\n      this.renderer.setSize(window.innerWidth, window.innerHeight)\n      this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\n      this.renderer.setClearColor(0x001122, 1) // Deep ocean blue\n\n      // Enable shadows with mobile-optimized settings\n      this.renderer.shadowMap.enabled = true\n      this.renderer.shadowMap.type = this.isMobile\n        ? THREE.BasicShadowMap // Faster shadow type for mobile\n        : THREE.PCFSoftShadowMap // Better quality for desktop\n\n      // Enhanced WebGL settings for modern lighting\n      this.renderer.outputColorSpace = THREE.SRGBColorSpace\n      this.renderer.toneMapping = THREE.ACESFilmicToneMapping\n      this.renderer.toneMappingExposure = 1.0\n\n      // Validate WebGL context\n      const gl = this.renderer.getContext()\n      if (!gl) {\n        throw new Error('Failed to get WebGL context')\n      }\n\n      // Add error handling for WebGL\n      gl.getExtension('WEBGL_lose_context')\n\n      console.log('‚úÖ WebGL Renderer initialized with enhanced lighting')\n    } catch (error) {\n      console.error('‚ùå Failed to setup renderer:', error)\n      throw error\n    }\n  }\n\n  setupScene() {\n    this.scene = new THREE.Scene()\n  }\n\n  /**\n   * Initialize physics engine\n   */\n  initializePhysics() {\n    this.physicsEngine = new PhysicsEngine()\n    console.log('‚ö° Physics engine initialized')\n  }\n\n  /**\n   * Initialize particle system\n   */\n  initializeParticleSystem() {\n    this.particleSystem = new ParticleSystem(this.scene, 500) // Reduced for mobile performance\n    console.log('‚ú® Particle system initialized')\n  }\n\n  setupCamera() {\n    this.camera = new THREE.PerspectiveCamera(\n      75, // Field of view\n      window.innerWidth / window.innerHeight, // Aspect ratio\n      0.1, // Near clipping plane\n      1000 // Far clipping plane\n    )\n\n    // Position camera behind and above the player\n    this.camera.position.set(0, 5, 10)\n    this.camera.lookAt(0, 0, 0)\n  }\n\n  setupLights() {\n    // Enhanced underwater ambient lighting (adjusted for modern lighting model)\n    const ambientLight = new THREE.AmbientLight(0x336699, 0.3) // Reduced from 0.6\n    this.scene.add(ambientLight)\n\n    // Primary directional light simulating filtered sunlight from above (adjusted intensity)\n    const directionalLight = new THREE.DirectionalLight(0x87ceeb, 2.5) // Increased from 1.2\n    directionalLight.position.set(0, 50, 10)\n\n    // Enable shadows with optimized settings for mobile compatibility\n    if (this.renderer.shadowMap.enabled) {\n      directionalLight.castShadow = true\n      // Use smaller shadow map sizes on mobile for better performance\n      const shadowMapSize = this.isMobile ? 512 : 1024\n      directionalLight.shadow.mapSize.width = shadowMapSize\n      directionalLight.shadow.mapSize.height = shadowMapSize\n      directionalLight.shadow.camera.near = 0.5\n      directionalLight.shadow.camera.far = 500\n      directionalLight.shadow.camera.left = -50\n      directionalLight.shadow.camera.right = 50\n      directionalLight.shadow.camera.top = 50\n      directionalLight.shadow.camera.bottom = -50\n      // Use less expensive shadow map type on mobile\n      if (this.isMobile) {\n        directionalLight.shadow.bias = -0.0005\n      }\n    }\n\n    this.scene.add(directionalLight)\n\n    // Add volumetric underwater lighting with point lights for better WebGL effects\n    this.addUnderwaterVolumetricLights()\n\n    // Add subtle rim lighting to enhance object definition (adjusted intensity)\n    const rimLight = new THREE.DirectionalLight(0x4a9eff, 0.8) // Increased from 0.4\n    rimLight.position.set(-20, 10, -20)\n    this.scene.add(rimLight)\n  }\n\n  addUnderwaterVolumetricLights() {\n    // Create multiple point lights for underwater caustics effect\n    const lightColors = [0x4a9eff, 0x87ceeb, 0x6495ed, 0x00bfff]\n    const lightCount = this.isMobile ? 3 : 5 // Fewer lights on mobile\n\n    for (let i = 0; i < lightCount; i++) {\n      const pointLight = new THREE.PointLight(\n        lightColors[i % lightColors.length],\n        this.isMobile ? 2.0 : 3.0, // Adjusted for modern lighting model\n        30, // Distance\n        2 // Decay\n      )\n\n      // Position lights in a scattered pattern above the scene\n      const angle = (i / lightCount) * Math.PI * 2\n      const radius = 15 + Math.random() * 10\n      pointLight.position.set(\n        Math.cos(angle) * radius,\n        8 + Math.random() * 5, // Varying heights\n        Math.sin(angle) * radius\n      )\n\n      // Store animation properties\n      pointLight.userData = {\n        originalPosition: pointLight.position.clone(),\n        animationOffset: Math.random() * Math.PI * 2,\n        animationSpeed: 0.5 + Math.random() * 0.5,\n        animationRadius: 2 + Math.random() * 3,\n      }\n\n      this.scene.add(pointLight)\n\n      // Store reference for animation\n      if (!this.volumetricLights) {\n        this.volumetricLights = []\n      }\n      this.volumetricLights.push(pointLight)\n    }\n  }\n\n  createUnderwaterEnvironment() {\n    // Create water surface at Y=5 (matches depth meter calculation)\n    const waterSurfaceGeometry = new THREE.PlaneGeometry(200, 200)\n    const waterSurfaceMaterial = new THREE.MeshPhongMaterial({\n      color: 0x006994,\n      transparent: true,\n      opacity: 0.6,\n      shininess: 100,\n      specular: 0x87ceeb,\n      side: THREE.DoubleSide,\n    })\n    const waterSurface = new THREE.Mesh(\n      waterSurfaceGeometry,\n      waterSurfaceMaterial\n    )\n    waterSurface.rotation.x = -Math.PI / 2\n    waterSurface.position.y = 5 // Water surface level used by depth meter\n    waterSurface.receiveShadow = true\n    this.scene.add(waterSurface)\n\n    // Create ocean floor with enhanced material\n    const floorGeometry = new THREE.PlaneGeometry(100, 100)\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      color: 0x8b4513,\n      shininess: 30,\n      specular: 0x222222,\n    })\n    const floor = new THREE.Mesh(floorGeometry, floorMaterial)\n    floor.rotation.x = -Math.PI / 2\n    floor.position.y = -5\n    floor.receiveShadow = true\n    this.scene.add(floor)\n\n    // Create physics body for floor\n    const floorPhysicsBody = this.physicsEngine.createBoxBody(\n      new THREE.Vector3(0, -5, 0),\n      new THREE.Vector3(100, 0.1, 100),\n      true // Static\n    )\n    floorPhysicsBody.type = 'environment'\n    this.physicsEngine.addRigidBody(floorPhysicsBody)\n\n    // Add coral/rocks with enhanced materials and lighting\n    for (let i = 0; i < 10; i++) {\n      const radius = 0.5 + Math.random() * 1.5\n      const geometry = new THREE.SphereGeometry(radius)\n\n      // Use MeshPhongMaterial for better lighting on all platforms\n      const hue = Math.random() * 0.3\n      const material = new THREE.MeshPhongMaterial({\n        color: new THREE.Color().setHSL(hue, 0.7, 0.5),\n        shininess: 60 + Math.random() * 40,\n        specular: new THREE.Color().setHSL(hue, 0.3, 0.8),\n        // Add slight transparency for underwater effect\n        transparent: true,\n        opacity: 0.9,\n      })\n\n      const coral = new THREE.Mesh(geometry, material)\n\n      const position = new THREE.Vector3(\n        (Math.random() - 0.5) * 80,\n        -4 + Math.random() * 2,\n        (Math.random() - 0.5) * 80\n      )\n      coral.position.copy(position)\n      coral.castShadow = true\n      coral.receiveShadow = true\n      this.scene.add(coral)\n\n      // Add physics body for collision\n      const coralPhysicsBody = this.physicsEngine.createSphereBody(\n        position,\n        radius * 1.2, // Slightly larger for collision detection\n        true // Static\n      )\n      coralPhysicsBody.type = 'environment'\n      coralPhysicsBody.mesh = coral // Reference to visual representation\n      this.physicsEngine.addRigidBody(coralPhysicsBody)\n      this.environmentObjects.push({\n        mesh: coral,\n        physicsBody: coralPhysicsBody,\n      })\n    }\n  }\n\n  createPlayer() {\n    // Create enhanced player with physics\n    this.player = new Player(this.scene, this.physicsEngine)\n    console.log('üèä Player created with physics')\n  }\n\n  createSampleStars() {\n    this.stars = []\n\n    // Create glowing star collectibles with enhanced materials\n    for (let i = 0; i < 5; i++) {\n      const starGeometry = new THREE.SphereGeometry(0.3)\n\n      // Use MeshPhongMaterial for better lighting effects\n      const starMaterial = new THREE.MeshPhongMaterial({\n        color: 0xffd700,\n        emissive: 0xffd700,\n        emissiveIntensity: 0.4,\n        shininess: 100,\n        specular: 0xffffff,\n        transparent: true,\n        opacity: 0.95,\n      })\n\n      const star = new THREE.Mesh(starGeometry, starMaterial)\n      const position = new THREE.Vector3(\n        (Math.random() - 0.5) * 20,\n        Math.random() * 8 - 2,\n        (Math.random() - 0.5) * 20\n      )\n      star.position.copy(position)\n      star.castShadow = true\n\n      // Add physics body for collision detection\n      const starPhysicsBody = this.physicsEngine.createSphereBody(\n        position,\n        0.5, // Slightly larger for easier collection\n        true // Static - stars don't move\n      )\n      starPhysicsBody.type = 'collectible'\n      starPhysicsBody.mesh = star\n      starPhysicsBody.collected = false\n      this.physicsEngine.addRigidBody(starPhysicsBody)\n\n      // Add simple rotation animation and floating effect\n      star.userData = {\n        rotationSpeed: 0.02 + Math.random() * 0.02,\n        floatSpeed: 0.01 + Math.random() * 0.01,\n        floatOffset: Math.random() * Math.PI * 2,\n        originalY: position.y,\n        physicsBody: starPhysicsBody,\n      }\n\n      this.stars.push({ mesh: star, physicsBody: starPhysicsBody })\n      this.scene.add(star)\n    }\n  }\n\n  setupEventListeners() {\n    // Handle window resize\n    window.addEventListener('resize', () => this.onWindowResize(), {\n      passive: true,\n    })\n\n    // Enhanced input handling\n    window.addEventListener('keydown', event => this.onKeyDown(event))\n    window.addEventListener('keyup', event => this.onKeyUp(event))\n\n    // Touch controls for mobile\n    if (this.isMobile) {\n      this.setupTouchControls()\n    }\n\n    // Settings modal functionality\n    this.setupSettingsModal()\n  }\n\n  onKeyDown(event) {\n    switch (event.code) {\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.keys.forward = true\n        break\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.keys.backward = true\n        break\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.keys.left = true\n        break\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.keys.right = true\n        break\n      case 'Space':\n        this.inputState.keys.up = true\n        event.preventDefault()\n        break\n      case 'ShiftLeft':\n        this.inputState.keys.down = true\n        break\n    }\n  }\n\n  onKeyUp(event) {\n    switch (event.code) {\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.keys.forward = false\n        break\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.keys.backward = false\n        break\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.keys.left = false\n        break\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.keys.right = false\n        break\n      case 'Space':\n        this.inputState.keys.up = false\n        break\n      case 'ShiftLeft':\n        this.inputState.keys.down = false\n        break\n    }\n  }\n\n  setupTouchControls() {\n    // Setup virtual joystick\n    this.setupVirtualJoystick()\n\n    // Setup mobile action buttons\n    this.setupMobileButtons()\n\n    // Touch control state for general canvas interactions\n    this.touchState = {\n      startX: 0,\n      startY: 0,\n      currentX: 0,\n      currentY: 0,\n      isActive: false,\n    }\n\n    // General canvas touch events (for swipe gestures)\n    this.canvas.addEventListener('touchstart', event => {\n      event.preventDefault()\n      if (event.touches.length > 0) {\n        const touch = event.touches[0]\n        this.touchState.startX = touch.clientX\n        this.touchState.startY = touch.clientY\n        this.touchState.currentX = touch.clientX\n        this.touchState.currentY = touch.clientY\n        this.touchState.isActive = true\n      }\n    })\n\n    this.canvas.addEventListener('touchmove', event => {\n      event.preventDefault()\n      if (event.touches.length > 0 && this.touchState.isActive) {\n        const touch = event.touches[0]\n        this.touchState.currentX = touch.clientX\n        this.touchState.currentY = touch.clientY\n\n        // Calculate movement delta for swipe gestures\n        const deltaX = this.touchState.currentX - this.touchState.startX\n        const deltaY = this.touchState.currentY - this.touchState.startY\n\n        // Apply gentle swipe-based movement (subtle effect)\n        const moveSpeed = 0.05\n        const sensitivity = 3\n\n        if (Math.abs(deltaX) > 20) {\n          this.player.position.x += (deltaX / sensitivity) * moveSpeed * 0.01\n        }\n\n        if (Math.abs(deltaY) > 20) {\n          this.player.position.z += (deltaY / sensitivity) * moveSpeed * 0.01\n        }\n\n        this.updateCamera()\n      }\n    })\n\n    this.canvas.addEventListener('touchend', event => {\n      event.preventDefault()\n      this.touchState.isActive = false\n    })\n\n    this.canvas.addEventListener('touchcancel', event => {\n      event.preventDefault()\n      this.touchState.isActive = false\n    })\n  }\n\n  setupVirtualJoystick() {\n    const joystick = document.getElementById('virtualJoystick')\n    const knob = document.getElementById('joystickKnob')\n\n    if (!joystick || !knob) {\n      return\n    }\n\n    const joystickState = {\n      isActive: false,\n      centerX: 0,\n      centerY: 0,\n      currentX: 0,\n      currentY: 0,\n    }\n\n    joystick.addEventListener('touchstart', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (event.touches.length > 0) {\n        const touch = event.touches[0]\n        const rect = joystick.getBoundingClientRect()\n\n        joystickState.isActive = true\n        joystickState.centerX = rect.left + rect.width / 2\n        joystickState.centerY = rect.top + rect.height / 2\n        joystickState.currentX = touch.clientX\n        joystickState.currentY = touch.clientY\n\n        // Visual feedback - highlight joystick when active\n        joystick.style.borderColor = 'rgba(255, 255, 255, 0.6)'\n        joystick.style.background = 'rgba(0, 17, 34, 0.7)'\n\n        this.updateJoystickKnob(knob, joystickState, rect)\n      }\n    })\n\n    joystick.addEventListener('touchmove', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (event.touches.length > 0 && joystickState.isActive) {\n        const touch = event.touches[0]\n        const rect = joystick.getBoundingClientRect()\n\n        joystickState.currentX = touch.clientX\n        joystickState.currentY = touch.clientY\n\n        // Calculate movement vector\n        const deltaX = joystickState.currentX - joystickState.centerX\n        const deltaY = joystickState.currentY - joystickState.centerY\n        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)\n        const maxDistance = rect.width / 2 - 20\n\n        // Normalize and apply movement\n        if (distance > 5) {\n          const normalizedX = deltaX / maxDistance\n          const normalizedY = deltaY / maxDistance\n\n          // Update input state with improved sensitivity for mobile\n          this.inputState.joystick.x = Math.max(\n            -1,\n            Math.min(1, normalizedX * 1.2)\n          )\n          this.inputState.joystick.y = Math.max(\n            -1,\n            Math.min(1, normalizedY * 1.2)\n          )\n        } else {\n          this.inputState.joystick.x = 0\n          this.inputState.joystick.y = 0\n        }\n\n        this.updateJoystickKnob(knob, joystickState, rect)\n      }\n    })\n\n    joystick.addEventListener('touchend', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      joystickState.isActive = false\n      this.inputState.joystick.x = 0\n      this.inputState.joystick.y = 0\n\n      // Reset visual feedback\n      joystick.style.borderColor = 'rgba(255, 255, 255, 0.3)'\n      joystick.style.background = 'rgba(0, 17, 34, 0.5)'\n      knob.style.transform = 'translate(-50%, -50%)'\n    })\n\n    joystick.addEventListener('touchcancel', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      joystickState.isActive = false\n      this.inputState.joystick.x = 0\n      this.inputState.joystick.y = 0\n\n      // Reset visual feedback\n      joystick.style.borderColor = 'rgba(255, 255, 255, 0.3)'\n      joystick.style.background = 'rgba(0, 17, 34, 0.5)'\n      knob.style.transform = 'translate(-50%, -50%)'\n    })\n  }\n\n  updateJoystickKnob(knob, joystickState, rect) {\n    const deltaX = joystickState.currentX - joystickState.centerX\n    const deltaY = joystickState.currentY - joystickState.centerY\n    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)\n    const maxDistance = rect.width / 2 - 20\n\n    if (distance <= maxDistance) {\n      knob.style.transform = `translate(calc(-50% + ${deltaX}px), calc(-50% + ${deltaY}px))`\n    } else {\n      const angle = Math.atan2(deltaY, deltaX)\n      const x = Math.cos(angle) * maxDistance\n      const y = Math.sin(angle) * maxDistance\n      knob.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px))`\n    }\n  }\n\n  setupMobileButtons() {\n    const swimUpBtn = document.getElementById('swimUpBtn')\n    const swimDownBtn = document.getElementById('swimDownBtn')\n\n    if (swimUpBtn) {\n      // Add more responsive event handling\n      swimUpBtn.addEventListener('touchstart', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = true\n        swimUpBtn.style.background = 'rgba(255, 255, 255, 0.4)'\n      })\n\n      swimUpBtn.addEventListener('touchend', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = false\n        swimUpBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n\n      swimUpBtn.addEventListener('touchcancel', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = false\n        swimUpBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n    }\n\n    if (swimDownBtn) {\n      // Add more responsive event handling\n      swimDownBtn.addEventListener('touchstart', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = true\n        swimDownBtn.style.background = 'rgba(255, 255, 255, 0.4)'\n      })\n\n      swimDownBtn.addEventListener('touchend', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = false\n        swimDownBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n\n      swimDownBtn.addEventListener('touchcancel', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = false\n        swimDownBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n    }\n  }\n\n  setupSettingsModal() {\n    const settingsButton = document.getElementById('settingsButton')\n    const settingsModal = document.getElementById('settingsModal')\n    const closeSettings = document.getElementById('closeSettings')\n\n    if (settingsButton && settingsModal && closeSettings) {\n      // Open settings\n      const openSettings = event => {\n        if (event) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        settingsModal.classList.remove('hidden')\n        // Prevent body scrolling when modal is open\n        document.body.style.overflow = 'hidden'\n      }\n\n      // Close settings\n      const closeModal = event => {\n        if (event) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        settingsModal.classList.add('hidden')\n        // Restore body scrolling\n        document.body.style.overflow = ''\n      }\n\n      // Simple event handling - click events work on both desktop and mobile\n      settingsButton.addEventListener('click', openSettings)\n      closeSettings.addEventListener('click', closeModal)\n\n      // Close on background click - improved detection for both desktop and mobile\n      settingsModal.addEventListener('click', event => {\n        // Get the settings content element\n        const settingsContent = settingsModal.querySelector('.settings-content')\n\n        if (settingsContent) {\n          const contentRect = settingsContent.getBoundingClientRect()\n          const clickX = event.clientX\n          const clickY = event.clientY\n\n          // Check if click is outside the content area\n          const isOutsideContent =\n            clickX < contentRect.left ||\n            clickX > contentRect.right ||\n            clickY < contentRect.top ||\n            clickY > contentRect.bottom\n\n          if (isOutsideContent) {\n            closeModal(event)\n          }\n        } else if (event.target === settingsModal) {\n          // Fallback to original method if content element not found\n          closeModal(event)\n        }\n      })\n\n      // Close on escape key\n      document.addEventListener('keydown', event => {\n        if (\n          event.key === 'Escape' &&\n          !settingsModal.classList.contains('hidden')\n        ) {\n          closeModal()\n        }\n      })\n    }\n  }\n\n  onWindowResize() {\n    this.camera.aspect = window.innerWidth / window.innerHeight\n    this.camera.updateProjectionMatrix()\n    this.renderer.setSize(window.innerWidth, window.innerHeight)\n  }\n\n  updateCamera() {\n    // Enhanced camera follow logic\n    const playerPosition = this.player.getPosition()\n    const offset = new THREE.Vector3(0, 5, 10)\n    const targetPosition = playerPosition.clone().add(offset)\n\n    this.camera.position.lerp(targetPosition, 0.1)\n    this.camera.lookAt(playerPosition)\n  }\n\n  startGameLoop() {\n    const animate = currentTime => {\n      requestAnimationFrame(animate)\n\n      // Calculate delta time\n      const deltaTime =\n        this.lastTime > 0 ? (currentTime - this.lastTime) / 1000 : 0.016\n      this.lastTime = currentTime\n\n      this.update(deltaTime)\n      this.render()\n    }\n    animate(0)\n  }\n\n  update(deltaTime) {\n    if (!this.isLoaded) {\n      return\n    }\n\n    // Clamp delta time to prevent large jumps\n    deltaTime = Math.min(deltaTime, 0.033) // Max 30fps equivalent\n\n    // Update physics engine\n    this.physicsEngine.update(deltaTime)\n\n    // Update player with input\n    this.player.handleInput(this.inputState)\n    this.player.update()\n\n    // Update particle system\n    this.particleSystem.update(deltaTime)\n\n    // Update camera\n    this.updateCamera()\n\n    // Update UI (including depth meter)\n    this.updateUI()\n\n    // Animate stars with floating and pulsing effects\n    this.stars.forEach(starData => {\n      const star = starData.mesh\n      const userData = star.userData\n\n      // Rotation animation\n      star.rotation.y += userData.rotationSpeed\n      star.rotation.x += userData.rotationSpeed * 0.5\n\n      // Floating animation\n      const time = Date.now() * 0.001\n      const floatY =\n        userData.originalY +\n        Math.sin(time * userData.floatSpeed + userData.floatOffset) * 0.3\n      star.position.y = floatY\n\n      // Pulsing emissive effect\n      const pulseFactor = 0.3 + Math.sin(time * 2 + userData.floatOffset) * 0.1\n      star.material.emissiveIntensity = pulseFactor\n    })\n\n    // Animate volumetric lights for underwater caustics effect\n    if (this.volumetricLights) {\n      const time = Date.now() * 0.001\n      this.volumetricLights.forEach(light => {\n        const userData = light.userData\n        const animationTime =\n          time * userData.animationSpeed + userData.animationOffset\n\n        // Create gentle swaying motion\n        const offsetX = Math.sin(animationTime) * userData.animationRadius\n        const offsetZ = Math.cos(animationTime * 1.3) * userData.animationRadius\n        const offsetY = Math.sin(animationTime * 0.7) * 1\n\n        light.position.x = userData.originalPosition.x + offsetX\n        light.position.y = userData.originalPosition.y + offsetY\n        light.position.z = userData.originalPosition.z + offsetZ\n\n        // Subtle intensity variation for flickering water caustics\n        const intensityVariation = 0.8 + Math.sin(animationTime * 3) * 0.2\n        light.intensity = (this.isMobile ? 0.6 : 0.8) * intensityVariation\n      })\n    }\n\n    // Check star collection using collision detection\n    this.checkStarCollection()\n  }\n\n  checkStarCollection() {\n    // Get player collisions from physics engine\n    const playerCollisions = this.physicsEngine.collisionSystem.checkCollisions(\n      this.player.physicsBody\n    )\n\n    for (const collision of playerCollisions) {\n      if (collision.type === 'collectible' && !collision.collected) {\n        // Collect star\n        collision.collected = true\n\n        // Find and remove the star from scene and physics\n        const starData = this.stars.find(s => s.physicsBody === collision)\n        if (starData) {\n          // Remove from scene\n          this.scene.remove(starData.mesh)\n\n          // Remove from physics\n          this.physicsEngine.removeRigidBody(starData.physicsBody)\n\n          // Remove from stars array\n          const index = this.stars.indexOf(starData)\n          if (index !== -1) {\n            this.stars.splice(index, 1)\n          }\n\n          // Update game state\n          this.starCount++\n          this.updateUI()\n\n          // Create collection effect\n          this.particleSystem.createBurst(starData.mesh.position, {\n            count: 15,\n            life: 1.5,\n            velocity: new THREE.Vector3(0, 2, 0),\n            velocityVariation: new THREE.Vector3(3, 3, 3),\n            color: new THREE.Color(0xffd700),\n            size: { min: 3, max: 8 },\n          })\n\n          console.log(`‚≠ê Star collected! Total: ${this.starCount}`)\n\n          // Check if level is complete\n          if (this.stars.length === 0) {\n            this.levelComplete()\n          }\n        }\n      }\n    }\n  }\n\n  levelComplete() {\n    console.log('üéâ Level Complete!')\n    this.levelNumber++\n    // Reset level with new stars\n    this.createSampleStars()\n    this.updateUI()\n  }\n\n  updateUI() {\n    document.getElementById('starCount').textContent = this.starCount\n    document.getElementById('levelNumber').textContent = this.levelNumber\n\n    // Update depth meter based on player Y position\n    if (this.player) {\n      const playerPosition = this.player.getPosition()\n      // Water surface is at Y=5, so depth = surface level - current Y position\n      const waterSurface = 5.0\n      const depth = Math.max(0, waterSurface - playerPosition.y)\n      document.getElementById('depthMeter').textContent = depth.toFixed(1)\n    }\n  }\n\n  render() {\n    try {\n      if (this.renderer && this.scene && this.camera) {\n        this.renderer.render(this.scene, this.camera)\n      }\n    } catch (error) {\n      // Silently handle WebGL render errors to prevent spam\n      if (this.webglErrorCount < 5) {\n        console.warn('WebGL render error:', error)\n        this.webglErrorCount = (this.webglErrorCount || 0) + 1\n      }\n    }\n  }\n\n  hideLoading() {\n    const loadingElement = document.getElementById(CONFIG.loadingId)\n    if (loadingElement) {\n      loadingElement.classList.add('hidden')\n    }\n  }\n\n  showUI() {\n    const uiElement = document.getElementById(CONFIG.uiId)\n    if (uiElement) {\n      uiElement.classList.remove('hidden')\n    }\n    this.updateUI()\n  }\n\n  detectMobile() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent\n    )\n  }\n}\n\n// Initialize the game when the page loads\nwindow.addEventListener(\n  'DOMContentLoaded',\n  async () => {\n    const game = new OceanAdventure()\n    await game.initialize()\n  },\n  { passive: true }\n)\n\n// Handle WebGL context loss\nwindow.addEventListener(\n  'webglcontextlost',\n  event => {\n    event.preventDefault()\n    console.warn('WebGL context lost')\n  },\n  { passive: false }\n)\n\nwindow.addEventListener(\n  'webglcontextrestored',\n  () => {\n    console.log('WebGL context restored')\n    // Reinitialize game here if needed\n  },\n  { passive: true }\n)\n\n// Performance optimization: Pause game when page is hidden\ndocument.addEventListener(\n  'visibilitychange',\n  () => {\n    if (document.hidden) {\n      // Page is hidden, reduce performance\n      console.log('Game paused due to page visibility')\n    } else {\n      // Page is visible, resume normal performance\n      console.log('Game resumed')\n    }\n  },\n  { passive: true }\n)\n"],"names":["CollisionSystem","collider","isStatic","index","objectA","objectB","sphereA","sphereB","distance","radiusSum","boxA","boxB","minA","maxA","minB","maxB","sphere","box","boxMin","boxMax","closestPoint","THREE.Vector3","object","collisions","UnderwaterPhysics","body","deltaTime","buoyancy","currentStrength","currentForce","PhysicsEngine","previousPosition","gravityForce","velocityDelta","collision","collisionPairs","i","bodyA","bodyB","position","radius","size","Particle","velocity","life","color","ParticleSystem","scene","maxParticles","particle","THREE.Color","THREE.BufferGeometry","THREE.BufferAttribute","THREE.ShaderMaterial","THREE.AdditiveBlending","THREE.Points","canvas","context","gradient","texture","THREE.Texture","emitterConfig","emitter","p","config","count","velocityVariation","burstVelocity","particleSize","emissionInterval","activeCount","index3","type","active","e","Player","physicsEngine","geometry","THREE.CapsuleGeometry","material","THREE.MeshPhongMaterial","THREE.Mesh","inputState","force","targetRotation","THREE.MathUtils","time","floatingOffset","collectible","obstacle","direction","CONFIG","OceanAdventure","error","THREE.WebGLRenderer","THREE.BasicShadowMap","THREE.PCFSoftShadowMap","THREE.SRGBColorSpace","THREE.ACESFilmicToneMapping","gl","THREE.Scene","THREE.PerspectiveCamera","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","shadowMapSize","rimLight","lightColors","lightCount","pointLight","THREE.PointLight","angle","waterSurfaceGeometry","THREE.PlaneGeometry","waterSurfaceMaterial","THREE.DoubleSide","waterSurface","floorGeometry","floorMaterial","floor","floorPhysicsBody","THREE.SphereGeometry","hue","coral","coralPhysicsBody","starGeometry","starMaterial","star","starPhysicsBody","event","touch","deltaX","deltaY","moveSpeed","sensitivity","joystick","knob","joystickState","rect","maxDistance","normalizedX","normalizedY","x","y","swimUpBtn","swimDownBtn","settingsButton","settingsModal","closeSettings","openSettings","closeModal","settingsContent","contentRect","clickX","clickY","playerPosition","offset","targetPosition","animate","currentTime","starData","userData","floatY","pulseFactor","light","animationTime","offsetX","offsetZ","offsetY","intensityVariation","playerCollisions","depth","loadingElement","uiElement"],"mappings":"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"}