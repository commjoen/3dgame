{"version":3,"file":"index-legacy-CnulQ0FD.js","sources":["../../src/core/Physics.js","../../src/core/ParticleSystem.js","../../src/core/AudioEngine.js","../../src/components/Player.js","../../src/components/Gate.js","../../src/main.js"],"sourcesContent":["/**\n * Physics Engine for Ocean Adventure\n *\n * Implements collision detection and underwater physics simulation\n * including buoyancy, drag, and environmental forces.\n */\n\nimport * as THREE from 'three'\n\n/**\n * Collision system supporting AABB and sphere-based collision detection\n */\nexport class CollisionSystem {\n  constructor() {\n    this.colliders = []\n    this.staticColliders = []\n  }\n\n  /**\n   * Add a collider to the system\n   * @param {Object} collider - Collider object with geometry and position\n   * @param {boolean} isStatic - Whether the collider is static (doesn't move)\n   */\n  addCollider(collider, isStatic = false) {\n    const list = isStatic ? this.staticColliders : this.colliders\n    list.push(collider)\n  }\n\n  /**\n   * Remove a collider from the system\n   * @param {Object} collider - Collider to remove\n   */\n  removeCollider(collider) {\n    let index = this.colliders.indexOf(collider)\n    if (index !== -1) {\n      this.colliders.splice(index, 1)\n      return\n    }\n\n    index = this.staticColliders.indexOf(collider)\n    if (index !== -1) {\n      this.staticColliders.splice(index, 1)\n    }\n  }\n\n  /**\n   * Check for collisions between two objects\n   * @param {Object} objectA - First object with position and geometry\n   * @param {Object} objectB - Second object with position and geometry\n   * @returns {boolean} Whether objects are colliding\n   */\n  checkCollision(objectA, objectB) {\n    // Sphere-sphere collision detection\n    if (\n      objectA.collisionType === 'sphere' &&\n      objectB.collisionType === 'sphere'\n    ) {\n      return this.checkSphereCollision(objectA, objectB)\n    }\n\n    // AABB-AABB collision detection\n    if (objectA.collisionType === 'box' && objectB.collisionType === 'box') {\n      return this.checkAABBCollision(objectA, objectB)\n    }\n\n    // Sphere-AABB collision detection\n    if (\n      (objectA.collisionType === 'sphere' && objectB.collisionType === 'box') ||\n      (objectA.collisionType === 'box' && objectB.collisionType === 'sphere')\n    ) {\n      return this.checkSphereAABBCollision(objectA, objectB)\n    }\n\n    return false\n  }\n\n  /**\n   * Check sphere-sphere collision\n   * @param {Object} sphereA - First sphere\n   * @param {Object} sphereB - Second sphere\n   * @returns {boolean} Whether spheres are colliding\n   */\n  checkSphereCollision(sphereA, sphereB) {\n    const distance = sphereA.position.distanceTo(sphereB.position)\n    const radiusSum = sphereA.radius + sphereB.radius\n    return distance <= radiusSum\n  }\n\n  /**\n   * Check AABB-AABB collision\n   * @param {Object} boxA - First box\n   * @param {Object} boxB - Second box\n   * @returns {boolean} Whether boxes are colliding\n   */\n  checkAABBCollision(boxA, boxB) {\n    const minA = boxA.position\n      .clone()\n      .sub(boxA.size.clone().multiplyScalar(0.5))\n    const maxA = boxA.position\n      .clone()\n      .add(boxA.size.clone().multiplyScalar(0.5))\n    const minB = boxB.position\n      .clone()\n      .sub(boxB.size.clone().multiplyScalar(0.5))\n    const maxB = boxB.position\n      .clone()\n      .add(boxB.size.clone().multiplyScalar(0.5))\n\n    return (\n      minA.x <= maxB.x &&\n      maxA.x >= minB.x &&\n      minA.y <= maxB.y &&\n      maxA.y >= minB.y &&\n      minA.z <= maxB.z &&\n      maxA.z >= minB.z\n    )\n  }\n\n  /**\n   * Check sphere-AABB collision\n   * @param {Object} objectA - First object (sphere or box)\n   * @param {Object} objectB - Second object (sphere or box)\n   * @returns {boolean} Whether objects are colliding\n   */\n  checkSphereAABBCollision(objectA, objectB) {\n    const sphere = objectA.collisionType === 'sphere' ? objectA : objectB\n    const box = objectA.collisionType === 'box' ? objectA : objectB\n\n    const boxMin = box.position\n      .clone()\n      .sub(box.size.clone().multiplyScalar(0.5))\n    const boxMax = box.position\n      .clone()\n      .add(box.size.clone().multiplyScalar(0.5))\n\n    // Find closest point on box to sphere center\n    const closestPoint = new THREE.Vector3(\n      Math.max(boxMin.x, Math.min(sphere.position.x, boxMax.x)),\n      Math.max(boxMin.y, Math.min(sphere.position.y, boxMax.y)),\n      Math.max(boxMin.z, Math.min(sphere.position.z, boxMax.z))\n    )\n\n    const distance = sphere.position.distanceTo(closestPoint)\n    return distance <= sphere.radius\n  }\n\n  /**\n   * Check all collisions for a given object\n   * @param {Object} object - Object to check collisions for\n   * @returns {Array} Array of colliding objects\n   */\n  checkCollisions(object) {\n    const collisions = []\n\n    // Check against dynamic colliders\n    for (const collider of this.colliders) {\n      if (collider !== object && this.checkCollision(object, collider)) {\n        collisions.push(collider)\n      }\n    }\n\n    // Check against static colliders\n    for (const collider of this.staticColliders) {\n      if (this.checkCollision(object, collider)) {\n        collisions.push(collider)\n      }\n    }\n\n    return collisions\n  }\n}\n\n/**\n * Underwater physics simulation\n */\nexport class UnderwaterPhysics {\n  constructor() {\n    this.buoyancyForce = 2.0 // Further reduced buoyancy force (was 4.0)\n    this.dragCoefficient = 0.95 // Water resistance (0-1, lower = more drag)\n    this.currentDirection = new THREE.Vector3(0.1, 0, 0.05) // Gentle underwater current\n    this.currentStrength = 0.02\n  }\n\n  /**\n   * Apply buoyancy force to an object\n   * @param {Object} body - Physics body with velocity and position\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyBuoyancy(body, deltaTime) {\n    const buoyancy = new THREE.Vector3(0, this.buoyancyForce * deltaTime, 0)\n    body.velocity.add(buoyancy)\n  }\n\n  /**\n   * Apply drag force to an object\n   * @param {Object} body - Physics body with velocity\n   */\n  applyDrag(body) {\n    body.velocity.multiplyScalar(this.dragCoefficient)\n  }\n\n  /**\n   * Apply underwater current to an object\n   * @param {Object} body - Physics body with velocity\n   * @param {number} currentStrength - Strength multiplier for current effect\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyCurrent(body, currentStrength = 1.0, deltaTime) {\n    const currentForce = this.currentDirection\n      .clone()\n      .multiplyScalar(this.currentStrength * currentStrength * deltaTime)\n    body.velocity.add(currentForce)\n  }\n\n  /**\n   * Apply all underwater physics effects\n   * @param {Object} body - Physics body\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyUnderwaterEffects(body, deltaTime) {\n    this.applyBuoyancy(body, deltaTime)\n    this.applyDrag(body)\n    this.applyCurrent(body, 1.0, deltaTime)\n  }\n}\n\n/**\n * Main Physics Engine\n */\nexport class PhysicsEngine {\n  constructor() {\n    this.gravity = new THREE.Vector3(0, -9.8, 0)\n    this.waterDensity = 1000 // kg/mÂ³\n    this.collisionSystem = new CollisionSystem()\n    this.underwaterPhysics = new UnderwaterPhysics()\n    this.rigidBodies = []\n    this.isUnderwater = true // For now, everything is underwater\n  }\n\n  /**\n   * Add a rigid body to the physics simulation\n   * @param {Object} body - Physics body to add\n   */\n  addRigidBody(body) {\n    this.rigidBodies.push(body)\n\n    // Add to collision system if it has collision properties\n    if (body.collisionType) {\n      this.collisionSystem.addCollider(body, body.isStatic)\n    }\n  }\n\n  /**\n   * Remove a rigid body from the physics simulation\n   * @param {Object} body - Physics body to remove\n   */\n  removeRigidBody(body) {\n    const index = this.rigidBodies.indexOf(body)\n    if (index !== -1) {\n      this.rigidBodies.splice(index, 1)\n      this.collisionSystem.removeCollider(body)\n    }\n  }\n\n  /**\n   * Update all physics bodies\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    for (const body of this.rigidBodies) {\n      this.updateBody(body, deltaTime)\n    }\n  }\n\n  /**\n   * Update a single physics body\n   * @param {Object} body - Physics body to update\n   * @param {number} deltaTime - Time since last frame\n   */\n  updateBody(body, deltaTime) {\n    if (body.isStatic) {\n      return\n    }\n\n    // Initialize velocity if not present\n    if (!body.velocity) {\n      body.velocity = new THREE.Vector3()\n    }\n\n    // Store previous position for collision resolution\n    const previousPosition = body.position.clone()\n\n    // Apply forces based on environment\n    if (this.isUnderwater) {\n      this.underwaterPhysics.applyUnderwaterEffects(body, deltaTime)\n    } else {\n      // Apply gravity in air\n      const gravityForce = this.gravity.clone().multiplyScalar(deltaTime)\n      body.velocity.add(gravityForce)\n    }\n\n    // Apply velocity to position\n    const velocityDelta = body.velocity.clone().multiplyScalar(deltaTime)\n    body.position.add(velocityDelta)\n\n    // Check collisions and resolve\n    const collisions = this.collisionSystem.checkCollisions(body)\n    if (collisions.length > 0) {\n      this.resolveCollisions(body, collisions, previousPosition)\n    }\n  }\n\n  /**\n   * Resolve collisions for a body\n   * @param {Object} body - Physics body that collided\n   * @param {Array} collisions - Array of colliding objects\n   * @param {THREE.Vector3} previousPosition - Position before collision\n   */\n  resolveCollisions(body, collisions, previousPosition) {\n    // Check if any collisions are with collectibles that should not block movement\n    const blockingCollisions = collisions.filter(\n      collision => collision.type !== 'collectible' || collision.collected\n    )\n\n    // Only revert position and stop movement for blocking collisions\n    if (blockingCollisions.length > 0) {\n      // Simple collision resolution: revert to previous position and stop movement\n      body.position.copy(previousPosition)\n\n      // Reduce velocity on collision (bounce/friction)\n      body.velocity.multiplyScalar(0.3)\n    }\n\n    // Notify collision callbacks if present (for all collisions)\n    if (body.onCollision) {\n      body.onCollision(collisions)\n    }\n  }\n\n  /**\n   * Check collisions for all bodies\n   * @returns {Array} Array of collision pairs\n   */\n  checkCollisions() {\n    const collisionPairs = []\n\n    for (let i = 0; i < this.rigidBodies.length; i++) {\n      const bodyA = this.rigidBodies[i]\n      const collisions = this.collisionSystem.checkCollisions(bodyA)\n\n      for (const bodyB of collisions) {\n        collisionPairs.push([bodyA, bodyB])\n      }\n    }\n\n    return collisionPairs\n  }\n\n  /**\n   * Create a sphere collision body\n   * @param {THREE.Vector3} position - Position of the sphere\n   * @param {number} radius - Radius of the sphere\n   * @param {boolean} isStatic - Whether the body is static\n   * @returns {Object} Collision body\n   */\n  createSphereBody(position, radius, isStatic = false) {\n    return {\n      position: position.clone(),\n      velocity: new THREE.Vector3(),\n      collisionType: 'sphere',\n      radius: radius,\n      isStatic: isStatic,\n    }\n  }\n\n  /**\n   * Create a box collision body\n   * @param {THREE.Vector3} position - Position of the box\n   * @param {THREE.Vector3} size - Size of the box\n   * @param {boolean} isStatic - Whether the body is static\n   * @returns {Object} Collision body\n   */\n  createBoxBody(position, size, isStatic = false) {\n    return {\n      position: position.clone(),\n      velocity: new THREE.Vector3(),\n      collisionType: 'box',\n      size: size.clone(),\n      isStatic: isStatic,\n    }\n  }\n}\n","/**\n * Particle System for Ocean Adventure\n *\n * Creates underwater atmosphere with bubbles, light rays,\n * and collection effects for enhanced immersion.\n */\n\nimport * as THREE from 'three'\n\n/**\n * Individual particle class\n */\nclass Particle {\n  constructor(position, velocity, life, size, color) {\n    this.position = position.clone()\n    this.velocity = velocity.clone()\n    this.life = life\n    this.maxLife = life\n    this.size = size\n    this.color = color.clone()\n    this.alpha = 1.0\n    this.active = true\n  }\n\n  /**\n   * Update particle state\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    if (!this.active) {\n      return\n    }\n\n    // Update position\n    this.position.add(this.velocity.clone().multiplyScalar(deltaTime))\n\n    // Update life\n    this.life -= deltaTime\n\n    // Update alpha based on life remaining\n    this.alpha = this.life / this.maxLife\n\n    // Deactivate particle if life is over\n    if (this.life <= 0) {\n      this.active = false\n    }\n  }\n\n  /**\n   * Reset particle with new properties\n   * @param {THREE.Vector3} position - New position\n   * @param {THREE.Vector3} velocity - New velocity\n   * @param {number} life - New life span\n   * @param {number} size - New size\n   * @param {THREE.Color} color - New color\n   */\n  reset(position, velocity, life, size, color) {\n    this.position.copy(position)\n    this.velocity.copy(velocity)\n    this.life = life\n    this.maxLife = life\n    this.size = size\n    this.color.copy(color)\n    this.alpha = 1.0\n    this.active = true\n  }\n}\n\n/**\n * Main particle system class\n */\nexport class ParticleSystem {\n  constructor(scene, maxParticles = 1000) {\n    this.scene = scene\n    this.maxParticles = maxParticles\n    this.particles = []\n    this.emitters = []\n\n    // Create particle pool\n    this.initializeParticlePool()\n\n    // Create particle geometry and material\n    this.createParticleRenderSystem()\n\n    // Add default underwater emitters\n    this.createUnderwaterEmitters()\n  }\n\n  /**\n   * Initialize the particle pool for object reuse\n   */\n  initializeParticlePool() {\n    for (let i = 0; i < this.maxParticles; i++) {\n      const particle = new Particle(\n        new THREE.Vector3(),\n        new THREE.Vector3(),\n        1.0,\n        1.0,\n        new THREE.Color(0xffffff)\n      )\n      particle.active = false\n      this.particles.push(particle)\n    }\n  }\n\n  /**\n   * Create the rendering system for particles\n   */\n  createParticleRenderSystem() {\n    // Create geometry for point sprites\n    this.geometry = new THREE.BufferGeometry()\n\n    // Create arrays for particle attributes\n    this.positions = new Float32Array(this.maxParticles * 3)\n    this.colors = new Float32Array(this.maxParticles * 3)\n    this.sizes = new Float32Array(this.maxParticles)\n    this.alphas = new Float32Array(this.maxParticles)\n\n    // Set attributes\n    this.geometry.setAttribute(\n      'position',\n      new THREE.BufferAttribute(this.positions, 3)\n    )\n    this.geometry.setAttribute(\n      'color',\n      new THREE.BufferAttribute(this.colors, 3)\n    )\n    this.geometry.setAttribute('size', new THREE.BufferAttribute(this.sizes, 1))\n    this.geometry.setAttribute(\n      'alpha',\n      new THREE.BufferAttribute(this.alphas, 1)\n    )\n\n    // Create shader material for better underwater effects\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        pointTexture: { value: this.createParticleTexture() },\n      },\n      vertexShader: `\n        attribute float size;\n        attribute float alpha;\n        attribute vec3 color;\n        \n        varying float vAlpha;\n        varying vec3 vColor;\n        \n        void main() {\n          vAlpha = alpha;\n          vColor = color;\n          \n          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n          gl_PointSize = size * (300.0 / -mvPosition.z);\n          gl_Position = projectionMatrix * mvPosition;\n        }\n      `,\n      fragmentShader: `\n        uniform sampler2D pointTexture;\n        \n        varying float vAlpha;\n        varying vec3 vColor;\n        \n        void main() {\n          vec4 texColor = texture2D(pointTexture, gl_PointCoord);\n          gl_FragColor = vec4(vColor, vAlpha * texColor.a);\n        }\n      `,\n      transparent: true,\n      blending: THREE.AdditiveBlending,\n      depthWrite: false,\n    })\n\n    // Create points object\n    this.points = new THREE.Points(this.geometry, this.material)\n    this.scene.add(this.points)\n  }\n\n  /**\n   * Create texture for particles\n   * @returns {THREE.Texture} Particle texture\n   */\n  createParticleTexture() {\n    const canvas = document.createElement('canvas')\n    canvas.width = 64\n    canvas.height = 64\n\n    const context = canvas.getContext('2d')\n    const gradient = context.createRadialGradient(32, 32, 0, 32, 32, 32)\n    gradient.addColorStop(0, 'rgba(255,255,255,1)')\n    gradient.addColorStop(0.2, 'rgba(255,255,255,0.8)')\n    gradient.addColorStop(0.4, 'rgba(255,255,255,0.4)')\n    gradient.addColorStop(1, 'rgba(255,255,255,0)')\n\n    context.fillStyle = gradient\n    context.fillRect(0, 0, 64, 64)\n\n    const texture = new THREE.Texture(canvas)\n    texture.needsUpdate = true\n    return texture\n  }\n\n  /**\n   * Create underwater particle emitters\n   */\n  createUnderwaterEmitters() {\n    // Bubble emitter\n    this.addEmitter({\n      type: 'bubbles',\n      position: new THREE.Vector3(0, -10, 0),\n      rate: 5, // particles per second\n      life: 8.0,\n      size: { min: 2, max: 6 },\n      velocity: new THREE.Vector3(0, 2, 0),\n      velocityVariation: new THREE.Vector3(0.5, 0.5, 0.5),\n      color: new THREE.Color(0x87ceeb),\n      colorVariation: 0.1,\n      area: new THREE.Vector3(20, 2, 20), // Emission area\n    })\n\n    // Floating particles (debris/plankton)\n    this.addEmitter({\n      type: 'debris',\n      position: new THREE.Vector3(0, 0, 0),\n      rate: 3,\n      life: 15.0,\n      size: { min: 1, max: 3 },\n      velocity: new THREE.Vector3(0.1, 0.05, 0.1),\n      velocityVariation: new THREE.Vector3(0.3, 0.2, 0.3),\n      color: new THREE.Color(0xffffff),\n      colorVariation: 0.2,\n      area: new THREE.Vector3(40, 20, 40),\n    })\n\n    // Light rays effect (very sparse)\n    this.addEmitter({\n      type: 'lightRays',\n      position: new THREE.Vector3(0, 15, 0),\n      rate: 0.5,\n      life: 20.0,\n      size: { min: 8, max: 15 },\n      velocity: new THREE.Vector3(0, -0.5, 0),\n      velocityVariation: new THREE.Vector3(0.1, 0.2, 0.1),\n      color: new THREE.Color(0xffd700),\n      colorVariation: 0.1,\n      area: new THREE.Vector3(30, 5, 30),\n    })\n  }\n\n  /**\n   * Add a particle emitter\n   * @param {Object} emitterConfig - Configuration for the emitter\n   */\n  addEmitter(emitterConfig) {\n    const emitter = {\n      ...emitterConfig,\n      accumulator: 0.0, // For rate control\n      active: true,\n    }\n    this.emitters.push(emitter)\n  }\n\n  /**\n   * Emit a single particle\n   * @param {Object} emitter - Emitter configuration\n   */\n  emitParticle(emitter) {\n    // Find inactive particle\n    const particle = this.particles.find(p => !p.active)\n    if (!particle) {\n      return\n    } // No available particles\n\n    // Calculate random position within emission area\n    const position = emitter.position\n      .clone()\n      .add(\n        new THREE.Vector3(\n          (Math.random() - 0.5) * emitter.area.x,\n          (Math.random() - 0.5) * emitter.area.y,\n          (Math.random() - 0.5) * emitter.area.z\n        )\n      )\n\n    // Calculate random velocity\n    const velocity = emitter.velocity\n      .clone()\n      .add(\n        new THREE.Vector3(\n          (Math.random() - 0.5) * emitter.velocityVariation.x,\n          (Math.random() - 0.5) * emitter.velocityVariation.y,\n          (Math.random() - 0.5) * emitter.velocityVariation.z\n        )\n      )\n\n    // Calculate random size\n    const size =\n      emitter.size.min + Math.random() * (emitter.size.max - emitter.size.min)\n\n    // Calculate random color\n    const color = emitter.color.clone()\n    if (emitter.colorVariation > 0) {\n      color.offsetHSL(\n        (Math.random() - 0.5) * emitter.colorVariation,\n        0,\n        (Math.random() - 0.5) * emitter.colorVariation * 0.5\n      )\n    }\n\n    // Reset particle with new properties\n    particle.reset(position, velocity, emitter.life, size, color)\n  }\n\n  /**\n   * Create a burst of particles at a specific location\n   * @param {THREE.Vector3} position - Position to emit particles\n   * @param {Object} config - Burst configuration\n   */\n  createBurst(position, config = {}) {\n    const count = config.count || 20\n    const life = config.life || 2.0\n    const velocity = config.velocity || new THREE.Vector3(0, 1, 0)\n    const velocityVariation =\n      config.velocityVariation || new THREE.Vector3(2, 2, 2)\n    const color = config.color || new THREE.Color(0xffd700)\n    const size = config.size || { min: 2, max: 8 }\n\n    for (let i = 0; i < count; i++) {\n      const particle = this.particles.find(p => !p.active)\n      if (!particle) {\n        break\n      }\n\n      const burstVelocity = velocity\n        .clone()\n        .add(\n          new THREE.Vector3(\n            (Math.random() - 0.5) * velocityVariation.x,\n            (Math.random() - 0.5) * velocityVariation.y,\n            (Math.random() - 0.5) * velocityVariation.z\n          )\n        )\n\n      const particleSize = size.min + Math.random() * (size.max - size.min)\n\n      particle.reset(position.clone(), burstVelocity, life, particleSize, color)\n    }\n  }\n\n  /**\n   * Update particle system\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    // Update emitters\n    for (const emitter of this.emitters) {\n      if (!emitter.active) {\n        continue\n      }\n\n      emitter.accumulator += deltaTime\n      const emissionInterval = 1.0 / emitter.rate\n\n      while (emitter.accumulator >= emissionInterval) {\n        this.emitParticle(emitter)\n        emitter.accumulator -= emissionInterval\n      }\n    }\n\n    // Update particles\n    let activeCount = 0\n    for (let i = 0; i < this.particles.length; i++) {\n      const particle = this.particles[i]\n\n      if (particle.active) {\n        particle.update(deltaTime)\n\n        // Update render attributes\n        const index3 = activeCount * 3\n        this.positions[index3] = particle.position.x\n        this.positions[index3 + 1] = particle.position.y\n        this.positions[index3 + 2] = particle.position.z\n\n        this.colors[index3] = particle.color.r\n        this.colors[index3 + 1] = particle.color.g\n        this.colors[index3 + 2] = particle.color.b\n\n        this.sizes[activeCount] = particle.size\n        this.alphas[activeCount] = particle.alpha\n\n        activeCount++\n      }\n    }\n\n    // Update geometry\n    this.geometry.attributes.position.needsUpdate = true\n    this.geometry.attributes.color.needsUpdate = true\n    this.geometry.attributes.size.needsUpdate = true\n    this.geometry.attributes.alpha.needsUpdate = true\n\n    // Update draw range to only render active particles\n    this.geometry.setDrawRange(0, activeCount)\n\n    // Update shader uniforms\n    this.material.uniforms.time.value += deltaTime\n  }\n\n  /**\n   * Set emitter active state\n   * @param {string} type - Emitter type\n   * @param {boolean} active - Whether emitter should be active\n   */\n  setEmitterActive(type, active) {\n    const emitter = this.emitters.find(e => e.type === type)\n    if (emitter) {\n      emitter.active = active\n    }\n  }\n\n  /**\n   * Remove all particles\n   */\n  clear() {\n    for (const particle of this.particles) {\n      particle.active = false\n    }\n  }\n\n  /**\n   * Dispose of particle system resources\n   */\n  dispose() {\n    this.scene.remove(this.points)\n    this.geometry.dispose()\n    this.material.dispose()\n    if (this.material.uniforms.pointTexture.value) {\n      this.material.uniforms.pointTexture.value.dispose()\n    }\n  }\n}\n","/**\n * Audio Engine for Ocean Adventure\n *\n * Handles underwater ambient sounds, sound effects, and 3D spatial audio\n * using Web Audio API for immersive underwater experience.\n */\n\nexport class AudioEngine {\n  constructor() {\n    this.audioContext = null\n    this.listener = null\n    this.sounds = new Map()\n    this.isInitialized = false\n    this.isMuted = false\n    this.masterVolume = 0.5\n\n    // Audio settings\n    this.underwaterFilterFrequency = 800 // Low-pass filter for underwater effect\n    this.reverbAmount = 0.3\n\n    console.log('ð AudioEngine created')\n  }\n\n  /**\n   * Initialize the audio system\n   * Note: Must be called after user interaction due to browser autoplay policies\n   */\n  async initialize() {\n    try {\n      // Create audio context\n      this.audioContext = new (window.AudioContext ||\n        window.webkitAudioContext)()\n\n      // Create audio listener for 3D spatial audio\n      this.listener = this.audioContext.listener\n\n      // Create master gain node for volume control\n      this.masterGain = this.audioContext.createGain()\n      this.masterGain.gain.setValueAtTime(\n        this.masterVolume,\n        this.audioContext.currentTime\n      )\n      this.masterGain.connect(this.audioContext.destination)\n\n      // Create underwater effect chain\n      this.createUnderwaterEffects()\n\n      // Load basic sound effects (using simple oscillators for now - avoiding file dependencies)\n      this.createSoundEffects()\n\n      this.isInitialized = true\n      console.log('â AudioEngine initialized successfully')\n    } catch (error) {\n      console.warn('â ï¸ AudioEngine initialization failed:', error)\n      // Graceful fallback - game continues without audio\n    }\n  }\n\n  /**\n   * Create underwater audio effects (reverb, low-pass filter)\n   */\n  createUnderwaterEffects() {\n    if (!this.audioContext) {\n      return\n    }\n\n    // Low-pass filter for muffled underwater sound\n    this.underwaterFilter = this.audioContext.createBiquadFilter()\n    this.underwaterFilter.type = 'lowpass'\n    this.underwaterFilter.frequency.setValueAtTime(\n      this.underwaterFilterFrequency,\n      this.audioContext.currentTime\n    )\n    this.underwaterFilter.Q.setValueAtTime(1, this.audioContext.currentTime)\n\n    // Connect filter to master gain\n    this.underwaterFilter.connect(this.masterGain)\n\n    console.log('ð Underwater audio effects created')\n  }\n\n  /**\n   * Create basic sound effects using oscillators\n   * This avoids external file dependencies while providing audio feedback\n   */\n  createSoundEffects() {\n    if (!this.audioContext) {\n      return\n    }\n\n    // Pre-define sound configurations\n    this.soundConfigs = {\n      starCollect: {\n        type: 'sine',\n        frequency: 880,\n        duration: 0.3,\n        volume: 0.3,\n      },\n      gateActivate: {\n        type: 'triangle',\n        frequency: 220,\n        duration: 1.0,\n        volume: 0.4,\n      },\n      levelComplete: {\n        type: 'square',\n        frequency: 440,\n        duration: 2.0,\n        volume: 0.5,\n      },\n      ambient: {\n        type: 'sine',\n        frequency: 60,\n        duration: -1, // Continuous\n        volume: 0.1,\n      },\n    }\n\n    console.log('ðµ Sound effects configured')\n  }\n\n  /**\n   * Play a sound effect\n   */\n  playSound(soundName, position = null) {\n    if (!this.isInitialized || this.isMuted || !this.audioContext) {\n      return\n    }\n\n    const config = this.soundConfigs[soundName]\n    if (!config) {\n      console.warn(`Sound \"${soundName}\" not found`)\n      return\n    }\n\n    try {\n      // Create oscillator for the sound\n      const oscillator = this.audioContext.createOscillator()\n      const gainNode = this.audioContext.createGain()\n\n      // Configure oscillator\n      oscillator.type = config.type\n      oscillator.frequency.setValueAtTime(\n        config.frequency,\n        this.audioContext.currentTime\n      )\n\n      // Configure volume with fade in/out\n      gainNode.gain.setValueAtTime(0, this.audioContext.currentTime)\n      gainNode.gain.linearRampToValueAtTime(\n        config.volume,\n        this.audioContext.currentTime + 0.1\n      )\n\n      if (config.duration > 0) {\n        gainNode.gain.linearRampToValueAtTime(\n          0,\n          this.audioContext.currentTime + config.duration\n        )\n      }\n\n      // Connect audio chain\n      oscillator.connect(gainNode)\n\n      // Add 3D positioning if position provided\n      if (position) {\n        const panner = this.audioContext.createPanner()\n        panner.panningModel = 'HRTF'\n        panner.setPosition(position.x, position.y, position.z)\n        gainNode.connect(panner)\n        panner.connect(this.underwaterFilter)\n      } else {\n        gainNode.connect(this.underwaterFilter)\n      }\n\n      // Start and stop the sound\n      oscillator.start(this.audioContext.currentTime)\n      if (config.duration > 0) {\n        oscillator.stop(this.audioContext.currentTime + config.duration)\n      }\n\n      console.log(`ð Playing sound: ${soundName}`)\n    } catch (error) {\n      console.warn(`Failed to play sound \"${soundName}\":`, error)\n    }\n  }\n\n  /**\n   * Start ambient underwater sound\n   */\n  startAmbientSound() {\n    if (!this.isInitialized || this.isMuted) {\n      return\n    }\n\n    // Only start if not already playing\n    if (this.ambientOscillator) {\n      return\n    }\n\n    try {\n      this.ambientOscillator = this.audioContext.createOscillator()\n      this.ambientGain = this.audioContext.createGain()\n\n      // Very low frequency for subtle ambient effect\n      this.ambientOscillator.type = 'sine'\n      this.ambientOscillator.frequency.setValueAtTime(\n        40,\n        this.audioContext.currentTime\n      )\n\n      // Low volume ambient sound\n      this.ambientGain.gain.setValueAtTime(0, this.audioContext.currentTime)\n      this.ambientGain.gain.linearRampToValueAtTime(\n        0.05,\n        this.audioContext.currentTime + 2\n      )\n\n      // Connect and start\n      this.ambientOscillator.connect(this.ambientGain)\n      this.ambientGain.connect(this.underwaterFilter)\n      this.ambientOscillator.start()\n\n      console.log('ð Ambient underwater sound started')\n    } catch (error) {\n      console.warn('Failed to start ambient sound:', error)\n    }\n  }\n\n  /**\n   * Stop ambient underwater sound\n   */\n  stopAmbientSound() {\n    if (this.ambientOscillator) {\n      try {\n        this.ambientGain.gain.linearRampToValueAtTime(\n          0,\n          this.audioContext.currentTime + 1\n        )\n        this.ambientOscillator.stop(this.audioContext.currentTime + 1)\n        this.ambientOscillator = null\n        this.ambientGain = null\n        console.log('ð Ambient sound stopped')\n      } catch (error) {\n        console.warn('Error stopping ambient sound:', error)\n      }\n    }\n  }\n\n  /**\n   * Update listener position for 3D audio (should be called each frame)\n   */\n  updateListenerPosition(position, forward, up) {\n    if (!this.listener || !this.isInitialized) {\n      return\n    }\n\n    try {\n      if (this.listener.positionX) {\n        // New Web Audio API approach\n        this.listener.positionX.setValueAtTime(\n          position.x,\n          this.audioContext.currentTime\n        )\n        this.listener.positionY.setValueAtTime(\n          position.y,\n          this.audioContext.currentTime\n        )\n        this.listener.positionZ.setValueAtTime(\n          position.z,\n          this.audioContext.currentTime\n        )\n\n        this.listener.forwardX.setValueAtTime(\n          forward.x,\n          this.audioContext.currentTime\n        )\n        this.listener.forwardY.setValueAtTime(\n          forward.y,\n          this.audioContext.currentTime\n        )\n        this.listener.forwardZ.setValueAtTime(\n          forward.z,\n          this.audioContext.currentTime\n        )\n\n        this.listener.upX.setValueAtTime(up.x, this.audioContext.currentTime)\n        this.listener.upY.setValueAtTime(up.y, this.audioContext.currentTime)\n        this.listener.upZ.setValueAtTime(up.z, this.audioContext.currentTime)\n      } else {\n        // Fallback for older browsers\n        this.listener.setPosition(position.x, position.y, position.z)\n        this.listener.setOrientation(\n          forward.x,\n          forward.y,\n          forward.z,\n          up.x,\n          up.y,\n          up.z\n        )\n      }\n    } catch {\n      // Silently ignore positioning errors\n    }\n  }\n\n  /**\n   * Set master volume\n   */\n  setMasterVolume(volume) {\n    this.masterVolume = Math.max(0, Math.min(1, volume))\n\n    if (this.masterGain && this.audioContext) {\n      this.masterGain.gain.setValueAtTime(\n        this.masterVolume,\n        this.audioContext.currentTime\n      )\n    }\n  }\n\n  /**\n   * Toggle mute state\n   */\n  toggleMute() {\n    this.isMuted = !this.isMuted\n\n    if (this.isMuted) {\n      this.stopAmbientSound()\n    } else if (this.isInitialized) {\n      this.startAmbientSound()\n    }\n\n    console.log(`ð Audio ${this.isMuted ? 'muted' : 'unmuted'}`)\n    return this.isMuted\n  }\n\n  /**\n   * Get current audio state\n   */\n  getState() {\n    return {\n      isInitialized: this.isInitialized,\n      isMuted: this.isMuted,\n      masterVolume: this.masterVolume,\n    }\n  }\n\n  /**\n   * Dispose of audio resources\n   */\n  dispose() {\n    this.stopAmbientSound()\n\n    if (this.audioContext && this.audioContext.state !== 'closed') {\n      this.audioContext.close()\n    }\n\n    this.sounds.clear()\n    this.isInitialized = false\n\n    console.log('ðï¸ AudioEngine disposed')\n  }\n}\n","/**\n * Player Component for Ocean Adventure\n *\n * Enhanced player controller with physics integration,\n * underwater movement mechanics, and collision handling.\n */\n\nimport * as THREE from 'three'\n\nexport class Player {\n  constructor(scene, physicsEngine) {\n    this.scene = scene\n    this.physicsEngine = physicsEngine\n\n    // Player properties\n    this.moveSpeed = 8.0\n    this.rotationSpeed = 3.0\n    this.maxVelocity = 5.0\n\n    // Movement state\n    this.movementVector = new THREE.Vector3()\n    this.isMoving = false\n\n    // Create player mesh and physics body\n    this.createPlayerMesh()\n    this.createPhysicsBody()\n\n    // Bind collision handler\n    this.physicsBody.onCollision = collisions =>\n      this.handleCollisions(collisions)\n  }\n\n  /**\n   * Create the visual representation of the player\n   */\n  createPlayerMesh() {\n    // Create player geometry (capsule for better collision detection)\n    const geometry = new THREE.CapsuleGeometry(0.5, 1.5, 4, 8)\n\n    // Use MeshPhongMaterial for better lighting effects\n    const material = new THREE.MeshPhongMaterial({\n      color: 0x00ff88,\n      transparent: true,\n      opacity: 0.9,\n      shininess: 50,\n      specular: 0x44aa66,\n      emissive: 0x002211,\n      emissiveIntensity: 0.1,\n    })\n\n    this.mesh = new THREE.Mesh(geometry, material)\n    this.mesh.castShadow = true\n    this.mesh.receiveShadow = true\n\n    // Set initial position - start underwater with some depth\n    this.mesh.position.set(0, 2, 0) // Start 3 meters below water surface (5 - 2 = 3m depth)\n\n    // Add to scene\n    this.scene.add(this.mesh)\n  }\n\n  /**\n   * Create physics body for collision detection and movement\n   */\n  createPhysicsBody() {\n    this.physicsBody = this.physicsEngine.createSphereBody(\n      this.mesh.position.clone(), // Use the mesh position which is now set to (0, 2, 0)\n      0.7, // Slightly larger radius for collision detection\n      false // Not static - player can move\n    )\n\n    // Add physics body to engine\n    this.physicsEngine.addRigidBody(this.physicsBody)\n  }\n\n  /**\n   * Handle input and update movement vector\n   * @param {Object} inputState - Current input state\n   */\n  handleInput(inputState) {\n    // Reset movement vector\n    this.movementVector.set(0, 0, 0)\n    this.isMoving = false\n\n    // Keyboard input\n    if (inputState.keys) {\n      if (inputState.keys.forward) {\n        this.movementVector.z -= 1\n        this.isMoving = true\n      }\n      if (inputState.keys.backward) {\n        this.movementVector.z += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.left) {\n        this.movementVector.x -= 1\n        this.isMoving = true\n      }\n      if (inputState.keys.right) {\n        this.movementVector.x += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.up) {\n        this.movementVector.y += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.down) {\n        this.movementVector.y -= 1\n        this.isMoving = true\n      }\n    }\n\n    // Touch/mobile input\n    if (inputState.joystick) {\n      this.movementVector.x += inputState.joystick.x\n      this.movementVector.z += inputState.joystick.y\n      if (\n        Math.abs(inputState.joystick.x) > 0.1 ||\n        Math.abs(inputState.joystick.y) > 0.1\n      ) {\n        this.isMoving = true\n      }\n    }\n\n    // Mobile buttons\n    if (inputState.mobileButtons) {\n      if (inputState.mobileButtons.swimUp) {\n        this.movementVector.y += 1\n        this.isMoving = true\n      }\n      if (inputState.mobileButtons.swimDown) {\n        this.movementVector.y -= 1\n        this.isMoving = true\n      }\n    }\n\n    // Normalize movement vector to prevent faster diagonal movement\n    if (this.movementVector.length() > 1) {\n      this.movementVector.normalize()\n    }\n\n    // Apply movement to physics body\n    this.applyMovement()\n  }\n\n  /**\n   * Apply movement forces to the physics body\n   */\n  applyMovement() {\n    if (!this.isMoving) {\n      // Apply stronger drag when not actively moving\n      this.physicsBody.velocity.multiplyScalar(0.9)\n      return\n    }\n\n    // Calculate movement force\n    const force = this.movementVector\n      .clone()\n      .multiplyScalar(this.moveSpeed * 0.016) // Assume ~60fps for consistent feel\n\n    // Add force to velocity\n    this.physicsBody.velocity.add(force)\n\n    // Clamp velocity to max speed\n    if (this.physicsBody.velocity.length() > this.maxVelocity) {\n      this.physicsBody.velocity.normalize().multiplyScalar(this.maxVelocity)\n    }\n\n    // Rotate player to face movement direction (optional visual enhancement)\n    if (this.movementVector.length() > 0.1) {\n      const targetRotation = Math.atan2(\n        this.movementVector.x,\n        this.movementVector.z\n      )\n      this.mesh.rotation.y = THREE.MathUtils.lerp(\n        this.mesh.rotation.y,\n        targetRotation,\n        this.rotationSpeed * 0.016\n      )\n    }\n  }\n\n  /**\n   * Update player state\n   */\n  update() {\n    // Sync mesh position with physics body (don't override physics with floating animation)\n    this.mesh.position.copy(this.physicsBody.position)\n\n    // Add gentle floating animation to visual representation only\n    const time = Date.now() * 0.001\n    const floatingOffset = Math.sin(time * 2) * 0.02\n    this.mesh.position.y += floatingOffset\n\n    // Don't update physics body position from mesh - let physics handle position\n    // The physics body position should be authoritative\n  }\n\n  /**\n   * Handle collisions with other objects\n   * @param {Array} collisions - Array of objects the player collided with\n   */\n  handleCollisions(collisions) {\n    for (const collision of collisions) {\n      // Handle different types of collisions\n      if (collision.type === 'collectible') {\n        this.handleCollectibleCollision(collision)\n      } else if (collision.type === 'obstacle') {\n        this.handleObstacleCollision(collision)\n      } else if (collision.type === 'environment') {\n        this.handleEnvironmentCollision(collision)\n      }\n    }\n  }\n\n  /**\n   * Handle collision with collectible items\n   * @param {Object} collectible - Collectible object\n   */\n  handleCollectibleCollision(collectible) {\n    // Collectibles will be handled by the game manager\n    // This is just for reference and future expansion\n    console.log('Player collected item:', collectible)\n  }\n\n  /**\n   * Handle collision with obstacles\n   * @param {Object} obstacle - Obstacle object\n   */\n  handleObstacleCollision(obstacle) {\n    // Bounce back slightly from obstacles\n    const direction = this.physicsBody.position\n      .clone()\n      .sub(obstacle.position)\n      .normalize()\n\n    this.physicsBody.velocity.add(direction.multiplyScalar(2))\n  }\n\n  /**\n   * Handle collision with environment objects\n   * @param {Object} _envObject - Environment object (unused for now)\n   */\n  handleEnvironmentCollision() {\n    // Environment collisions are handled by physics engine\n    // This can be used for special effects or sounds\n  }\n\n  /**\n   * Get current player position\n   * @returns {THREE.Vector3} Current position\n   */\n  getPosition() {\n    // Return physics body position (authoritative) instead of mesh position (includes floating animation)\n    return this.physicsBody.position.clone()\n  }\n\n  /**\n   * Set player position\n   * @param {THREE.Vector3} position - New position\n   */\n  setPosition(position) {\n    this.mesh.position.copy(position)\n    this.physicsBody.position.copy(position)\n  }\n\n  /**\n   * Get current velocity\n   * @returns {THREE.Vector3} Current velocity\n   */\n  getVelocity() {\n    return this.physicsBody.velocity.clone()\n  }\n\n  /**\n   * Check if player is moving\n   * @returns {boolean} Whether player is currently moving\n   */\n  getIsMoving() {\n    return this.isMoving || this.physicsBody.velocity.length() > 0.1\n  }\n\n  /**\n   * Dispose of player resources\n   */\n  dispose() {\n    // Remove from physics engine\n    this.physicsEngine.removeRigidBody(this.physicsBody)\n\n    // Remove mesh from scene\n    this.scene.remove(this.mesh)\n\n    // Dispose geometry and material\n    this.mesh.geometry.dispose()\n    this.mesh.material.dispose()\n  }\n}\n","/**\n * Gate Component for Ocean Adventure\n *\n * Represents the glowing portal gates that players must swim through\n * to complete levels after collecting all stars.\n */\n\nimport * as THREE from 'three'\n\nexport class Gate {\n  constructor(scene, physicsEngine, position = new THREE.Vector3(0, 0, -15)) {\n    this.scene = scene\n    this.physicsEngine = physicsEngine\n    this.position = position.clone()\n\n    // Gate properties\n    this.width = 4\n    this.height = 6\n    this.depth = 0.5\n    this.isActivated = false\n    this.isCollected = false\n\n    // Animation properties\n    this.pulseSpeed = 0.02\n    this.rotationSpeed = 0.01\n    this.time = 0\n\n    // Create gate mesh and physics body\n    this.createGateMesh()\n    this.createPhysicsBody()\n\n    console.log('ðª Gate created at position:', position)\n  }\n\n  /**\n   * Create the visual representation of the gate\n   */\n  createGateMesh() {\n    // Create gate frame (torus shape for portal effect)\n    const gateGeometry = new THREE.TorusGeometry(this.width, 0.3, 8, 32)\n\n    // Glowing material with emissive properties\n    const gateMaterial = new THREE.MeshPhongMaterial({\n      color: 0x00ffff,\n      emissive: 0x006666,\n      emissiveIntensity: 0.3,\n      transparent: true,\n      opacity: 0.8,\n      shininess: 100,\n    })\n\n    this.gateMesh = new THREE.Mesh(gateGeometry, gateMaterial)\n    this.gateMesh.position.copy(this.position)\n    this.gateMesh.castShadow = true\n    this.gateMesh.receiveShadow = true\n\n    // Create inner portal effect\n    const portalGeometry = new THREE.PlaneGeometry(\n      this.width * 1.5,\n      this.height\n    )\n    const portalMaterial = new THREE.MeshBasicMaterial({\n      color: 0x0088ff,\n      transparent: true,\n      opacity: 0.2,\n      side: THREE.DoubleSide,\n    })\n\n    this.portalMesh = new THREE.Mesh(portalGeometry, portalMaterial)\n    this.portalMesh.position.copy(this.position)\n\n    // Create gate light source\n    this.gateLight = new THREE.PointLight(0x00ffff, 0.5, 20)\n    this.gateLight.position.copy(this.position)\n    this.gateLight.position.z += 1\n\n    // Add to scene (initially invisible until activated)\n    this.setVisibility(false)\n  }\n\n  /**\n   * Create physics body for collision detection\n   */\n  createPhysicsBody() {\n    const gateSize = new THREE.Vector3(this.width * 2, this.height, this.depth)\n    this.physicsBody = this.physicsEngine.createBoxBody(\n      this.position,\n      gateSize,\n      true // Static - gates don't move\n    )\n    this.physicsBody.type = 'gate'\n    this.physicsBody.gate = this\n    this.physicsEngine.addRigidBody(this.physicsBody)\n  }\n\n  /**\n   * Activate the gate (make it visible and interactive)\n   */\n  activate() {\n    if (this.isActivated) {\n      return\n    }\n\n    this.isActivated = true\n    this.setVisibility(true)\n\n    // Enhanced activation effects\n    this.gateMesh.material.emissiveIntensity = 0.6\n    this.gateLight.intensity = 1.0\n\n    console.log('â¨ Gate activated!')\n  }\n\n  /**\n   * Deactivate the gate\n   */\n  deactivate() {\n    this.isActivated = false\n    this.setVisibility(false)\n    this.gateMesh.material.emissiveIntensity = 0.3\n    this.gateLight.intensity = 0.5\n  }\n\n  /**\n   * Set gate visibility\n   */\n  setVisibility(visible) {\n    if (visible) {\n      this.scene.add(this.gateMesh)\n      this.scene.add(this.portalMesh)\n      this.scene.add(this.gateLight)\n    } else {\n      this.scene.remove(this.gateMesh)\n      this.scene.remove(this.portalMesh)\n      this.scene.remove(this.gateLight)\n    }\n  }\n\n  /**\n   * Handle player collision with gate\n   */\n  onPlayerEnter() {\n    if (!this.isActivated || this.isCollected) {\n      return false\n    }\n\n    this.isCollected = true\n    console.log('ð¯ Player entered gate - Level Complete!')\n\n    // Gate completion effects\n    this.gateMesh.material.emissiveIntensity = 1.0\n    this.gateLight.intensity = 2.0\n\n    return true\n  }\n\n  /**\n   * Update gate animations and effects\n   */\n  update(deltaTime) {\n    if (!this.isActivated) {\n      return\n    }\n\n    this.time += deltaTime\n\n    // Pulsing glow effect\n    const pulseIntensity =\n      0.3 + Math.sin(this.time * this.pulseSpeed * 10) * 0.2\n    this.gateMesh.material.emissiveIntensity = pulseIntensity\n    this.gateLight.intensity = 0.5 + pulseIntensity\n\n    // Gentle rotation\n    this.gateMesh.rotation.z += this.rotationSpeed\n\n    // Portal shimmer effect\n    this.portalMesh.material.opacity =\n      0.1 + Math.sin(this.time * this.pulseSpeed * 15) * 0.1\n  }\n\n  /**\n   * Get gate position\n   */\n  getPosition() {\n    return this.position.clone()\n  }\n\n  /**\n   * Check if gate is activated\n   */\n  getIsActivated() {\n    return this.isActivated\n  }\n\n  /**\n   * Check if gate has been collected (level completed)\n   */\n  getIsCollected() {\n    return this.isCollected\n  }\n\n  /**\n   * Reset gate for new level\n   */\n  reset() {\n    this.isCollected = false\n    this.deactivate()\n    this.time = 0\n  }\n\n  /**\n   * Dispose of gate resources\n   */\n  dispose() {\n    // Remove from physics engine\n    this.physicsEngine.removeRigidBody(this.physicsBody)\n\n    // Remove from scene\n    this.setVisibility(false)\n\n    // Dispose geometry and materials\n    if (this.gateMesh) {\n      this.gateMesh.geometry.dispose()\n      this.gateMesh.material.dispose()\n    }\n\n    if (this.portalMesh) {\n      this.portalMesh.geometry.dispose()\n      this.portalMesh.material.dispose()\n    }\n\n    console.log('ðï¸ Gate disposed')\n  }\n}\n","/**\n * Ocean Adventure - Main Game Entry Point\n *\n * This is a placeholder implementation showing the basic structure\n * for the 3D underwater platform game. The actual game engine\n * implementation will be developed following the Copilot plan.\n */\n\nimport * as THREE from 'three'\nimport { PhysicsEngine } from './core/Physics.js'\nimport { ParticleSystem } from './core/ParticleSystem.js'\nimport { AudioEngine } from './core/AudioEngine.js'\nimport { Player } from './components/Player.js'\nimport { Gate } from './components/Gate.js'\n\n// Game configuration\nconst CONFIG = {\n  targetFPS: 60,\n  mobileFPS: 30,\n  canvasId: 'gameCanvas',\n  loadingId: 'loading',\n  uiId: 'ui',\n}\n\nclass OceanAdventure {\n  constructor() {\n    this.scene = null\n    this.camera = null\n    this.renderer = null\n    this.canvas = null\n    this.isLoaded = false\n    this.isMobile = this.detectMobile()\n\n    // Core systems\n    this.physicsEngine = null\n    this.particleSystem = null\n    this.audioEngine = null\n    this.player = null\n    this.gate = null\n    this.environmentObjects = []\n\n    // Game state\n    this.starCount = 0\n    this.levelNumber = 1\n\n    // Input state\n    this.inputState = {\n      keys: {\n        forward: false,\n        backward: false,\n        left: false,\n        right: false,\n        up: false,\n        down: false,\n      },\n      joystick: { x: 0, y: 0 },\n      mobileButtons: { swimUp: false, swimDown: false },\n    }\n\n    // Timing\n    this.lastTime = 0\n\n    console.log('ð Ocean Adventure - Initializing...')\n  }\n\n  async initialize() {\n    const steps = [\n      { name: 'Canvas Setup', fn: () => this.setupCanvas() },\n      { name: 'WebGL Renderer', fn: () => this.setupRenderer() },\n      { name: '3D Scene', fn: () => this.setupScene() },\n      { name: 'Camera', fn: () => this.setupCamera() },\n      { name: 'Lighting', fn: () => this.setupLights() },\n      { name: 'Physics Engine', fn: () => this.initializePhysics() },\n      { name: 'Particle System', fn: () => this.initializeParticleSystem() },\n      { name: 'Audio Engine', fn: () => this.initializeAudio() },\n      { name: 'Environment', fn: () => this.createUnderwaterEnvironment() },\n      { name: 'Player', fn: () => this.createPlayer() },\n      { name: 'Sample Stars', fn: () => this.createSampleStars() },\n      { name: 'Gate', fn: () => this.createGate() },\n      { name: 'Event Listeners', fn: () => this.setupEventListeners() },\n      {\n        name: 'UI Initialization',\n        fn: () => {\n          this.hideLoading()\n          this.showUI()\n        },\n      },\n      { name: 'Game Loop', fn: () => this.startGameLoop() },\n    ]\n\n    try {\n      console.log('ð® Ocean Adventure - Starting initialization...')\n\n      for (let i = 0; i < steps.length; i++) {\n        const step = steps[i]\n        console.log(`[${i + 1}/${steps.length}] Initializing ${step.name}...`)\n\n        try {\n          await step.fn()\n          console.log(`â ${step.name} initialized successfully`)\n        } catch (stepError) {\n          console.error(`â Failed to initialize ${step.name}:`, stepError)\n          throw new Error(\n            `Initialization failed at step \"${step.name}\": ${stepError.message}`\n          )\n        }\n      }\n\n      this.isLoaded = true\n      console.log('ð Ocean Adventure - Ready to play!')\n    } catch (error) {\n      console.error('â Failed to initialize game:', error)\n      this.showError('Failed to initialize game: ' + error.message)\n    }\n  }\n\n  setupCanvas() {\n    console.log('ð® Setting up canvas...')\n    this.canvas = document.getElementById(CONFIG.canvasId)\n    if (!this.canvas) {\n      throw new Error('Game canvas not found')\n    }\n    console.log('â Canvas found and configured')\n  }\n\n  setupRenderer() {\n    console.log('ð¨ Setting up WebGL renderer...')\n    try {\n      this.renderer = new THREE.WebGLRenderer({\n        canvas: this.canvas,\n        antialias: !this.isMobile, // Disable antialiasing on mobile for performance\n        alpha: false,\n        powerPreference: this.isMobile ? 'low-power' : 'high-performance',\n        failIfMajorPerformanceCaveat: false, // Allow fallback rendering\n        preserveDrawingBuffer: false, // Better performance\n        premultipliedAlpha: false,\n        stencil: false, // Reduce memory usage\n      })\n\n      this.renderer.setSize(window.innerWidth, window.innerHeight)\n      this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\n      this.renderer.setClearColor(0x001122, 1) // Deep ocean blue\n\n      // Enable shadows with mobile-optimized settings\n      this.renderer.shadowMap.enabled = true\n      this.renderer.shadowMap.type = this.isMobile\n        ? THREE.BasicShadowMap // Faster shadow type for mobile\n        : THREE.PCFSoftShadowMap // Better quality for desktop\n\n      // Enhanced WebGL settings for modern lighting\n      this.renderer.outputColorSpace = THREE.SRGBColorSpace\n      this.renderer.toneMapping = THREE.ACESFilmicToneMapping\n      this.renderer.toneMappingExposure = 1.0\n\n      // Validate WebGL context\n      const gl = this.renderer.getContext()\n      if (!gl) {\n        throw new Error('Failed to get WebGL context')\n      }\n\n      // Add error handling for WebGL\n      gl.getExtension('WEBGL_lose_context')\n\n      console.log('â WebGL renderer configured successfully')\n    } catch (error) {\n      console.error('â Failed to setup WebGL renderer:', error)\n      throw new Error(`WebGL initialization failed: ${error.message}`)\n    }\n  }\n\n  setupScene() {\n    console.log('ð Setting up 3D scene...')\n    this.scene = new THREE.Scene()\n    console.log('â 3D scene created successfully')\n  }\n\n  /**\n   * Initialize physics engine\n   */\n  initializePhysics() {\n    this.physicsEngine = new PhysicsEngine()\n    console.log('â¡ Physics engine initialized')\n  }\n\n  /**\n   * Initialize particle system\n   */\n  initializeParticleSystem() {\n    this.particleSystem = new ParticleSystem(this.scene, 500) // Reduced for mobile performance\n    console.log('â¨ Particle system initialized')\n  }\n\n  /**\n   * Initialize audio engine\n   */\n  initializeAudio() {\n    this.audioEngine = new AudioEngine()\n    // Note: Audio will be initialized on first user interaction due to browser policies\n    console.log('ð Audio engine created (will initialize on user interaction)')\n  }\n\n  /**\n   * Try to initialize audio on first user interaction\n   */\n  async tryInitializeAudio() {\n    if (this.audioEngine && !this.audioEngine.isInitialized) {\n      try {\n        await this.audioEngine.initialize()\n        this.audioEngine.startAmbientSound()\n        console.log('ð Audio initialized and ambient sound started')\n      } catch (error) {\n        console.warn('Audio initialization failed:', error)\n      }\n    }\n  }\n\n  setupCamera() {\n    this.camera = new THREE.PerspectiveCamera(\n      75, // Field of view\n      window.innerWidth / window.innerHeight, // Aspect ratio\n      0.1, // Near clipping plane\n      1000 // Far clipping plane\n    )\n\n    // Position camera behind and above the player\n    this.camera.position.set(0, 5, 10)\n    this.camera.lookAt(0, 0, 0)\n  }\n\n  setupLights() {\n    // Enhanced underwater ambient lighting (adjusted for modern lighting model)\n    const ambientLight = new THREE.AmbientLight(0x336699, 0.3) // Reduced from 0.6\n    this.scene.add(ambientLight)\n\n    // Primary directional light simulating filtered sunlight from above (adjusted intensity)\n    const directionalLight = new THREE.DirectionalLight(0x87ceeb, 2.5) // Increased from 1.2\n    directionalLight.position.set(0, 50, 10)\n\n    // Enable shadows with optimized settings for mobile compatibility\n    if (this.renderer.shadowMap.enabled) {\n      directionalLight.castShadow = true\n      // Use smaller shadow map sizes on mobile for better performance\n      const shadowMapSize = this.isMobile ? 512 : 1024\n      directionalLight.shadow.mapSize.width = shadowMapSize\n      directionalLight.shadow.mapSize.height = shadowMapSize\n      directionalLight.shadow.camera.near = 0.5\n      directionalLight.shadow.camera.far = 500\n      directionalLight.shadow.camera.left = -50\n      directionalLight.shadow.camera.right = 50\n      directionalLight.shadow.camera.top = 50\n      directionalLight.shadow.camera.bottom = -50\n      // Use less expensive shadow map type on mobile\n      if (this.isMobile) {\n        directionalLight.shadow.bias = -0.0005\n      }\n    }\n\n    this.scene.add(directionalLight)\n\n    // Add volumetric underwater lighting with point lights for better WebGL effects\n    this.addUnderwaterVolumetricLights()\n\n    // Add subtle rim lighting to enhance object definition (adjusted intensity)\n    const rimLight = new THREE.DirectionalLight(0x4a9eff, 0.8) // Increased from 0.4\n    rimLight.position.set(-20, 10, -20)\n    this.scene.add(rimLight)\n  }\n\n  addUnderwaterVolumetricLights() {\n    // Create multiple point lights for underwater caustics effect\n    const lightColors = [0x4a9eff, 0x87ceeb, 0x6495ed, 0x00bfff]\n    const lightCount = this.isMobile ? 3 : 5 // Fewer lights on mobile\n\n    for (let i = 0; i < lightCount; i++) {\n      const pointLight = new THREE.PointLight(\n        lightColors[i % lightColors.length],\n        this.isMobile ? 2.0 : 3.0, // Adjusted for modern lighting model\n        30, // Distance\n        2 // Decay\n      )\n\n      // Position lights in a scattered pattern above the scene\n      const angle = (i / lightCount) * Math.PI * 2\n      const radius = 15 + Math.random() * 10\n      pointLight.position.set(\n        Math.cos(angle) * radius,\n        8 + Math.random() * 5, // Varying heights\n        Math.sin(angle) * radius\n      )\n\n      // Store animation properties\n      pointLight.userData = {\n        originalPosition: pointLight.position.clone(),\n        animationOffset: Math.random() * Math.PI * 2,\n        animationSpeed: 0.5 + Math.random() * 0.5,\n        animationRadius: 2 + Math.random() * 3,\n      }\n\n      this.scene.add(pointLight)\n\n      // Store reference for animation\n      if (!this.volumetricLights) {\n        this.volumetricLights = []\n      }\n      this.volumetricLights.push(pointLight)\n    }\n  }\n\n  createUnderwaterEnvironment() {\n    // Create water surface at Y=5 (matches depth meter calculation)\n    const waterSurfaceGeometry = new THREE.PlaneGeometry(200, 200)\n    const waterSurfaceMaterial = new THREE.MeshPhongMaterial({\n      color: 0x006994,\n      transparent: true,\n      opacity: 0.6,\n      shininess: 100,\n      specular: 0x87ceeb,\n      side: THREE.DoubleSide,\n    })\n    const waterSurface = new THREE.Mesh(\n      waterSurfaceGeometry,\n      waterSurfaceMaterial\n    )\n    waterSurface.rotation.x = -Math.PI / 2\n    waterSurface.position.y = 5 // Water surface level used by depth meter\n    waterSurface.receiveShadow = true\n    this.scene.add(waterSurface)\n\n    // Create ocean floor with enhanced material\n    const floorGeometry = new THREE.PlaneGeometry(100, 100)\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      color: 0x8b4513,\n      shininess: 30,\n      specular: 0x222222,\n    })\n    const floor = new THREE.Mesh(floorGeometry, floorMaterial)\n    floor.rotation.x = -Math.PI / 2\n    floor.position.y = -5\n    floor.receiveShadow = true\n    this.scene.add(floor)\n\n    // Create physics body for floor\n    const floorPhysicsBody = this.physicsEngine.createBoxBody(\n      new THREE.Vector3(0, -5, 0),\n      new THREE.Vector3(100, 0.1, 100),\n      true // Static\n    )\n    floorPhysicsBody.type = 'environment'\n    this.physicsEngine.addRigidBody(floorPhysicsBody)\n\n    // Add coral/rocks with enhanced materials and lighting\n    for (let i = 0; i < 10; i++) {\n      const radius = 0.5 + Math.random() * 1.5\n      const geometry = new THREE.SphereGeometry(radius)\n\n      // Use MeshPhongMaterial for better lighting on all platforms\n      const hue = Math.random() * 0.3\n      const material = new THREE.MeshPhongMaterial({\n        color: new THREE.Color().setHSL(hue, 0.7, 0.5),\n        shininess: 60 + Math.random() * 40,\n        specular: new THREE.Color().setHSL(hue, 0.3, 0.8),\n        // Add slight transparency for underwater effect\n        transparent: true,\n        opacity: 0.9,\n      })\n\n      const coral = new THREE.Mesh(geometry, material)\n\n      const position = new THREE.Vector3(\n        (Math.random() - 0.5) * 80,\n        -4 + Math.random() * 2,\n        (Math.random() - 0.5) * 80\n      )\n      coral.position.copy(position)\n      coral.castShadow = true\n      coral.receiveShadow = true\n      this.scene.add(coral)\n\n      // Add physics body for collision\n      const coralPhysicsBody = this.physicsEngine.createSphereBody(\n        position,\n        radius * 1.2, // Slightly larger for collision detection\n        true // Static\n      )\n      coralPhysicsBody.type = 'environment'\n      coralPhysicsBody.mesh = coral // Reference to visual representation\n      this.physicsEngine.addRigidBody(coralPhysicsBody)\n      this.environmentObjects.push({\n        mesh: coral,\n        physicsBody: coralPhysicsBody,\n      })\n    }\n  }\n\n  createPlayer() {\n    // Create enhanced player with physics\n    this.player = new Player(this.scene, this.physicsEngine)\n    console.log('ð Player created with physics')\n  }\n\n  /**\n   * Create the level completion gate\n   */\n  createGate() {\n    // Position gate at the back of the level\n    const gatePosition = new THREE.Vector3(0, 2, -20)\n    this.gate = new Gate(this.scene, this.physicsEngine, gatePosition)\n    console.log('ðª Gate created')\n  }\n\n  createSampleStars() {\n    this.stars = []\n\n    // Create glowing star collectibles with enhanced materials\n    for (let i = 0; i < 5; i++) {\n      const starGeometry = new THREE.SphereGeometry(0.3)\n\n      // Use MeshPhongMaterial for better lighting effects\n      const starMaterial = new THREE.MeshPhongMaterial({\n        color: 0xffd700,\n        emissive: 0xffd700,\n        emissiveIntensity: 0.4,\n        shininess: 100,\n        specular: 0xffffff,\n        transparent: true,\n        opacity: 0.95,\n      })\n\n      const star = new THREE.Mesh(starGeometry, starMaterial)\n      const position = new THREE.Vector3(\n        (Math.random() - 0.5) * 20,\n        Math.random() * 8 - 2,\n        (Math.random() - 0.5) * 20\n      )\n      star.position.copy(position)\n      star.castShadow = true\n\n      // Add physics body for collision detection\n      const starPhysicsBody = this.physicsEngine.createSphereBody(\n        position,\n        0.5, // Slightly larger for easier collection\n        true // Static - stars don't move\n      )\n      starPhysicsBody.type = 'collectible'\n      starPhysicsBody.mesh = star\n      starPhysicsBody.collected = false\n      this.physicsEngine.addRigidBody(starPhysicsBody)\n\n      // Add simple rotation animation and floating effect\n      star.userData = {\n        rotationSpeed: 0.02 + Math.random() * 0.02,\n        floatSpeed: 0.01 + Math.random() * 0.01,\n        floatOffset: Math.random() * Math.PI * 2,\n        originalY: position.y,\n        physicsBody: starPhysicsBody,\n      }\n\n      this.stars.push({ mesh: star, physicsBody: starPhysicsBody })\n      this.scene.add(star)\n    }\n  }\n\n  setupEventListeners() {\n    // Handle window resize\n    window.addEventListener('resize', () => this.onWindowResize(), {\n      passive: true,\n    })\n\n    // Enhanced input handling\n    window.addEventListener('keydown', event => this.onKeyDown(event))\n    window.addEventListener('keyup', event => this.onKeyUp(event))\n\n    // Touch controls for mobile\n    if (this.isMobile) {\n      this.setupTouchControls()\n    }\n\n    // Settings modal functionality\n    this.setupSettingsModal()\n  }\n\n  onKeyDown(event) {\n    // Initialize audio on first user interaction\n    this.tryInitializeAudio()\n\n    switch (event.code) {\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.keys.forward = true\n        break\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.keys.backward = true\n        break\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.keys.left = true\n        break\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.keys.right = true\n        break\n      case 'Space':\n        this.inputState.keys.up = true\n        event.preventDefault()\n        break\n      case 'ShiftLeft':\n        this.inputState.keys.down = true\n        break\n    }\n  }\n\n  onKeyUp(event) {\n    switch (event.code) {\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.keys.forward = false\n        break\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.keys.backward = false\n        break\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.keys.left = false\n        break\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.keys.right = false\n        break\n      case 'Space':\n        this.inputState.keys.up = false\n        break\n      case 'ShiftLeft':\n        this.inputState.keys.down = false\n        break\n    }\n  }\n\n  setupTouchControls() {\n    // Setup virtual joystick\n    this.setupVirtualJoystick()\n\n    // Setup mobile action buttons\n    this.setupMobileButtons()\n\n    // Touch control state for general canvas interactions\n    this.touchState = {\n      startX: 0,\n      startY: 0,\n      currentX: 0,\n      currentY: 0,\n      isActive: false,\n    }\n\n    // General canvas touch events (for swipe gestures)\n    this.canvas.addEventListener('touchstart', event => {\n      event.preventDefault()\n\n      // Initialize audio on first touch\n      this.tryInitializeAudio()\n\n      if (event.touches.length > 0) {\n        const touch = event.touches[0]\n        this.touchState.startX = touch.clientX\n        this.touchState.startY = touch.clientY\n        this.touchState.currentX = touch.clientX\n        this.touchState.currentY = touch.clientY\n        this.touchState.isActive = true\n      }\n    })\n\n    this.canvas.addEventListener('touchmove', event => {\n      event.preventDefault()\n      if (event.touches.length > 0 && this.touchState.isActive) {\n        const touch = event.touches[0]\n        this.touchState.currentX = touch.clientX\n        this.touchState.currentY = touch.clientY\n\n        // Calculate movement delta for swipe gestures\n        const deltaX = this.touchState.currentX - this.touchState.startX\n        const deltaY = this.touchState.currentY - this.touchState.startY\n\n        // Apply gentle swipe-based movement (subtle effect)\n        const moveSpeed = 0.05\n        const sensitivity = 3\n\n        if (Math.abs(deltaX) > 20) {\n          this.player.position.x += (deltaX / sensitivity) * moveSpeed * 0.01\n        }\n\n        if (Math.abs(deltaY) > 20) {\n          this.player.position.z += (deltaY / sensitivity) * moveSpeed * 0.01\n        }\n\n        this.updateCamera()\n      }\n    })\n\n    this.canvas.addEventListener('touchend', event => {\n      event.preventDefault()\n      this.touchState.isActive = false\n    })\n\n    this.canvas.addEventListener('touchcancel', event => {\n      event.preventDefault()\n      this.touchState.isActive = false\n    })\n  }\n\n  setupVirtualJoystick() {\n    const joystick = document.getElementById('virtualJoystick')\n    const knob = document.getElementById('joystickKnob')\n\n    if (!joystick || !knob) {\n      return\n    }\n\n    const joystickState = {\n      isActive: false,\n      centerX: 0,\n      centerY: 0,\n      currentX: 0,\n      currentY: 0,\n    }\n\n    joystick.addEventListener('touchstart', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (event.touches.length > 0) {\n        const touch = event.touches[0]\n        const rect = joystick.getBoundingClientRect()\n\n        joystickState.isActive = true\n        joystickState.centerX = rect.left + rect.width / 2\n        joystickState.centerY = rect.top + rect.height / 2\n        joystickState.currentX = touch.clientX\n        joystickState.currentY = touch.clientY\n\n        // Visual feedback - highlight joystick when active\n        joystick.style.borderColor = 'rgba(255, 255, 255, 0.6)'\n        joystick.style.background = 'rgba(0, 17, 34, 0.7)'\n\n        this.updateJoystickKnob(knob, joystickState, rect)\n      }\n    })\n\n    joystick.addEventListener('touchmove', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (event.touches.length > 0 && joystickState.isActive) {\n        const touch = event.touches[0]\n        const rect = joystick.getBoundingClientRect()\n\n        joystickState.currentX = touch.clientX\n        joystickState.currentY = touch.clientY\n\n        // Calculate movement vector\n        const deltaX = joystickState.currentX - joystickState.centerX\n        const deltaY = joystickState.currentY - joystickState.centerY\n        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)\n        const maxDistance = rect.width / 2 - 20\n\n        // Normalize and apply movement\n        if (distance > 5) {\n          const normalizedX = deltaX / maxDistance\n          const normalizedY = deltaY / maxDistance\n\n          // Update input state with improved sensitivity for mobile\n          this.inputState.joystick.x = Math.max(\n            -1,\n            Math.min(1, normalizedX * 1.2)\n          )\n          this.inputState.joystick.y = Math.max(\n            -1,\n            Math.min(1, normalizedY * 1.2)\n          )\n        } else {\n          this.inputState.joystick.x = 0\n          this.inputState.joystick.y = 0\n        }\n\n        this.updateJoystickKnob(knob, joystickState, rect)\n      }\n    })\n\n    joystick.addEventListener('touchend', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      joystickState.isActive = false\n      this.inputState.joystick.x = 0\n      this.inputState.joystick.y = 0\n\n      // Reset visual feedback\n      joystick.style.borderColor = 'rgba(255, 255, 255, 0.3)'\n      joystick.style.background = 'rgba(0, 17, 34, 0.5)'\n      knob.style.transform = 'translate(-50%, -50%)'\n    })\n\n    joystick.addEventListener('touchcancel', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      joystickState.isActive = false\n      this.inputState.joystick.x = 0\n      this.inputState.joystick.y = 0\n\n      // Reset visual feedback\n      joystick.style.borderColor = 'rgba(255, 255, 255, 0.3)'\n      joystick.style.background = 'rgba(0, 17, 34, 0.5)'\n      knob.style.transform = 'translate(-50%, -50%)'\n    })\n  }\n\n  updateJoystickKnob(knob, joystickState, rect) {\n    const deltaX = joystickState.currentX - joystickState.centerX\n    const deltaY = joystickState.currentY - joystickState.centerY\n    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)\n    const maxDistance = rect.width / 2 - 20\n\n    if (distance <= maxDistance) {\n      knob.style.transform = `translate(calc(-50% + ${deltaX}px), calc(-50% + ${deltaY}px))`\n    } else {\n      const angle = Math.atan2(deltaY, deltaX)\n      const x = Math.cos(angle) * maxDistance\n      const y = Math.sin(angle) * maxDistance\n      knob.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px))`\n    }\n  }\n\n  setupMobileButtons() {\n    const swimUpBtn = document.getElementById('swimUpBtn')\n    const swimDownBtn = document.getElementById('swimDownBtn')\n\n    if (swimUpBtn) {\n      // Add more responsive event handling\n      swimUpBtn.addEventListener('touchstart', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = true\n        swimUpBtn.style.background = 'rgba(255, 255, 255, 0.4)'\n      })\n\n      swimUpBtn.addEventListener('touchend', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = false\n        swimUpBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n\n      swimUpBtn.addEventListener('touchcancel', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = false\n        swimUpBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n    }\n\n    if (swimDownBtn) {\n      // Add more responsive event handling\n      swimDownBtn.addEventListener('touchstart', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = true\n        swimDownBtn.style.background = 'rgba(255, 255, 255, 0.4)'\n      })\n\n      swimDownBtn.addEventListener('touchend', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = false\n        swimDownBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n\n      swimDownBtn.addEventListener('touchcancel', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = false\n        swimDownBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n    }\n  }\n\n  setupSettingsModal() {\n    const settingsButton = document.getElementById('settingsButton')\n    const settingsModal = document.getElementById('settingsModal')\n    const closeSettings = document.getElementById('closeSettings')\n\n    if (settingsButton && settingsModal && closeSettings) {\n      // Open settings\n      const openSettings = event => {\n        if (event) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        settingsModal.classList.remove('hidden')\n        // Prevent body scrolling when modal is open\n        document.body.style.overflow = 'hidden'\n      }\n\n      // Close settings\n      const closeModal = event => {\n        if (event) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        settingsModal.classList.add('hidden')\n        // Restore body scrolling\n        document.body.style.overflow = ''\n      }\n\n      // Simple event handling - click events work on both desktop and mobile\n      settingsButton.addEventListener('click', openSettings)\n      closeSettings.addEventListener('click', closeModal)\n\n      // Close on background click - simplified and more reliable detection\n      settingsModal.addEventListener('click', event => {\n        // Check if the click target is the modal background itself (not a child element)\n        if (event.target === settingsModal) {\n          closeModal(event)\n        }\n      })\n\n      // Close on escape key\n      document.addEventListener('keydown', event => {\n        if (\n          event.key === 'Escape' &&\n          !settingsModal.classList.contains('hidden')\n        ) {\n          closeModal()\n        }\n      })\n    }\n  }\n\n  onWindowResize() {\n    this.camera.aspect = window.innerWidth / window.innerHeight\n    this.camera.updateProjectionMatrix()\n    this.renderer.setSize(window.innerWidth, window.innerHeight)\n  }\n\n  updateCamera() {\n    // Enhanced camera follow logic\n    const playerPosition = this.player.getPosition()\n    const offset = new THREE.Vector3(0, 5, 10)\n    const targetPosition = playerPosition.clone().add(offset)\n\n    this.camera.position.lerp(targetPosition, 0.1)\n    this.camera.lookAt(playerPosition)\n  }\n\n  startGameLoop() {\n    const animate = currentTime => {\n      requestAnimationFrame(animate)\n\n      // Calculate delta time\n      const deltaTime =\n        this.lastTime > 0 ? (currentTime - this.lastTime) / 1000 : 0.016\n      this.lastTime = currentTime\n\n      this.update(deltaTime)\n      this.render()\n    }\n    animate(0)\n  }\n\n  update(deltaTime) {\n    if (!this.isLoaded) {\n      return\n    }\n\n    // Clamp delta time to prevent large jumps\n    deltaTime = Math.min(deltaTime, 0.033) // Max 30fps equivalent\n\n    // Update physics engine\n    this.physicsEngine.update(deltaTime)\n\n    // Update player with input\n    this.player.handleInput(this.inputState)\n    this.player.update()\n\n    // Update particle system\n    this.particleSystem.update(deltaTime)\n\n    // Update gate animations\n    if (this.gate) {\n      this.gate.update(deltaTime)\n    }\n\n    // Update audio system\n    if (this.audioEngine && this.audioEngine.isInitialized) {\n      const playerPos = this.player.getPosition()\n      const forward = this.camera.getWorldDirection(new THREE.Vector3())\n      const up = this.camera.up\n      this.audioEngine.updateListenerPosition(playerPos, forward, up)\n    }\n\n    // Update camera\n    this.updateCamera()\n\n    // Update UI (including depth meter)\n    this.updateUI()\n\n    // Animate stars with floating and pulsing effects\n    this.stars.forEach(starData => {\n      const star = starData.mesh\n      const userData = star.userData\n\n      // Rotation animation\n      star.rotation.y += userData.rotationSpeed\n      star.rotation.x += userData.rotationSpeed * 0.5\n\n      // Floating animation\n      const time = Date.now() * 0.001\n      const floatY =\n        userData.originalY +\n        Math.sin(time * userData.floatSpeed + userData.floatOffset) * 0.3\n      star.position.y = floatY\n\n      // Pulsing emissive effect\n      const pulseFactor = 0.3 + Math.sin(time * 2 + userData.floatOffset) * 0.1\n      star.material.emissiveIntensity = pulseFactor\n    })\n\n    // Animate volumetric lights for underwater caustics effect\n    if (this.volumetricLights) {\n      const time = Date.now() * 0.001\n      this.volumetricLights.forEach(light => {\n        const userData = light.userData\n        const animationTime =\n          time * userData.animationSpeed + userData.animationOffset\n\n        // Create gentle swaying motion\n        const offsetX = Math.sin(animationTime) * userData.animationRadius\n        const offsetZ = Math.cos(animationTime * 1.3) * userData.animationRadius\n        const offsetY = Math.sin(animationTime * 0.7) * 1\n\n        light.position.x = userData.originalPosition.x + offsetX\n        light.position.y = userData.originalPosition.y + offsetY\n        light.position.z = userData.originalPosition.z + offsetZ\n\n        // Subtle intensity variation for flickering water caustics\n        const intensityVariation = 0.8 + Math.sin(animationTime * 3) * 0.2\n        light.intensity = (this.isMobile ? 0.6 : 0.8) * intensityVariation\n      })\n    }\n\n    // Check star collection using collision detection\n    this.checkStarCollection()\n\n    // Check gate collision\n    this.checkGateCollision()\n  }\n\n  checkStarCollection() {\n    // Get player collisions from physics engine\n    const playerCollisions = this.physicsEngine.collisionSystem.checkCollisions(\n      this.player.physicsBody\n    )\n\n    for (const collision of playerCollisions) {\n      if (collision.type === 'collectible' && !collision.collected) {\n        // Collect star\n        collision.collected = true\n\n        // Find and remove the star from scene and physics\n        const starData = this.stars.find(s => s.physicsBody === collision)\n        if (starData) {\n          // Remove from scene\n          this.scene.remove(starData.mesh)\n\n          // Remove from physics\n          this.physicsEngine.removeRigidBody(starData.physicsBody)\n\n          // Remove from stars array\n          const index = this.stars.indexOf(starData)\n          if (index !== -1) {\n            this.stars.splice(index, 1)\n          }\n\n          // Update game state\n          this.starCount++\n          this.updateUI()\n\n          // Play collection sound\n          if (this.audioEngine) {\n            this.audioEngine.playSound('starCollect', starData.mesh.position)\n          }\n\n          // Create collection effect\n          this.particleSystem.createBurst(starData.mesh.position, {\n            count: 15,\n            life: 1.5,\n            velocity: new THREE.Vector3(0, 2, 0),\n            velocityVariation: new THREE.Vector3(3, 3, 3),\n            color: new THREE.Color(0xffd700),\n            size: { min: 3, max: 8 },\n          })\n\n          console.log(`â­ Star collected! Total: ${this.starCount}`)\n\n          // Check if all stars collected - activate gate\n          if (this.stars.length === 0) {\n            this.activateGate()\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Activate the gate when all stars are collected\n   */\n  activateGate() {\n    if (this.gate && !this.gate.getIsActivated()) {\n      this.gate.activate()\n\n      // Play gate activation sound\n      if (this.audioEngine) {\n        this.audioEngine.playSound('gateActivate', this.gate.getPosition())\n      }\n\n      console.log('ðª Gate activated! Swim through to complete level!')\n    }\n  }\n\n  /**\n   * Check for gate collision and level completion\n   */\n  checkGateCollision() {\n    if (!this.gate || !this.gate.getIsActivated()) {\n      return\n    }\n\n    // Get player collisions from physics engine\n    const playerCollisions = this.physicsEngine.collisionSystem.checkCollisions(\n      this.player.physicsBody\n    )\n\n    for (const collision of playerCollisions) {\n      if (collision.type === 'gate' && collision.gate) {\n        const levelCompleted = collision.gate.onPlayerEnter()\n        if (levelCompleted) {\n          this.levelComplete()\n          break\n        }\n      }\n    }\n  }\n\n  levelComplete() {\n    console.log('ð Level Complete!')\n\n    // Play level completion sound\n    if (this.audioEngine) {\n      this.audioEngine.playSound('levelComplete')\n    }\n\n    this.levelNumber++\n\n    // Reset gate for next level\n    if (this.gate) {\n      this.gate.reset()\n    }\n\n    // Reset level with new stars\n    this.createSampleStars()\n    this.updateUI()\n  }\n\n  updateUI() {\n    document.getElementById('starCount').textContent = this.starCount\n    document.getElementById('levelNumber').textContent = this.levelNumber\n\n    // Update depth meter based on player Y position\n    if (this.player) {\n      const playerPosition = this.player.getPosition()\n      // Water surface is at Y=5, so depth = surface level - current Y position\n      const waterSurface = 5.0\n      const depth = Math.max(0, waterSurface - playerPosition.y)\n      document.getElementById('depthMeter').textContent = depth.toFixed(1)\n    }\n  }\n\n  render() {\n    try {\n      if (this.renderer && this.scene && this.camera) {\n        this.renderer.render(this.scene, this.camera)\n      }\n    } catch (error) {\n      // Silently handle WebGL render errors to prevent spam\n      if (this.webglErrorCount < 5) {\n        console.warn('WebGL render error:', error)\n        this.webglErrorCount = (this.webglErrorCount || 0) + 1\n      }\n    }\n  }\n\n  hideLoading() {\n    const loadingElement = document.getElementById(CONFIG.loadingId)\n    if (loadingElement) {\n      loadingElement.classList.add('hidden')\n    }\n  }\n\n  showUI() {\n    const uiElement = document.getElementById(CONFIG.uiId)\n    if (uiElement) {\n      uiElement.classList.remove('hidden')\n    }\n    this.updateUI()\n  }\n\n  showError(message) {\n    const loadingElement = document.getElementById(CONFIG.loadingId)\n    if (loadingElement) {\n      loadingElement.innerHTML = `\n        <div style=\"color: #ff4444; text-align: center;\">\n          <h3>â ï¸ Error Loading Game</h3>\n          <p>${message}</p>\n          <p style=\"margin-top: 20px; font-size: 14px; color: #ccc;\">\n            Please check the browser console for more details and try refreshing the page.\n          </p>\n        </div>\n      `\n      loadingElement.classList.remove('hidden')\n    }\n  }\n\n  detectMobile() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent\n    )\n  }\n}\n\n// Initialize the game when the page loads\nwindow.addEventListener(\n  'DOMContentLoaded',\n  async () => {\n    try {\n      console.log('ð Ocean Adventure - Starting initialization...')\n      const game = new OceanAdventure()\n      await game.initialize()\n    } catch (error) {\n      console.error('â Critical error during game initialization:', error)\n      // Show error in loading div if game initialization fails\n      const loadingElement = document.getElementById('loading')\n      if (loadingElement) {\n        loadingElement.innerHTML = `\n          <div style=\"color: #ff4444; text-align: center;\">\n            <h3>â ï¸ Critical Error</h3>\n            <p>Failed to initialize Ocean Adventure: ${error.message}</p>\n            <p style=\"margin-top: 20px; font-size: 14px; color: #ccc;\">\n              Please check the browser console for more details and try refreshing the page.\n            </p>\n          </div>\n        `\n      }\n    }\n  },\n  { passive: true }\n)\n\n// Handle WebGL context loss\nwindow.addEventListener(\n  'webglcontextlost',\n  event => {\n    event.preventDefault()\n    console.warn('WebGL context lost')\n  },\n  { passive: false }\n)\n\nwindow.addEventListener(\n  'webglcontextrestored',\n  () => {\n    console.log('WebGL context restored')\n    // Reinitialize game here if needed\n  },\n  { passive: true }\n)\n\n// Performance optimization: Pause game when page is hidden\ndocument.addEventListener(\n  'visibilitychange',\n  () => {\n    if (document.hidden) {\n      // Page is hidden, reduce performance\n      console.log('Game paused due to page visibility')\n    } else {\n      // Page is visible, resume normal performance\n      console.log('Game resumed')\n    }\n  },\n  { passive: true }\n)\n"],"names":["CollisionSystem","constructor","this","colliders","staticColliders","addCollider","collider","isStatic","push","removeCollider","index","indexOf","splice","checkCollision","objectA","objectB","collisionType","checkSphereCollision","checkAABBCollision","checkSphereAABBCollision","sphereA","sphereB","position","distanceTo","radius","boxA","boxB","minA","clone","sub","size","multiplyScalar","maxA","add","minB","maxB","x","y","z","sphere","box","boxMin","boxMax","closestPoint","THREE.Vector3","Math","max","min","checkCollisions","object","collisions","UnderwaterPhysics","buoyancyForce","dragCoefficient","currentDirection","currentStrength","applyBuoyancy","body","deltaTime","buoyancy","velocity","applyDrag","applyCurrent","currentForce","applyUnderwaterEffects","PhysicsEngine","gravity","waterDensity","collisionSystem","underwaterPhysics","rigidBodies","isUnderwater","addRigidBody","removeRigidBody","update","updateBody","previousPosition","gravityForce","velocityDelta","length","resolveCollisions","filter","collision","type","collected","copy","onCollision","collisionPairs","i","bodyA","bodyB","createSphereBody","createBoxBody","Particle","life","color","maxLife","alpha","active","reset","ParticleSystem","scene","maxParticles","particles","emitters","initializeParticlePool","createParticleRenderSystem","createUnderwaterEmitters","particle","THREE.Color","geometry","THREE.BufferGeometry","positions","Float32Array","colors","sizes","alphas","setAttribute","THREE.BufferAttribute","material","THREE.ShaderMaterial","uniforms","time","value","pointTexture","createParticleTexture","vertexShader","fragmentShader","transparent","blending","THREE.AdditiveBlending","depthWrite","points","THREE.Points","canvas","document","createElement","width","height","context","getContext","gradient","createRadialGradient","addColorStop","fillStyle","fillRect","texture","THREE.Texture","needsUpdate","addEmitter","rate","velocityVariation","colorVariation","area","emitterConfig","emitter","accumulator","emitParticle","find","p","random","offsetHSL","createBurst","config","count","burstVelocity","particleSize","emissionInterval","activeCount","index3","r","g","b","attributes","setDrawRange","setEmitterActive","e","clear","dispose","remove","AudioEngine","audioContext","listener","sounds","Map","isInitialized","isMuted","masterVolume","underwaterFilterFrequency","reverbAmount","console","log","initialize","window","AudioContext","webkitAudioContext","masterGain","createGain","gain","setValueAtTime","currentTime","connect","destination","createUnderwaterEffects","createSoundEffects","error","warn","underwaterFilter","createBiquadFilter","frequency","Q","soundConfigs","starCollect","duration","volume","gateActivate","levelComplete","ambient","playSound","soundName","oscillator","createOscillator","gainNode","linearRampToValueAtTime","panner","createPanner","panningModel","setPosition","start","stop","startAmbientSound","ambientOscillator","ambientGain","stopAmbientSound","updateListenerPosition","forward","up","positionX","positionY","positionZ","forwardX","forwardY","forwardZ","upX","upY","upZ","setOrientation","setMasterVolume","toggleMute","getState","state","close","Player","physicsEngine","moveSpeed","rotationSpeed","maxVelocity","movementVector","isMoving","createPlayerMesh","createPhysicsBody","physicsBody","handleCollisions","THREE.CapsuleGeometry","THREE.MeshPhongMaterial","opacity","shininess","specular","emissive","emissiveIntensity","mesh","THREE.Mesh","castShadow","receiveShadow","set","handleInput","inputState","keys","backward","left","right","down","joystick","abs","mobileButtons","swimUp","swimDown","normalize","applyMovement","force","targetRotation","atan2","rotation","THREE.MathUtils","lerp","Date","now","floatingOffset","sin","handleCollectibleCollision","handleObstacleCollision","handleEnvironmentCollision","collectible","obstacle","direction","getPosition","getVelocity","getIsMoving","Gate","depth","isActivated","isCollected","pulseSpeed","createGateMesh","gateGeometry","THREE.TorusGeometry","gateMaterial","gateMesh","portalGeometry","THREE.PlaneGeometry","portalMaterial","THREE.MeshBasicMaterial","side","THREE.DoubleSide","portalMesh","gateLight","THREE.PointLight","setVisibility","gateSize","gate","activate","intensity","deactivate","visible","onPlayerEnter","pulseIntensity","getIsActivated","getIsCollected","CONFIG","OceanAdventure","camera","renderer","isLoaded","isMobile","detectMobile","particleSystem","audioEngine","player","environmentObjects","starCount","levelNumber","lastTime","steps","name","fn","setupCanvas","setupRenderer","setupScene","setupCamera","setupLights","initializePhysics","initializeParticleSystem","initializeAudio","createUnderwaterEnvironment","createPlayer","createSampleStars","createGate","setupEventListeners","hideLoading","showUI","startGameLoop","step","stepError","Error","message","showError","getElementById","THREE.WebGLRenderer","antialias","powerPreference","failIfMajorPerformanceCaveat","preserveDrawingBuffer","premultipliedAlpha","stencil","setSize","innerWidth","innerHeight","setPixelRatio","devicePixelRatio","setClearColor","shadowMap","enabled","THREE.BasicShadowMap","THREE.PCFSoftShadowMap","outputColorSpace","THREE.SRGBColorSpace","toneMapping","THREE.ACESFilmicToneMapping","toneMappingExposure","gl","getExtension","THREE.Scene","tryInitializeAudio","THREE.PerspectiveCamera","lookAt","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","shadowMapSize","shadow","mapSize","near","far","top","bottom","bias","addUnderwaterVolumetricLights","rimLight","lightColors","lightCount","pointLight","angle","PI","cos","userData","originalPosition","animationOffset","animationSpeed","animationRadius","volumetricLights","waterSurfaceGeometry","waterSurfaceMaterial","waterSurface","floorGeometry","floorMaterial","floor","floorPhysicsBody","THREE.SphereGeometry","hue","setHSL","coral","coralPhysicsBody","gatePosition","stars","starGeometry","starMaterial","star","starPhysicsBody","floatSpeed","floatOffset","originalY","addEventListener","onWindowResize","passive","event","onKeyDown","onKeyUp","setupTouchControls","setupSettingsModal","code","preventDefault","setupVirtualJoystick","setupMobileButtons","touchState","startX","startY","currentX","currentY","isActive","touches","touch","clientX","clientY","deltaX","deltaY","sensitivity","updateCamera","knob","joystickState","centerX","centerY","stopPropagation","rect","getBoundingClientRect","style","borderColor","background","updateJoystickKnob","distance","sqrt","maxDistance","normalizedX","normalizedY","transform","swimUpBtn","swimDownBtn","settingsButton","settingsModal","closeSettings","openSettings","classList","overflow","closeModal","target","key","contains","aspect","updateProjectionMatrix","playerPosition","offset","targetPosition","animate","requestAnimationFrame","render","playerPos","getWorldDirection","updateUI","forEach","starData","floatY","pulseFactor","light","animationTime","offsetX","offsetZ","offsetY","intensityVariation","checkStarCollection","checkGateCollision","playerCollisions","s","activateGate","textContent","toFixed","webglErrorCount","loadingElement","uiElement","innerHTML","test","navigator","userAgent","async","game","hidden"],"mappings":"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"}