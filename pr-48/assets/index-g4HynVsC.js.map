{"version":3,"file":"index-g4HynVsC.js","sources":["../../src/core/Physics.js","../../src/core/ParticleSystem.js","../../src/core/AudioEngine.js","../../src/components/Player.js","../../src/components/Gate.js","../../src/components/StarGeometry.js","../../src/main.js"],"sourcesContent":["/**\n * Physics Engine for Ocean Adventure\n *\n * Implements collision detection and underwater physics simulation\n * including buoyancy, drag, and environmental forces.\n */\n\nimport * as THREE from 'three'\n\n/**\n * Collision system supporting AABB and sphere-based collision detection\n */\nexport class CollisionSystem {\n  constructor() {\n    this.colliders = []\n    this.staticColliders = []\n  }\n\n  /**\n   * Add a collider to the system\n   * @param {Object} collider - Collider object with geometry and position\n   * @param {boolean} isStatic - Whether the collider is static (doesn't move)\n   */\n  addCollider(collider, isStatic = false) {\n    const list = isStatic ? this.staticColliders : this.colliders\n    list.push(collider)\n  }\n\n  /**\n   * Remove a collider from the system\n   * @param {Object} collider - Collider to remove\n   */\n  removeCollider(collider) {\n    let index = this.colliders.indexOf(collider)\n    if (index !== -1) {\n      this.colliders.splice(index, 1)\n      return\n    }\n\n    index = this.staticColliders.indexOf(collider)\n    if (index !== -1) {\n      this.staticColliders.splice(index, 1)\n    }\n  }\n\n  /**\n   * Check for collisions between two objects\n   * @param {Object} objectA - First object with position and geometry\n   * @param {Object} objectB - Second object with position and geometry\n   * @returns {boolean} Whether objects are colliding\n   */\n  checkCollision(objectA, objectB) {\n    // Sphere-sphere collision detection\n    if (\n      objectA.collisionType === 'sphere' &&\n      objectB.collisionType === 'sphere'\n    ) {\n      return this.checkSphereCollision(objectA, objectB)\n    }\n\n    // AABB-AABB collision detection\n    if (objectA.collisionType === 'box' && objectB.collisionType === 'box') {\n      return this.checkAABBCollision(objectA, objectB)\n    }\n\n    // Sphere-AABB collision detection\n    if (\n      (objectA.collisionType === 'sphere' && objectB.collisionType === 'box') ||\n      (objectA.collisionType === 'box' && objectB.collisionType === 'sphere')\n    ) {\n      return this.checkSphereAABBCollision(objectA, objectB)\n    }\n\n    return false\n  }\n\n  /**\n   * Check sphere-sphere collision\n   * @param {Object} sphereA - First sphere\n   * @param {Object} sphereB - Second sphere\n   * @returns {boolean} Whether spheres are colliding\n   */\n  checkSphereCollision(sphereA, sphereB) {\n    const distance = sphereA.position.distanceTo(sphereB.position)\n    const radiusSum = sphereA.radius + sphereB.radius\n    return distance <= radiusSum\n  }\n\n  /**\n   * Check AABB-AABB collision\n   * @param {Object} boxA - First box\n   * @param {Object} boxB - Second box\n   * @returns {boolean} Whether boxes are colliding\n   */\n  checkAABBCollision(boxA, boxB) {\n    const minA = boxA.position\n      .clone()\n      .sub(boxA.size.clone().multiplyScalar(0.5))\n    const maxA = boxA.position\n      .clone()\n      .add(boxA.size.clone().multiplyScalar(0.5))\n    const minB = boxB.position\n      .clone()\n      .sub(boxB.size.clone().multiplyScalar(0.5))\n    const maxB = boxB.position\n      .clone()\n      .add(boxB.size.clone().multiplyScalar(0.5))\n\n    return (\n      minA.x <= maxB.x &&\n      maxA.x >= minB.x &&\n      minA.y <= maxB.y &&\n      maxA.y >= minB.y &&\n      minA.z <= maxB.z &&\n      maxA.z >= minB.z\n    )\n  }\n\n  /**\n   * Check sphere-AABB collision\n   * @param {Object} objectA - First object (sphere or box)\n   * @param {Object} objectB - Second object (sphere or box)\n   * @returns {boolean} Whether objects are colliding\n   */\n  checkSphereAABBCollision(objectA, objectB) {\n    const sphere = objectA.collisionType === 'sphere' ? objectA : objectB\n    const box = objectA.collisionType === 'box' ? objectA : objectB\n\n    const boxMin = box.position\n      .clone()\n      .sub(box.size.clone().multiplyScalar(0.5))\n    const boxMax = box.position\n      .clone()\n      .add(box.size.clone().multiplyScalar(0.5))\n\n    // Find closest point on box to sphere center\n    const closestPoint = new THREE.Vector3(\n      Math.max(boxMin.x, Math.min(sphere.position.x, boxMax.x)),\n      Math.max(boxMin.y, Math.min(sphere.position.y, boxMax.y)),\n      Math.max(boxMin.z, Math.min(sphere.position.z, boxMax.z))\n    )\n\n    const distance = sphere.position.distanceTo(closestPoint)\n    return distance <= sphere.radius\n  }\n\n  /**\n   * Check all collisions for a given object\n   * @param {Object} object - Object to check collisions for\n   * @returns {Array} Array of colliding objects\n   */\n  checkCollisions(object) {\n    const collisions = []\n\n    // Check against dynamic colliders\n    for (const collider of this.colliders) {\n      if (collider !== object && this.checkCollision(object, collider)) {\n        collisions.push(collider)\n      }\n    }\n\n    // Check against static colliders\n    for (const collider of this.staticColliders) {\n      if (this.checkCollision(object, collider)) {\n        collisions.push(collider)\n      }\n    }\n\n    return collisions\n  }\n}\n\n/**\n * Underwater physics simulation\n */\nexport class UnderwaterPhysics {\n  constructor() {\n    this.buoyancyForce = 2.0 // Further reduced buoyancy force (was 4.0)\n    this.dragCoefficient = 0.95 // Water resistance (0-1, lower = more drag)\n    this.currentDirection = new THREE.Vector3(0.1, 0, 0.05) // Gentle underwater current\n    this.currentStrength = 0.02\n  }\n\n  /**\n   * Apply buoyancy force to an object\n   * @param {Object} body - Physics body with velocity and position\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyBuoyancy(body, deltaTime) {\n    const buoyancy = new THREE.Vector3(0, this.buoyancyForce * deltaTime, 0)\n    body.velocity.add(buoyancy)\n  }\n\n  /**\n   * Apply drag force to an object\n   * @param {Object} body - Physics body with velocity\n   */\n  applyDrag(body) {\n    body.velocity.multiplyScalar(this.dragCoefficient)\n  }\n\n  /**\n   * Apply underwater current to an object\n   * @param {Object} body - Physics body with velocity\n   * @param {number} currentStrength - Strength multiplier for current effect\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyCurrent(body, currentStrength = 1.0, deltaTime) {\n    const currentForce = this.currentDirection\n      .clone()\n      .multiplyScalar(this.currentStrength * currentStrength * deltaTime)\n    body.velocity.add(currentForce)\n  }\n\n  /**\n   * Apply all underwater physics effects\n   * @param {Object} body - Physics body\n   * @param {number} deltaTime - Time since last frame\n   */\n  applyUnderwaterEffects(body, deltaTime) {\n    this.applyBuoyancy(body, deltaTime)\n    this.applyDrag(body)\n    this.applyCurrent(body, 1.0, deltaTime)\n  }\n}\n\n/**\n * Main Physics Engine\n */\nexport class PhysicsEngine {\n  constructor() {\n    this.gravity = new THREE.Vector3(0, -9.8, 0)\n    this.waterDensity = 1000 // kg/mÂ³\n    this.collisionSystem = new CollisionSystem()\n    this.underwaterPhysics = new UnderwaterPhysics()\n    this.rigidBodies = []\n    this.isUnderwater = true // For now, everything is underwater\n  }\n\n  /**\n   * Add a rigid body to the physics simulation\n   * @param {Object} body - Physics body to add\n   */\n  addRigidBody(body) {\n    this.rigidBodies.push(body)\n\n    // Add to collision system if it has collision properties\n    if (body.collisionType) {\n      this.collisionSystem.addCollider(body, body.isStatic)\n    }\n  }\n\n  /**\n   * Remove a rigid body from the physics simulation\n   * @param {Object} body - Physics body to remove\n   */\n  removeRigidBody(body) {\n    const index = this.rigidBodies.indexOf(body)\n    if (index !== -1) {\n      this.rigidBodies.splice(index, 1)\n      this.collisionSystem.removeCollider(body)\n    }\n  }\n\n  /**\n   * Update all physics bodies\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    for (const body of this.rigidBodies) {\n      this.updateBody(body, deltaTime)\n    }\n  }\n\n  /**\n   * Update a single physics body\n   * @param {Object} body - Physics body to update\n   * @param {number} deltaTime - Time since last frame\n   */\n  updateBody(body, deltaTime) {\n    if (body.isStatic) {\n      return\n    }\n\n    // Initialize velocity if not present\n    if (!body.velocity) {\n      body.velocity = new THREE.Vector3()\n    }\n\n    // Store previous position for collision resolution\n    const previousPosition = body.position.clone()\n\n    // Apply forces based on environment\n    if (this.isUnderwater) {\n      this.underwaterPhysics.applyUnderwaterEffects(body, deltaTime)\n    } else {\n      // Apply gravity in air\n      const gravityForce = this.gravity.clone().multiplyScalar(deltaTime)\n      body.velocity.add(gravityForce)\n    }\n\n    // Apply velocity to position\n    const velocityDelta = body.velocity.clone().multiplyScalar(deltaTime)\n    body.position.add(velocityDelta)\n\n    // Check collisions and resolve\n    const collisions = this.collisionSystem.checkCollisions(body)\n    if (collisions.length > 0) {\n      this.resolveCollisions(body, collisions, previousPosition)\n    }\n  }\n\n  /**\n   * Resolve collisions for a body\n   * @param {Object} body - Physics body that collided\n   * @param {Array} collisions - Array of colliding objects\n   * @param {THREE.Vector3} previousPosition - Position before collision\n   */\n  resolveCollisions(body, collisions, previousPosition) {\n    // Check if any collisions are with collectibles that should not block movement\n    const blockingCollisions = collisions.filter(\n      collision => collision.type !== 'collectible' || collision.collected\n    )\n\n    // Only revert position and stop movement for blocking collisions\n    if (blockingCollisions.length > 0) {\n      // Simple collision resolution: revert to previous position and stop movement\n      body.position.copy(previousPosition)\n\n      // Reduce velocity on collision (bounce/friction)\n      body.velocity.multiplyScalar(0.3)\n    }\n\n    // Notify collision callbacks if present (for all collisions)\n    if (body.onCollision) {\n      body.onCollision(collisions)\n    }\n  }\n\n  /**\n   * Check collisions for all bodies\n   * @returns {Array} Array of collision pairs\n   */\n  checkCollisions() {\n    const collisionPairs = []\n\n    for (let i = 0; i < this.rigidBodies.length; i++) {\n      const bodyA = this.rigidBodies[i]\n      const collisions = this.collisionSystem.checkCollisions(bodyA)\n\n      for (const bodyB of collisions) {\n        collisionPairs.push([bodyA, bodyB])\n      }\n    }\n\n    return collisionPairs\n  }\n\n  /**\n   * Create a sphere collision body\n   * @param {THREE.Vector3} position - Position of the sphere\n   * @param {number} radius - Radius of the sphere\n   * @param {boolean} isStatic - Whether the body is static\n   * @returns {Object} Collision body\n   */\n  createSphereBody(position, radius, isStatic = false) {\n    return {\n      position: position.clone(),\n      velocity: new THREE.Vector3(),\n      collisionType: 'sphere',\n      radius: radius,\n      isStatic: isStatic,\n    }\n  }\n\n  /**\n   * Create a box collision body\n   * @param {THREE.Vector3} position - Position of the box\n   * @param {THREE.Vector3} size - Size of the box\n   * @param {boolean} isStatic - Whether the body is static\n   * @returns {Object} Collision body\n   */\n  createBoxBody(position, size, isStatic = false) {\n    return {\n      position: position.clone(),\n      velocity: new THREE.Vector3(),\n      collisionType: 'box',\n      size: size.clone(),\n      isStatic: isStatic,\n    }\n  }\n}\n","/**\n * Particle System for Ocean Adventure\n *\n * Creates underwater atmosphere with bubbles, light rays,\n * and collection effects for enhanced immersion.\n */\n\nimport * as THREE from 'three'\n\n/**\n * Individual particle class\n */\nclass Particle {\n  constructor(position, velocity, life, size, color) {\n    this.position = position.clone()\n    this.velocity = velocity.clone()\n    this.life = life\n    this.maxLife = life\n    this.size = size\n    this.color = color.clone()\n    this.alpha = 1.0\n    this.active = true\n  }\n\n  /**\n   * Update particle state\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    if (!this.active) {\n      return\n    }\n\n    // Update position\n    this.position.add(this.velocity.clone().multiplyScalar(deltaTime))\n\n    // Update life\n    this.life -= deltaTime\n\n    // Update alpha based on life remaining\n    this.alpha = this.life / this.maxLife\n\n    // Deactivate particle if life is over\n    if (this.life <= 0) {\n      this.active = false\n    }\n  }\n\n  /**\n   * Reset particle with new properties\n   * @param {THREE.Vector3} position - New position\n   * @param {THREE.Vector3} velocity - New velocity\n   * @param {number} life - New life span\n   * @param {number} size - New size\n   * @param {THREE.Color} color - New color\n   */\n  reset(position, velocity, life, size, color) {\n    this.position.copy(position)\n    this.velocity.copy(velocity)\n    this.life = life\n    this.maxLife = life\n    this.size = size\n    this.color.copy(color)\n    this.alpha = 1.0\n    this.active = true\n  }\n}\n\n/**\n * Main particle system class\n */\nexport class ParticleSystem {\n  constructor(scene, maxParticles = 1000) {\n    this.scene = scene\n    this.maxParticles = maxParticles\n    this.particles = []\n    this.emitters = []\n\n    // Create particle pool\n    this.initializeParticlePool()\n\n    // Create particle geometry and material\n    this.createParticleRenderSystem()\n\n    // Add default underwater emitters\n    this.createUnderwaterEmitters()\n  }\n\n  /**\n   * Initialize the particle pool for object reuse\n   */\n  initializeParticlePool() {\n    for (let i = 0; i < this.maxParticles; i++) {\n      const particle = new Particle(\n        new THREE.Vector3(),\n        new THREE.Vector3(),\n        1.0,\n        1.0,\n        new THREE.Color(0xffffff)\n      )\n      particle.active = false\n      this.particles.push(particle)\n    }\n  }\n\n  /**\n   * Create the rendering system for particles\n   */\n  createParticleRenderSystem() {\n    // Create geometry for point sprites\n    this.geometry = new THREE.BufferGeometry()\n\n    // Create arrays for particle attributes\n    this.positions = new Float32Array(this.maxParticles * 3)\n    this.colors = new Float32Array(this.maxParticles * 3)\n    this.sizes = new Float32Array(this.maxParticles)\n    this.alphas = new Float32Array(this.maxParticles)\n\n    // Set attributes\n    this.geometry.setAttribute(\n      'position',\n      new THREE.BufferAttribute(this.positions, 3)\n    )\n    this.geometry.setAttribute(\n      'color',\n      new THREE.BufferAttribute(this.colors, 3)\n    )\n    this.geometry.setAttribute('size', new THREE.BufferAttribute(this.sizes, 1))\n    this.geometry.setAttribute(\n      'alpha',\n      new THREE.BufferAttribute(this.alphas, 1)\n    )\n\n    // Create shader material for better underwater effects\n    this.material = new THREE.ShaderMaterial({\n      uniforms: {\n        time: { value: 0.0 },\n        pointTexture: { value: this.createParticleTexture() },\n      },\n      vertexShader: `\n        attribute float size;\n        attribute float alpha;\n        attribute vec3 color;\n        \n        varying float vAlpha;\n        varying vec3 vColor;\n        \n        void main() {\n          vAlpha = alpha;\n          vColor = color;\n          \n          vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n          gl_PointSize = size * (300.0 / -mvPosition.z);\n          gl_Position = projectionMatrix * mvPosition;\n        }\n      `,\n      fragmentShader: `\n        uniform sampler2D pointTexture;\n        \n        varying float vAlpha;\n        varying vec3 vColor;\n        \n        void main() {\n          vec4 texColor = texture2D(pointTexture, gl_PointCoord);\n          gl_FragColor = vec4(vColor, vAlpha * texColor.a);\n        }\n      `,\n      transparent: true,\n      blending: THREE.AdditiveBlending,\n      depthWrite: false,\n    })\n\n    // Create points object\n    this.points = new THREE.Points(this.geometry, this.material)\n    this.scene.add(this.points)\n  }\n\n  /**\n   * Create texture for particles\n   * @returns {THREE.Texture} Particle texture\n   */\n  createParticleTexture() {\n    const canvas = document.createElement('canvas')\n    canvas.width = 64\n    canvas.height = 64\n\n    const context = canvas.getContext('2d')\n    const gradient = context.createRadialGradient(32, 32, 0, 32, 32, 32)\n    gradient.addColorStop(0, 'rgba(255,255,255,1)')\n    gradient.addColorStop(0.2, 'rgba(255,255,255,0.8)')\n    gradient.addColorStop(0.4, 'rgba(255,255,255,0.4)')\n    gradient.addColorStop(1, 'rgba(255,255,255,0)')\n\n    context.fillStyle = gradient\n    context.fillRect(0, 0, 64, 64)\n\n    const texture = new THREE.Texture(canvas)\n    texture.needsUpdate = true\n    return texture\n  }\n\n  /**\n   * Create underwater particle emitters\n   */\n  createUnderwaterEmitters() {\n    // Bubble emitter\n    this.addEmitter({\n      type: 'bubbles',\n      position: new THREE.Vector3(0, -10, 0),\n      rate: 5, // particles per second\n      life: 8.0,\n      size: { min: 2, max: 6 },\n      velocity: new THREE.Vector3(0, 2, 0),\n      velocityVariation: new THREE.Vector3(0.5, 0.5, 0.5),\n      color: new THREE.Color(0x87ceeb),\n      colorVariation: 0.1,\n      area: new THREE.Vector3(20, 2, 20), // Emission area\n    })\n\n    // Floating particles (debris/plankton)\n    this.addEmitter({\n      type: 'debris',\n      position: new THREE.Vector3(0, 0, 0),\n      rate: 3,\n      life: 15.0,\n      size: { min: 1, max: 3 },\n      velocity: new THREE.Vector3(0.1, 0.05, 0.1),\n      velocityVariation: new THREE.Vector3(0.3, 0.2, 0.3),\n      color: new THREE.Color(0xffffff),\n      colorVariation: 0.2,\n      area: new THREE.Vector3(40, 20, 40),\n    })\n\n    // Light rays effect (very sparse)\n    this.addEmitter({\n      type: 'lightRays',\n      position: new THREE.Vector3(0, 15, 0),\n      rate: 0.5,\n      life: 20.0,\n      size: { min: 8, max: 15 },\n      velocity: new THREE.Vector3(0, -0.5, 0),\n      velocityVariation: new THREE.Vector3(0.1, 0.2, 0.1),\n      color: new THREE.Color(0xffd700),\n      colorVariation: 0.1,\n      area: new THREE.Vector3(30, 5, 30),\n    })\n  }\n\n  /**\n   * Add a particle emitter\n   * @param {Object} emitterConfig - Configuration for the emitter\n   */\n  addEmitter(emitterConfig) {\n    const emitter = {\n      ...emitterConfig,\n      accumulator: 0.0, // For rate control\n      active: true,\n    }\n    this.emitters.push(emitter)\n  }\n\n  /**\n   * Emit a single particle\n   * @param {Object} emitter - Emitter configuration\n   */\n  emitParticle(emitter) {\n    // Find inactive particle\n    const particle = this.particles.find(p => !p.active)\n    if (!particle) {\n      return\n    } // No available particles\n\n    // Calculate random position within emission area\n    const position = emitter.position\n      .clone()\n      .add(\n        new THREE.Vector3(\n          (Math.random() - 0.5) * emitter.area.x,\n          (Math.random() - 0.5) * emitter.area.y,\n          (Math.random() - 0.5) * emitter.area.z\n        )\n      )\n\n    // Calculate random velocity\n    const velocity = emitter.velocity\n      .clone()\n      .add(\n        new THREE.Vector3(\n          (Math.random() - 0.5) * emitter.velocityVariation.x,\n          (Math.random() - 0.5) * emitter.velocityVariation.y,\n          (Math.random() - 0.5) * emitter.velocityVariation.z\n        )\n      )\n\n    // Calculate random size\n    const size =\n      emitter.size.min + Math.random() * (emitter.size.max - emitter.size.min)\n\n    // Calculate random color\n    const color = emitter.color.clone()\n    if (emitter.colorVariation > 0) {\n      color.offsetHSL(\n        (Math.random() - 0.5) * emitter.colorVariation,\n        0,\n        (Math.random() - 0.5) * emitter.colorVariation * 0.5\n      )\n    }\n\n    // Reset particle with new properties\n    particle.reset(position, velocity, emitter.life, size, color)\n  }\n\n  /**\n   * Create a burst of particles at a specific location\n   * @param {THREE.Vector3} position - Position to emit particles\n   * @param {Object} config - Burst configuration\n   */\n  createBurst(position, config = {}) {\n    const count = config.count || 20\n    const life = config.life || 2.0\n    const velocity = config.velocity || new THREE.Vector3(0, 1, 0)\n    const velocityVariation =\n      config.velocityVariation || new THREE.Vector3(2, 2, 2)\n    const color = config.color || new THREE.Color(0xffd700)\n    const size = config.size || { min: 2, max: 8 }\n\n    for (let i = 0; i < count; i++) {\n      const particle = this.particles.find(p => !p.active)\n      if (!particle) {\n        break\n      }\n\n      const burstVelocity = velocity\n        .clone()\n        .add(\n          new THREE.Vector3(\n            (Math.random() - 0.5) * velocityVariation.x,\n            (Math.random() - 0.5) * velocityVariation.y,\n            (Math.random() - 0.5) * velocityVariation.z\n          )\n        )\n\n      const particleSize = size.min + Math.random() * (size.max - size.min)\n\n      particle.reset(position.clone(), burstVelocity, life, particleSize, color)\n    }\n  }\n\n  /**\n   * Update particle system\n   * @param {number} deltaTime - Time since last frame\n   */\n  update(deltaTime) {\n    // Update emitters\n    for (const emitter of this.emitters) {\n      if (!emitter.active) {\n        continue\n      }\n\n      emitter.accumulator += deltaTime\n      const emissionInterval = 1.0 / emitter.rate\n\n      while (emitter.accumulator >= emissionInterval) {\n        this.emitParticle(emitter)\n        emitter.accumulator -= emissionInterval\n      }\n    }\n\n    // Update particles\n    let activeCount = 0\n    for (let i = 0; i < this.particles.length; i++) {\n      const particle = this.particles[i]\n\n      if (particle.active) {\n        particle.update(deltaTime)\n\n        // Update render attributes\n        const index3 = activeCount * 3\n        this.positions[index3] = particle.position.x\n        this.positions[index3 + 1] = particle.position.y\n        this.positions[index3 + 2] = particle.position.z\n\n        this.colors[index3] = particle.color.r\n        this.colors[index3 + 1] = particle.color.g\n        this.colors[index3 + 2] = particle.color.b\n\n        this.sizes[activeCount] = particle.size\n        this.alphas[activeCount] = particle.alpha\n\n        activeCount++\n      }\n    }\n\n    // Update geometry\n    this.geometry.attributes.position.needsUpdate = true\n    this.geometry.attributes.color.needsUpdate = true\n    this.geometry.attributes.size.needsUpdate = true\n    this.geometry.attributes.alpha.needsUpdate = true\n\n    // Update draw range to only render active particles\n    this.geometry.setDrawRange(0, activeCount)\n\n    // Update shader uniforms\n    this.material.uniforms.time.value += deltaTime\n  }\n\n  /**\n   * Set emitter active state\n   * @param {string} type - Emitter type\n   * @param {boolean} active - Whether emitter should be active\n   */\n  setEmitterActive(type, active) {\n    const emitter = this.emitters.find(e => e.type === type)\n    if (emitter) {\n      emitter.active = active\n    }\n  }\n\n  /**\n   * Remove all particles\n   */\n  clear() {\n    for (const particle of this.particles) {\n      particle.active = false\n    }\n  }\n\n  /**\n   * Dispose of particle system resources\n   */\n  dispose() {\n    this.scene.remove(this.points)\n    this.geometry.dispose()\n    this.material.dispose()\n    if (this.material.uniforms.pointTexture.value) {\n      this.material.uniforms.pointTexture.value.dispose()\n    }\n  }\n}\n","/**\n * Audio Engine for Ocean Adventure\n *\n * Handles underwater ambient sounds, sound effects, and 3D spatial audio\n * using Web Audio API for immersive underwater experience.\n */\n\nexport class AudioEngine {\n  constructor() {\n    this.audioContext = null\n    this.listener = null\n    this.sounds = new Map()\n    this.isInitialized = false\n    this.isMuted = false\n    this.masterVolume = 0.5\n\n    // Audio settings\n    this.underwaterFilterFrequency = 800 // Low-pass filter for underwater effect\n    this.reverbAmount = 0.3\n\n    console.log('ð AudioEngine created')\n  }\n\n  /**\n   * Initialize the audio system\n   * Note: Must be called after user interaction due to browser autoplay policies\n   */\n  async initialize() {\n    try {\n      // Create audio context\n      this.audioContext = new (window.AudioContext ||\n        window.webkitAudioContext)()\n\n      // Create audio listener for 3D spatial audio\n      this.listener = this.audioContext.listener\n\n      // Create master gain node for volume control\n      this.masterGain = this.audioContext.createGain()\n      this.masterGain.gain.setValueAtTime(\n        this.masterVolume,\n        this.audioContext.currentTime\n      )\n      this.masterGain.connect(this.audioContext.destination)\n\n      // Create underwater effect chain\n      this.createUnderwaterEffects()\n\n      // Load basic sound effects (using simple oscillators for now - avoiding file dependencies)\n      this.createSoundEffects()\n\n      this.isInitialized = true\n      console.log('â AudioEngine initialized successfully')\n    } catch (error) {\n      console.warn('â ï¸ AudioEngine initialization failed:', error)\n      // Graceful fallback - game continues without audio\n    }\n  }\n\n  /**\n   * Create underwater audio effects (reverb, low-pass filter)\n   */\n  createUnderwaterEffects() {\n    if (!this.audioContext) {\n      return\n    }\n\n    // Low-pass filter for muffled underwater sound\n    this.underwaterFilter = this.audioContext.createBiquadFilter()\n    this.underwaterFilter.type = 'lowpass'\n    this.underwaterFilter.frequency.setValueAtTime(\n      this.underwaterFilterFrequency,\n      this.audioContext.currentTime\n    )\n    this.underwaterFilter.Q.setValueAtTime(1, this.audioContext.currentTime)\n\n    // Connect filter to master gain\n    this.underwaterFilter.connect(this.masterGain)\n\n    console.log('ð Underwater audio effects created')\n  }\n\n  /**\n   * Create enhanced sound effects using oscillators and filters\n   * This avoids external file dependencies while providing rich audio feedback\n   */\n  createSoundEffects() {\n    if (!this.audioContext) {\n      return\n    }\n\n    // Enhanced sound configurations with more complex patterns\n    this.soundConfigs = {\n      starCollect: {\n        type: 'sine',\n        frequency: 880,\n        duration: 0.4,\n        volume: 0.3,\n        envelope: { attack: 0.01, decay: 0.1, sustain: 0.8, release: 0.3 },\n        harmonics: [\n          { frequency: 1320, volume: 0.5 },\n          { frequency: 1760, volume: 0.3 },\n        ],\n      },\n      gateActivate: {\n        type: 'triangle',\n        frequency: 220,\n        duration: 1.5,\n        volume: 0.4,\n        envelope: { attack: 0.2, decay: 0.3, sustain: 0.7, release: 0.5 },\n        modulation: { frequency: 4, depth: 20 },\n      },\n      levelComplete: {\n        type: 'square',\n        frequency: 440,\n        duration: 2.5,\n        volume: 0.5,\n        envelope: { attack: 0.1, decay: 0.2, sustain: 0.8, release: 0.4 },\n        melody: [440, 554.37, 659.25, 880], // A4, C#5, E5, A5\n      },\n      swimming: {\n        type: 'sine',\n        frequency: 200,\n        duration: 0.2,\n        volume: 0.15,\n        envelope: { attack: 0.05, decay: 0.1, sustain: 0.5, release: 0.05 },\n      },\n      underwater: {\n        type: 'sine',\n        frequency: 80,\n        duration: -1, // Continuous\n        volume: 0.12,\n        envelope: { attack: 2.0, decay: 0, sustain: 1.0, release: 2.0 },\n        modulation: { frequency: 0.3, depth: 5 },\n      },\n    }\n\n    console.log('ðµ Enhanced sound effects configured')\n  }\n\n  /**\n   * Play an enhanced sound effect with envelopes and harmonics\n   */\n  playSound(soundName, position = null) {\n    if (!this.isInitialized || this.isMuted || !this.audioContext) {\n      return\n    }\n\n    const config = this.soundConfigs[soundName]\n    if (!config) {\n      console.warn(`Sound \"${soundName}\" not found`)\n      return\n    }\n\n    try {\n      const currentTime = this.audioContext.currentTime\n\n      // Handle melody-based sounds (like levelComplete)\n      if (config.melody) {\n        this.playMelody(config, position)\n        return\n      }\n\n      // Create main oscillator\n      const oscillator = this.audioContext.createOscillator()\n      const gainNode = this.audioContext.createGain()\n\n      // Configure oscillator\n      oscillator.type = config.type\n      oscillator.frequency.setValueAtTime(config.frequency, currentTime)\n\n      // Add frequency modulation if specified\n      if (config.modulation) {\n        const lfo = this.audioContext.createOscillator()\n        const lfoGain = this.audioContext.createGain()\n        lfo.frequency.setValueAtTime(config.modulation.frequency, currentTime)\n        lfoGain.gain.setValueAtTime(config.modulation.depth, currentTime)\n        lfo.connect(lfoGain)\n        lfoGain.connect(oscillator.frequency)\n        lfo.start(currentTime)\n        if (config.duration > 0) {\n          lfo.stop(currentTime + config.duration)\n        }\n      }\n\n      // Configure ADSR envelope\n      const envelope = config.envelope || {\n        attack: 0.01,\n        decay: 0.1,\n        sustain: 0.8,\n        release: 0.2,\n      }\n      const attackTime = currentTime + envelope.attack\n      const decayTime = attackTime + envelope.decay\n      const sustainLevel = config.volume * envelope.sustain\n      const releaseTime =\n        config.duration > 0 ? currentTime + config.duration : currentTime + 1\n\n      gainNode.gain.setValueAtTime(0, currentTime)\n      gainNode.gain.linearRampToValueAtTime(config.volume, attackTime)\n      gainNode.gain.linearRampToValueAtTime(sustainLevel, decayTime)\n      gainNode.gain.setValueAtTime(sustainLevel, releaseTime - envelope.release)\n      gainNode.gain.linearRampToValueAtTime(0, releaseTime)\n\n      // Connect audio chain\n      oscillator.connect(gainNode)\n\n      // Add harmonics for richer sound\n      const harmonicOscillators = []\n      if (config.harmonics) {\n        config.harmonics.forEach(harmonic => {\n          const harmonicOsc = this.audioContext.createOscillator()\n          const harmonicGain = this.audioContext.createGain()\n\n          harmonicOsc.type = config.type\n          harmonicOsc.frequency.setValueAtTime(harmonic.frequency, currentTime)\n          harmonicGain.gain.setValueAtTime(\n            harmonic.volume * config.volume,\n            currentTime\n          )\n          harmonicGain.gain.linearRampToValueAtTime(0, releaseTime)\n\n          harmonicOsc.connect(harmonicGain)\n          harmonicGain.connect(gainNode)\n          harmonicOsc.start(currentTime)\n\n          if (config.duration > 0) {\n            harmonicOsc.stop(releaseTime)\n          }\n          harmonicOscillators.push(harmonicOsc)\n        })\n      }\n\n      // Add 3D positioning if position provided\n      if (position) {\n        const panner = this.audioContext.createPanner()\n        panner.panningModel = 'HRTF'\n        panner.setPosition(position.x, position.y, position.z)\n        gainNode.connect(panner)\n        panner.connect(this.underwaterFilter)\n      } else {\n        gainNode.connect(this.underwaterFilter)\n      }\n\n      // Start and stop the sound\n      oscillator.start(currentTime)\n      if (config.duration > 0) {\n        oscillator.stop(releaseTime)\n      }\n\n      console.log(`ð Playing enhanced sound: ${soundName}`)\n    } catch (error) {\n      console.warn(`Failed to play sound \"${soundName}\":`, error)\n    }\n  }\n\n  /**\n   * Play a melody sequence\n   */\n  playMelody(config, position = null) {\n    const noteDuration = config.duration / config.melody.length\n\n    config.melody.forEach((frequency, index) => {\n      const startTime = this.audioContext.currentTime + index * noteDuration\n\n      const oscillator = this.audioContext.createOscillator()\n      const gainNode = this.audioContext.createGain()\n\n      oscillator.type = config.type\n      oscillator.frequency.setValueAtTime(frequency, startTime)\n\n      gainNode.gain.setValueAtTime(0, startTime)\n      gainNode.gain.linearRampToValueAtTime(config.volume, startTime + 0.05)\n      gainNode.gain.linearRampToValueAtTime(0, startTime + noteDuration - 0.05)\n\n      oscillator.connect(gainNode)\n\n      if (position) {\n        const panner = this.audioContext.createPanner()\n        panner.panningModel = 'HRTF'\n        panner.setPosition(position.x, position.y, position.z)\n        gainNode.connect(panner)\n        panner.connect(this.underwaterFilter)\n      } else {\n        gainNode.connect(this.underwaterFilter)\n      }\n\n      oscillator.start(startTime)\n      oscillator.stop(startTime + noteDuration)\n    })\n  }\n\n  /**\n   * Start enhanced ambient underwater sound with background music\n   */\n  startAmbientSound() {\n    if (!this.isInitialized || this.isMuted) {\n      return\n    }\n\n    // Only start if not already playing\n    if (this.ambientOscillator) {\n      return\n    }\n\n    try {\n      // Create main ambient sound (underwater rumble)\n      this.ambientOscillator = this.audioContext.createOscillator()\n      this.ambientGain = this.audioContext.createGain()\n\n      this.ambientOscillator.type = 'sine'\n      this.ambientOscillator.frequency.setValueAtTime(\n        60,\n        this.audioContext.currentTime\n      )\n\n      // Gentle fade in\n      this.ambientGain.gain.setValueAtTime(0, this.audioContext.currentTime)\n      this.ambientGain.gain.linearRampToValueAtTime(\n        0.08,\n        this.audioContext.currentTime + 3.0\n      )\n\n      this.ambientOscillator.connect(this.ambientGain)\n      this.ambientGain.connect(this.underwaterFilter)\n\n      this.ambientOscillator.start()\n\n      // Create background music layers\n      this.createBackgroundMusic()\n\n      console.log('ð Ambient underwater sound and music started')\n    } catch (error) {\n      console.warn('Failed to start ambient sound:', error)\n    }\n  }\n\n  /**\n   * Create layered background music using harmonic oscillators\n   */\n  createBackgroundMusic() {\n    this.musicLayers = []\n\n    // Musical notes in the key of A minor (underwater/mysterious feel)\n    const musicNotes = [\n      { frequency: 110, volume: 0.03, type: 'sine' }, // A2\n      { frequency: 146.83, volume: 0.025, type: 'sine' }, // D3\n      { frequency: 164.81, volume: 0.02, type: 'triangle' }, // E3\n      { frequency: 220, volume: 0.015, type: 'sine' }, // A3\n    ]\n\n    musicNotes.forEach((note, index) => {\n      const oscillator = this.audioContext.createOscillator()\n      const gainNode = this.audioContext.createGain()\n      const lfo = this.audioContext.createOscillator() // Low frequency oscillator for modulation\n      const lfoGain = this.audioContext.createGain()\n\n      // Setup main oscillator\n      oscillator.type = note.type\n      oscillator.frequency.setValueAtTime(\n        note.frequency,\n        this.audioContext.currentTime\n      )\n\n      // Setup LFO for subtle frequency modulation\n      lfo.type = 'sine'\n      lfo.frequency.setValueAtTime(\n        0.1 + index * 0.05,\n        this.audioContext.currentTime\n      ) // Different rates for each layer\n      lfoGain.gain.setValueAtTime(2, this.audioContext.currentTime) // Small modulation depth\n\n      // Connect modulation\n      lfo.connect(lfoGain)\n      lfoGain.connect(oscillator.frequency)\n\n      // Setup volume envelope with slow fade in\n      gainNode.gain.setValueAtTime(0, this.audioContext.currentTime)\n      gainNode.gain.linearRampToValueAtTime(\n        note.volume,\n        this.audioContext.currentTime + 5.0 + index // Staggered entry\n      )\n\n      // Connect audio chain\n      oscillator.connect(gainNode)\n      gainNode.connect(this.underwaterFilter)\n\n      // Start oscillators\n      oscillator.start()\n      lfo.start()\n\n      this.musicLayers.push({ oscillator, gainNode, lfo, lfoGain })\n    })\n  }\n\n  /**\n   * Stop ambient underwater sound and background music\n   */\n  stopAmbientSound() {\n    if (this.ambientOscillator) {\n      try {\n        this.ambientGain.gain.linearRampToValueAtTime(\n          0,\n          this.audioContext.currentTime + 1\n        )\n        this.ambientOscillator.stop(this.audioContext.currentTime + 1)\n        this.ambientOscillator = null\n        this.ambientGain = null\n      } catch (error) {\n        console.warn('Error stopping ambient sound:', error)\n      }\n    }\n\n    // Stop background music layers\n    if (this.musicLayers) {\n      this.musicLayers.forEach(layer => {\n        try {\n          layer.gainNode.gain.linearRampToValueAtTime(\n            0,\n            this.audioContext.currentTime + 1\n          )\n          layer.oscillator.stop(this.audioContext.currentTime + 1)\n          layer.lfo.stop(this.audioContext.currentTime + 1)\n        } catch (error) {\n          console.warn('Error stopping music layer:', error)\n        }\n      })\n      this.musicLayers = null\n    }\n\n    console.log('ð Ambient sound and music stopped')\n  }\n\n  /**\n   * Update listener position for 3D audio (should be called each frame)\n   */\n  updateListenerPosition(position, forward, up) {\n    if (!this.listener || !this.isInitialized) {\n      return\n    }\n\n    try {\n      if (this.listener.positionX) {\n        // New Web Audio API approach\n        this.listener.positionX.setValueAtTime(\n          position.x,\n          this.audioContext.currentTime\n        )\n        this.listener.positionY.setValueAtTime(\n          position.y,\n          this.audioContext.currentTime\n        )\n        this.listener.positionZ.setValueAtTime(\n          position.z,\n          this.audioContext.currentTime\n        )\n\n        this.listener.forwardX.setValueAtTime(\n          forward.x,\n          this.audioContext.currentTime\n        )\n        this.listener.forwardY.setValueAtTime(\n          forward.y,\n          this.audioContext.currentTime\n        )\n        this.listener.forwardZ.setValueAtTime(\n          forward.z,\n          this.audioContext.currentTime\n        )\n\n        this.listener.upX.setValueAtTime(up.x, this.audioContext.currentTime)\n        this.listener.upY.setValueAtTime(up.y, this.audioContext.currentTime)\n        this.listener.upZ.setValueAtTime(up.z, this.audioContext.currentTime)\n      } else {\n        // Fallback for older browsers\n        this.listener.setPosition(position.x, position.y, position.z)\n        this.listener.setOrientation(\n          forward.x,\n          forward.y,\n          forward.z,\n          up.x,\n          up.y,\n          up.z\n        )\n      }\n    } catch {\n      // Silently ignore positioning errors\n    }\n  }\n\n  /**\n   * Set master volume\n   */\n  setMasterVolume(volume) {\n    this.masterVolume = Math.max(0, Math.min(1, volume))\n\n    if (this.masterGain && this.audioContext) {\n      this.masterGain.gain.setValueAtTime(\n        this.masterVolume,\n        this.audioContext.currentTime\n      )\n    }\n  }\n\n  /**\n   * Toggle mute state\n   */\n  toggleMute() {\n    this.isMuted = !this.isMuted\n\n    if (this.isMuted) {\n      this.stopAmbientSound()\n    } else if (this.isInitialized) {\n      this.startAmbientSound()\n    }\n\n    console.log(`ð Audio ${this.isMuted ? 'muted' : 'unmuted'}`)\n    return this.isMuted\n  }\n\n  /**\n   * Get current audio state\n   */\n  getState() {\n    return {\n      isInitialized: this.isInitialized,\n      isMuted: this.isMuted,\n      masterVolume: this.masterVolume,\n    }\n  }\n\n  /**\n   * Dispose of audio resources\n   */\n  dispose() {\n    this.stopAmbientSound()\n\n    if (this.audioContext && this.audioContext.state !== 'closed') {\n      this.audioContext.close()\n    }\n\n    this.sounds.clear()\n    this.isInitialized = false\n\n    console.log('ðï¸ AudioEngine disposed')\n  }\n}\n","/**\n * Player Component for Ocean Adventure\n *\n * Enhanced player controller with physics integration,\n * underwater movement mechanics, and collision handling.\n */\n\nimport * as THREE from 'three'\n\nexport class Player {\n  constructor(scene, physicsEngine) {\n    this.scene = scene\n    this.physicsEngine = physicsEngine\n\n    // Player properties\n    this.moveSpeed = 8.0\n    this.rotationSpeed = 3.0\n    this.maxVelocity = 5.0\n\n    // Movement state\n    this.movementVector = new THREE.Vector3()\n    this.isMoving = false\n\n    // Create player mesh and physics body\n    this.createPlayerMesh()\n    this.createPhysicsBody()\n\n    // Bind collision handler\n    this.physicsBody.onCollision = collisions =>\n      this.handleCollisions(collisions)\n  }\n\n  /**\n   * Create the visual representation of the player\n   */\n  createPlayerMesh() {\n    // Create player geometry (capsule for better collision detection)\n    const geometry = new THREE.CapsuleGeometry(0.5, 1.5, 4, 8)\n\n    // Use MeshPhongMaterial for better lighting effects\n    const material = new THREE.MeshPhongMaterial({\n      color: 0x00ff88,\n      transparent: true,\n      opacity: 0.9,\n      shininess: 50,\n      specular: 0x44aa66,\n      emissive: 0x002211,\n      emissiveIntensity: 0.1,\n    })\n\n    this.mesh = new THREE.Mesh(geometry, material)\n    this.mesh.castShadow = true\n    this.mesh.receiveShadow = true\n\n    // Set initial position - start underwater with some depth\n    this.mesh.position.set(0, 2, 0) // Start 3 meters below water surface (5 - 2 = 3m depth)\n\n    // Add to scene\n    this.scene.add(this.mesh)\n  }\n\n  /**\n   * Create physics body for collision detection and movement\n   */\n  createPhysicsBody() {\n    this.physicsBody = this.physicsEngine.createSphereBody(\n      this.mesh.position.clone(), // Use the mesh position which is now set to (0, 2, 0)\n      0.7, // Slightly larger radius for collision detection\n      false // Not static - player can move\n    )\n\n    // Add physics body to engine\n    this.physicsEngine.addRigidBody(this.physicsBody)\n  }\n\n  /**\n   * Handle input and update movement vector\n   * @param {Object} inputState - Current input state\n   */\n  handleInput(inputState) {\n    // Reset movement vector\n    this.movementVector.set(0, 0, 0)\n    this.isMoving = false\n\n    // Keyboard input\n    if (inputState.keys) {\n      if (inputState.keys.forward) {\n        this.movementVector.z -= 1\n        this.isMoving = true\n      }\n      if (inputState.keys.backward) {\n        this.movementVector.z += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.left) {\n        this.movementVector.x -= 1\n        this.isMoving = true\n      }\n      if (inputState.keys.right) {\n        this.movementVector.x += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.up) {\n        this.movementVector.y += 1\n        this.isMoving = true\n      }\n      if (inputState.keys.down) {\n        this.movementVector.y -= 1\n        this.isMoving = true\n      }\n    }\n\n    // Touch/mobile input\n    if (inputState.joystick) {\n      this.movementVector.x += inputState.joystick.x\n      this.movementVector.z += inputState.joystick.y\n      if (\n        Math.abs(inputState.joystick.x) > 0.1 ||\n        Math.abs(inputState.joystick.y) > 0.1\n      ) {\n        this.isMoving = true\n      }\n    }\n\n    // Mobile buttons\n    if (inputState.mobileButtons) {\n      if (inputState.mobileButtons.swimUp) {\n        this.movementVector.y += 1\n        this.isMoving = true\n      }\n      if (inputState.mobileButtons.swimDown) {\n        this.movementVector.y -= 1\n        this.isMoving = true\n      }\n    }\n\n    // Normalize movement vector to prevent faster diagonal movement\n    if (this.movementVector.length() > 1) {\n      this.movementVector.normalize()\n    }\n\n    // Apply movement to physics body\n    this.applyMovement()\n  }\n\n  /**\n   * Apply movement forces to the physics body\n   */\n  applyMovement() {\n    if (!this.isMoving) {\n      // Apply stronger drag when not actively moving\n      this.physicsBody.velocity.multiplyScalar(0.9)\n      return\n    }\n\n    // Calculate movement force\n    const force = this.movementVector\n      .clone()\n      .multiplyScalar(this.moveSpeed * 0.016) // Assume ~60fps for consistent feel\n\n    // Add force to velocity\n    this.physicsBody.velocity.add(force)\n\n    // Clamp velocity to max speed\n    if (this.physicsBody.velocity.length() > this.maxVelocity) {\n      this.physicsBody.velocity.normalize().multiplyScalar(this.maxVelocity)\n    }\n\n    // Rotate player to face movement direction (optional visual enhancement)\n    if (this.movementVector.length() > 0.1) {\n      const targetRotation = Math.atan2(\n        this.movementVector.x,\n        this.movementVector.z\n      )\n      this.mesh.rotation.y = THREE.MathUtils.lerp(\n        this.mesh.rotation.y,\n        targetRotation,\n        this.rotationSpeed * 0.016\n      )\n    }\n  }\n\n  /**\n   * Update player state\n   */\n  update() {\n    // Sync mesh position with physics body (don't override physics with floating animation)\n    this.mesh.position.copy(this.physicsBody.position)\n\n    // Add gentle floating animation to visual representation only\n    const time = Date.now() * 0.001\n    const floatingOffset = Math.sin(time * 2) * 0.02\n    this.mesh.position.y += floatingOffset\n\n    // Don't update physics body position from mesh - let physics handle position\n    // The physics body position should be authoritative\n  }\n\n  /**\n   * Handle collisions with other objects\n   * @param {Array} collisions - Array of objects the player collided with\n   */\n  handleCollisions(collisions) {\n    for (const collision of collisions) {\n      // Handle different types of collisions\n      if (collision.type === 'collectible') {\n        this.handleCollectibleCollision(collision)\n      } else if (collision.type === 'obstacle') {\n        this.handleObstacleCollision(collision)\n      } else if (collision.type === 'environment') {\n        this.handleEnvironmentCollision(collision)\n      }\n    }\n  }\n\n  /**\n   * Handle collision with collectible items\n   * @param {Object} collectible - Collectible object\n   */\n  handleCollectibleCollision(collectible) {\n    // Collectibles will be handled by the game manager\n    // This is just for reference and future expansion\n    console.log('Player collected item:', collectible)\n  }\n\n  /**\n   * Handle collision with obstacles\n   * @param {Object} obstacle - Obstacle object\n   */\n  handleObstacleCollision(obstacle) {\n    // Bounce back slightly from obstacles\n    const direction = this.physicsBody.position\n      .clone()\n      .sub(obstacle.position)\n      .normalize()\n\n    this.physicsBody.velocity.add(direction.multiplyScalar(2))\n  }\n\n  /**\n   * Handle collision with environment objects\n   * @param {Object} _envObject - Environment object (unused for now)\n   */\n  handleEnvironmentCollision() {\n    // Environment collisions are handled by physics engine\n    // This can be used for special effects or sounds\n  }\n\n  /**\n   * Get current player position\n   * @returns {THREE.Vector3} Current position\n   */\n  getPosition() {\n    // Return physics body position (authoritative) instead of mesh position (includes floating animation)\n    return this.physicsBody.position.clone()\n  }\n\n  /**\n   * Set player position\n   * @param {THREE.Vector3} position - New position\n   */\n  setPosition(position) {\n    this.mesh.position.copy(position)\n    this.physicsBody.position.copy(position)\n  }\n\n  /**\n   * Get current velocity\n   * @returns {THREE.Vector3} Current velocity\n   */\n  getVelocity() {\n    return this.physicsBody.velocity.clone()\n  }\n\n  /**\n   * Check if player is moving\n   * @returns {boolean} Whether player is currently moving\n   */\n  getIsMoving() {\n    return this.isMoving || this.physicsBody.velocity.length() > 0.1\n  }\n\n  /**\n   * Dispose of player resources\n   */\n  dispose() {\n    // Remove from physics engine\n    this.physicsEngine.removeRigidBody(this.physicsBody)\n\n    // Remove mesh from scene\n    this.scene.remove(this.mesh)\n\n    // Dispose geometry and material\n    this.mesh.geometry.dispose()\n    this.mesh.material.dispose()\n  }\n}\n","/**\n * Gate Component for Ocean Adventure\n *\n * Represents the glowing portal gates that players must swim through\n * to complete levels after collecting all stars.\n */\n\nimport * as THREE from 'three'\n\nexport class Gate {\n  constructor(scene, physicsEngine, position = new THREE.Vector3(0, 0, -15)) {\n    this.scene = scene\n    this.physicsEngine = physicsEngine\n    this.position = position.clone()\n\n    // Gate properties\n    this.width = 4\n    this.height = 6\n    this.depth = 0.5\n    this.isActivated = false\n    this.isCollected = false\n\n    // Animation properties\n    this.pulseSpeed = 0.02\n    this.rotationSpeed = 0.01\n    this.time = 0\n\n    // Create gate mesh and physics body\n    this.createGateMesh()\n    this.createPhysicsBody()\n\n    console.log('ðª Gate created at position:', position)\n  }\n\n  /**\n   * Create the visual representation of the gate\n   */\n  createGateMesh() {\n    // Create gate frame (torus shape for portal effect)\n    const gateGeometry = new THREE.TorusGeometry(this.width, 0.3, 8, 32)\n\n    // Enhanced glowing material with stronger emissive properties\n    const gateMaterial = new THREE.MeshPhongMaterial({\n      color: 0x00ffff,\n      emissive: 0x006666,\n      emissiveIntensity: 0.5,\n      transparent: true,\n      opacity: 0.9,\n      shininess: 100,\n    })\n\n    this.gateMesh = new THREE.Mesh(gateGeometry, gateMaterial)\n    this.gateMesh.position.copy(this.position)\n    this.gateMesh.castShadow = true\n    this.gateMesh.receiveShadow = true\n\n    // Create inner portal effect with enhanced materials\n    const portalGeometry = new THREE.PlaneGeometry(\n      this.width * 1.5,\n      this.height\n    )\n    const portalMaterial = new THREE.MeshBasicMaterial({\n      color: 0x0088ff,\n      transparent: true,\n      opacity: 0.3,\n      side: THREE.DoubleSide,\n    })\n\n    this.portalMesh = new THREE.Mesh(portalGeometry, portalMaterial)\n    this.portalMesh.position.copy(this.position)\n\n    // Create multiple enhanced light sources for better illumination\n    this.gateLight = new THREE.PointLight(0x00ffff, 1.0, 25)\n    this.gateLight.position.copy(this.position)\n    this.gateLight.position.z += 1\n\n    // Add secondary lights for rim lighting effect\n    this.rimLights = []\n    const numRimLights = 6\n    for (let i = 0; i < numRimLights; i++) {\n      const angle = (i / numRimLights) * Math.PI * 2\n      const rimLight = new THREE.PointLight(0x0088ff, 0.3, 10)\n      const lightRadius = this.width * 1.2\n      rimLight.position.set(\n        this.position.x + Math.cos(angle) * lightRadius,\n        this.position.y + Math.sin(angle) * lightRadius * 0.7,\n        this.position.z + (Math.random() - 0.5) * 2\n      )\n      rimLight.userData = {\n        originalAngle: angle,\n        animationOffset: Math.random() * Math.PI * 2,\n      }\n      this.rimLights.push(rimLight)\n    }\n\n    // Add to scene (initially invisible until activated)\n    this.setVisibility(false)\n  }\n\n  /**\n   * Create physics body for collision detection\n   * Using a ring shape instead of a solid box to allow swimming through\n   */\n  createPhysicsBody() {\n    // Create multiple collision bodies around the ring\n    // This allows detection when player touches the gate frame but can swim through the center\n    this.physicsBody = []\n\n    const ringRadius = this.width\n    const segments = 8\n\n    for (let i = 0; i < segments; i++) {\n      const angle = (i / segments) * Math.PI * 2\n      const x = Math.cos(angle) * ringRadius\n      const y = Math.sin(angle) * ringRadius * 0.7 // Make it more oval for height\n\n      const segmentPosition = this.position.clone()\n      segmentPosition.x += x\n      segmentPosition.y += y\n\n      const segmentBody = this.physicsEngine.createSphereBody(\n        segmentPosition,\n        0.8, // Collision radius for each segment\n        true // Static - gates don't move\n      )\n      segmentBody.type = 'gate'\n      segmentBody.gate = this\n      this.physicsEngine.addRigidBody(segmentBody)\n      this.physicsBody.push(segmentBody)\n    }\n  }\n\n  /**\n   * Activate the gate (make it visible and interactive)\n   */\n  activate() {\n    if (this.isActivated) {\n      return\n    }\n\n    this.isActivated = true\n    this.setVisibility(true)\n\n    // Enhanced activation effects\n    this.gateMesh.material.emissiveIntensity = 0.8\n    this.gateLight.intensity = 1.5\n\n    // Activate rim lights\n    this.rimLights.forEach(light => {\n      light.intensity = 0.4\n    })\n\n    console.log('â¨ Gate activated!')\n  }\n\n  /**\n   * Deactivate the gate\n   */\n  deactivate() {\n    this.isActivated = false\n    this.setVisibility(false)\n    this.gateMesh.material.emissiveIntensity = 0.5\n    this.gateLight.intensity = 1.0\n\n    // Deactivate rim lights\n    this.rimLights.forEach(light => {\n      light.intensity = 0.1\n    })\n  }\n\n  /**\n   * Set gate visibility\n   */\n  setVisibility(visible) {\n    if (visible) {\n      this.scene.add(this.gateMesh)\n      this.scene.add(this.portalMesh)\n      this.scene.add(this.gateLight)\n      // Add rim lights\n      this.rimLights.forEach(light => this.scene.add(light))\n    } else {\n      this.scene.remove(this.gateMesh)\n      this.scene.remove(this.portalMesh)\n      this.scene.remove(this.gateLight)\n      // Remove rim lights\n      this.rimLights.forEach(light => this.scene.remove(light))\n    }\n  }\n\n  /**\n   * Handle player collision with gate\n   */\n  onPlayerEnter() {\n    if (!this.isActivated || this.isCollected) {\n      return false\n    }\n\n    this.isCollected = true\n    console.log('ð¯ Player entered gate - Level Complete!')\n\n    // Gate completion effects\n    this.gateMesh.material.emissiveIntensity = 1.0\n    this.gateLight.intensity = 2.0\n\n    return true\n  }\n\n  /**\n   * Update gate animations and effects\n   */\n  update(deltaTime) {\n    if (!this.isActivated) {\n      return\n    }\n\n    this.time += deltaTime\n\n    // Enhanced pulsing glow effect\n    const pulseIntensity =\n      0.4 + Math.sin(this.time * this.pulseSpeed * 10) * 0.3\n    this.gateMesh.material.emissiveIntensity = pulseIntensity\n    this.gateLight.intensity = 0.8 + pulseIntensity\n\n    // Gentle rotation\n    this.gateMesh.rotation.z += this.rotationSpeed\n\n    // Enhanced portal shimmer effect\n    this.portalMesh.material.opacity =\n      0.2 + Math.sin(this.time * this.pulseSpeed * 15) * 0.2\n\n    // Animate rim lights for dynamic lighting\n    this.rimLights.forEach((light, index) => {\n      const userData = light.userData\n      const animationTime = this.time * 0.5 + userData.animationOffset\n\n      // Create pulsing effect with phase offset for each light\n      const pulseFactor = 0.2 + Math.sin(animationTime + index * 0.5) * 0.2\n      light.intensity = pulseFactor\n\n      // Slight movement for dynamic effect\n      const lightRadius = this.width * 1.2\n      const wobble = Math.sin(animationTime * 2) * 0.1\n      light.position.set(\n        this.position.x +\n          Math.cos(userData.originalAngle) * (lightRadius + wobble),\n        this.position.y +\n          Math.sin(userData.originalAngle) * (lightRadius + wobble) * 0.7,\n        this.position.z + Math.sin(animationTime * 3) * 0.5\n      )\n    })\n  }\n\n  /**\n   * Get gate position\n   */\n  getPosition() {\n    return this.position.clone()\n  }\n\n  /**\n   * Check if gate is activated\n   */\n  getIsActivated() {\n    return this.isActivated\n  }\n\n  /**\n   * Check if gate has been collected (level completed)\n   */\n  getIsCollected() {\n    return this.isCollected\n  }\n\n  /**\n   * Reset gate for new level\n   */\n  reset() {\n    this.isCollected = false\n    this.deactivate()\n    this.time = 0\n  }\n\n  /**\n   * Dispose of gate resources\n   */\n  dispose() {\n    // Remove from physics engine - handle array of physics bodies\n    if (Array.isArray(this.physicsBody)) {\n      this.physicsBody.forEach(body => {\n        this.physicsEngine.removeRigidBody(body)\n      })\n    } else if (this.physicsBody) {\n      this.physicsEngine.removeRigidBody(this.physicsBody)\n    }\n\n    // Remove from scene\n    this.setVisibility(false)\n\n    // Dispose geometry and materials\n    if (this.gateMesh) {\n      this.gateMesh.geometry.dispose()\n      this.gateMesh.material.dispose()\n    }\n\n    if (this.portalMesh) {\n      this.portalMesh.geometry.dispose()\n      this.portalMesh.material.dispose()\n    }\n\n    console.log('ðï¸ Gate disposed')\n  }\n}\n","/**\n * Star Geometry for Ocean Adventure\n *\n * Creates actual star-shaped geometry instead of simple spheres\n * for more realistic collectible stars.\n */\n\nimport * as THREE from 'three'\n\nexport class StarGeometry {\n  /**\n   * Create a 3D star shape with specified parameters\n   * @param {number} innerRadius - Inner radius of the star points\n   * @param {number} outerRadius - Outer radius of the star points\n   * @param {number} points - Number of star points (default: 5)\n   * @param {number} depth - Depth/thickness of the star (default: 0.1)\n   */\n  static create(innerRadius = 0.2, outerRadius = 0.4, points = 5, depth = 0.1) {\n    // Create star shape using Three.js Shape\n    const starShape = new THREE.Shape()\n\n    // Calculate star points\n    const angleStep = (Math.PI * 2) / points\n    const halfAngleStep = angleStep / 2\n\n    // Start at the top point\n    let angle = -Math.PI / 2 // Start at top\n    starShape.moveTo(\n      Math.cos(angle) * outerRadius,\n      Math.sin(angle) * outerRadius\n    )\n\n    // Create star points by alternating between outer and inner radius\n    for (let i = 0; i < points; i++) {\n      // Inner point\n      angle += halfAngleStep\n      starShape.lineTo(\n        Math.cos(angle) * innerRadius,\n        Math.sin(angle) * innerRadius\n      )\n\n      // Outer point\n      angle += halfAngleStep\n      starShape.lineTo(\n        Math.cos(angle) * outerRadius,\n        Math.sin(angle) * outerRadius\n      )\n    }\n\n    // Extrude the shape to create 3D star\n    const extrudeSettings = {\n      depth: depth,\n      bevelEnabled: true,\n      bevelSegments: 2,\n      steps: 2,\n      bevelSize: 0.02,\n      bevelThickness: 0.02,\n    }\n\n    const starGeometry = new THREE.ExtrudeGeometry(starShape, extrudeSettings)\n\n    // Center the geometry\n    starGeometry.center()\n\n    return starGeometry\n  }\n\n  /**\n   * Create a simple star material with glowing effects\n   * @param {number} color - Base color (default: gold)\n   * @param {number} emissiveIntensity - Glow intensity (default: 0.4)\n   */\n  static createMaterial(color = 0xffd700, emissiveIntensity = 0.4) {\n    return new THREE.MeshPhongMaterial({\n      color: color,\n      emissive: color,\n      emissiveIntensity: emissiveIntensity,\n      shininess: 100,\n      specular: 0xffffff,\n      transparent: true,\n      opacity: 0.95,\n    })\n  }\n\n  /**\n   * Create multiple star variants with different sizes and colors\n   */\n  static createVariants() {\n    const variants = []\n\n    // Different star sizes and colors\n    const configs = [\n      { inner: 0.15, outer: 0.35, color: 0xffd700 }, // Classic gold\n      { inner: 0.18, outer: 0.38, color: 0xffff80 }, // Light yellow\n      { inner: 0.12, outer: 0.32, color: 0xffa500 }, // Orange\n      { inner: 0.2, outer: 0.4, color: 0xfffacd }, // Light gold\n      { inner: 0.16, outer: 0.36, color: 0xffb347 }, // Sandy brown\n    ]\n\n    configs.forEach(config => {\n      const geometry = StarGeometry.create(config.inner, config.outer)\n      const material = StarGeometry.createMaterial(config.color)\n      variants.push({ geometry, material, config })\n    })\n\n    return variants\n  }\n}\n","/**\n * Ocean Adventure - Main Game Entry Point\n *\n * This is a placeholder implementation showing the basic structure\n * for the 3D underwater platform game. The actual game engine\n * implementation will be developed following the Copilot plan.\n */\n\nimport * as THREE from 'three'\nimport { PhysicsEngine } from './core/Physics.js'\nimport { ParticleSystem } from './core/ParticleSystem.js'\nimport { AudioEngine } from './core/AudioEngine.js'\nimport { Player } from './components/Player.js'\nimport { Gate } from './components/Gate.js'\nimport { StarGeometry } from './components/StarGeometry.js'\n\n// Game configuration\nconst CONFIG = {\n  targetFPS: 60,\n  mobileFPS: 30,\n  canvasId: 'gameCanvas',\n  loadingId: 'loading',\n  uiId: 'ui',\n}\n\nclass OceanAdventure {\n  constructor() {\n    this.scene = null\n    this.camera = null\n    this.renderer = null\n    this.canvas = null\n    this.isLoaded = false\n    this.isMobile = this.detectMobile()\n\n    // Core systems\n    this.physicsEngine = null\n    this.particleSystem = null\n    this.audioEngine = null\n    this.player = null\n    this.gate = null\n    this.environmentObjects = []\n\n    // Game state\n    this.starCount = 0\n    this.levelNumber = 1\n\n    // Input state\n    this.inputState = {\n      keys: {\n        forward: false,\n        backward: false,\n        left: false,\n        right: false,\n        up: false,\n        down: false,\n      },\n      joystick: { x: 0, y: 0 },\n      mobileButtons: { swimUp: false, swimDown: false },\n    }\n\n    // Timing\n    this.lastTime = 0\n\n    console.log('ð Ocean Adventure - Initializing...')\n  }\n\n  async initialize() {\n    const steps = [\n      { name: 'Canvas Setup', fn: () => this.setupCanvas() },\n      { name: 'WebGL Renderer', fn: () => this.setupRenderer() },\n      { name: '3D Scene', fn: () => this.setupScene() },\n      { name: 'Camera', fn: () => this.setupCamera() },\n      { name: 'Lighting', fn: () => this.setupLights() },\n      { name: 'Physics Engine', fn: () => this.initializePhysics() },\n      { name: 'Particle System', fn: () => this.initializeParticleSystem() },\n      { name: 'Audio Engine', fn: () => this.initializeAudio() },\n      { name: 'Environment', fn: () => this.createUnderwaterEnvironment() },\n      { name: 'Player', fn: () => this.createPlayer() },\n      { name: 'Sample Stars', fn: () => this.createSampleStars() },\n      { name: 'Gate', fn: () => this.createGate() },\n      { name: 'Event Listeners', fn: () => this.setupEventListeners() },\n      {\n        name: 'UI Initialization',\n        fn: () => {\n          this.hideLoading()\n          this.showUI()\n        },\n      },\n      { name: 'Game Loop', fn: () => this.startGameLoop() },\n    ]\n\n    try {\n      console.log('ð® Ocean Adventure - Starting initialization...')\n\n      for (let i = 0; i < steps.length; i++) {\n        const step = steps[i]\n        console.log(`[${i + 1}/${steps.length}] Initializing ${step.name}...`)\n\n        try {\n          await step.fn()\n          console.log(`â ${step.name} initialized successfully`)\n        } catch (stepError) {\n          console.error(`â Failed to initialize ${step.name}:`, stepError)\n          throw new Error(\n            `Initialization failed at step \"${step.name}\": ${stepError.message}`\n          )\n        }\n      }\n\n      this.isLoaded = true\n      console.log('ð Ocean Adventure - Ready to play!')\n    } catch (error) {\n      console.error('â Failed to initialize game:', error)\n      this.showError('Failed to initialize game: ' + error.message)\n    }\n  }\n\n  setupCanvas() {\n    console.log('ð® Setting up canvas...')\n    this.canvas = document.getElementById(CONFIG.canvasId)\n    if (!this.canvas) {\n      throw new Error('Game canvas not found')\n    }\n    console.log('â Canvas found and configured')\n  }\n\n  setupRenderer() {\n    console.log('ð¨ Setting up WebGL renderer...')\n    try {\n      this.renderer = new THREE.WebGLRenderer({\n        canvas: this.canvas,\n        antialias: !this.isMobile, // Disable antialiasing on mobile for performance\n        alpha: false,\n        powerPreference: this.isMobile ? 'low-power' : 'high-performance',\n        failIfMajorPerformanceCaveat: false, // Allow fallback rendering\n        preserveDrawingBuffer: false, // Better performance\n        premultipliedAlpha: false,\n        stencil: false, // Reduce memory usage\n      })\n\n      this.renderer.setSize(window.innerWidth, window.innerHeight)\n      this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\n      this.renderer.setClearColor(0x001122, 1) // Deep ocean blue\n\n      // Enable shadows with mobile-optimized settings\n      this.renderer.shadowMap.enabled = true\n      this.renderer.shadowMap.type = this.isMobile\n        ? THREE.BasicShadowMap // Faster shadow type for mobile\n        : THREE.PCFSoftShadowMap // Better quality for desktop\n\n      // Enhanced WebGL settings for modern lighting\n      this.renderer.outputColorSpace = THREE.SRGBColorSpace\n      this.renderer.toneMapping = THREE.ACESFilmicToneMapping\n      this.renderer.toneMappingExposure = 1.0\n\n      // Validate WebGL context\n      const gl = this.renderer.getContext()\n      if (!gl) {\n        throw new Error('Failed to get WebGL context')\n      }\n\n      // Add error handling for WebGL\n      gl.getExtension('WEBGL_lose_context')\n\n      console.log('â WebGL renderer configured successfully')\n    } catch (error) {\n      console.error('â Failed to setup WebGL renderer:', error)\n      throw new Error(`WebGL initialization failed: ${error.message}`)\n    }\n  }\n\n  setupScene() {\n    console.log('ð Setting up 3D scene...')\n    this.scene = new THREE.Scene()\n    console.log('â 3D scene created successfully')\n  }\n\n  /**\n   * Initialize physics engine\n   */\n  initializePhysics() {\n    this.physicsEngine = new PhysicsEngine()\n    console.log('â¡ Physics engine initialized')\n  }\n\n  /**\n   * Initialize particle system\n   */\n  initializeParticleSystem() {\n    this.particleSystem = new ParticleSystem(this.scene, 500) // Reduced for mobile performance\n    console.log('â¨ Particle system initialized')\n  }\n\n  /**\n   * Initialize audio engine\n   */\n  initializeAudio() {\n    this.audioEngine = new AudioEngine()\n    // Note: Audio will be initialized on first user interaction due to browser policies\n    console.log('ð Audio engine created (will initialize on user interaction)')\n  }\n\n  /**\n   * Try to initialize audio on first user interaction\n   */\n  async tryInitializeAudio() {\n    if (this.audioEngine && !this.audioEngine.isInitialized) {\n      try {\n        await this.audioEngine.initialize()\n        this.audioEngine.startAmbientSound()\n        console.log('ð Audio initialized and ambient sound started')\n      } catch (error) {\n        console.warn('Audio initialization failed:', error)\n      }\n    }\n  }\n\n  setupCamera() {\n    this.camera = new THREE.PerspectiveCamera(\n      75, // Field of view\n      window.innerWidth / window.innerHeight, // Aspect ratio\n      0.1, // Near clipping plane\n      1000 // Far clipping plane\n    )\n\n    // Position camera behind and above the player\n    this.camera.position.set(0, 5, 10)\n    this.camera.lookAt(0, 0, 0)\n  }\n\n  setupLights() {\n    // Enhanced underwater ambient lighting (adjusted for modern lighting model)\n    const ambientLight = new THREE.AmbientLight(0x336699, 0.3) // Reduced from 0.6\n    this.scene.add(ambientLight)\n\n    // Primary directional light simulating filtered sunlight from above (adjusted intensity)\n    const directionalLight = new THREE.DirectionalLight(0x87ceeb, 2.5) // Increased from 1.2\n    directionalLight.position.set(0, 50, 10)\n\n    // Enable shadows with optimized settings for mobile compatibility\n    if (this.renderer.shadowMap.enabled) {\n      directionalLight.castShadow = true\n      // Use smaller shadow map sizes on mobile for better performance\n      const shadowMapSize = this.isMobile ? 512 : 1024\n      directionalLight.shadow.mapSize.width = shadowMapSize\n      directionalLight.shadow.mapSize.height = shadowMapSize\n      directionalLight.shadow.camera.near = 0.5\n      directionalLight.shadow.camera.far = 500\n      directionalLight.shadow.camera.left = -50\n      directionalLight.shadow.camera.right = 50\n      directionalLight.shadow.camera.top = 50\n      directionalLight.shadow.camera.bottom = -50\n      // Use less expensive shadow map type on mobile\n      if (this.isMobile) {\n        directionalLight.shadow.bias = -0.0005\n      }\n    }\n\n    this.scene.add(directionalLight)\n\n    // Add volumetric underwater lighting with point lights for better WebGL effects\n    this.addUnderwaterVolumetricLights()\n\n    // Add subtle rim lighting to enhance object definition (adjusted intensity)\n    const rimLight = new THREE.DirectionalLight(0x4a9eff, 0.8) // Increased from 0.4\n    rimLight.position.set(-20, 10, -20)\n    this.scene.add(rimLight)\n  }\n\n  addUnderwaterVolumetricLights() {\n    // Create multiple point lights for underwater caustics effect\n    const lightColors = [0x4a9eff, 0x87ceeb, 0x6495ed, 0x00bfff]\n    const lightCount = this.isMobile ? 3 : 5 // Fewer lights on mobile\n\n    for (let i = 0; i < lightCount; i++) {\n      const pointLight = new THREE.PointLight(\n        lightColors[i % lightColors.length],\n        this.isMobile ? 2.0 : 3.0, // Adjusted for modern lighting model\n        30, // Distance\n        2 // Decay\n      )\n\n      // Position lights in a scattered pattern above the scene\n      const angle = (i / lightCount) * Math.PI * 2\n      const radius = 15 + Math.random() * 10\n      pointLight.position.set(\n        Math.cos(angle) * radius,\n        8 + Math.random() * 5, // Varying heights\n        Math.sin(angle) * radius\n      )\n\n      // Store animation properties\n      pointLight.userData = {\n        originalPosition: pointLight.position.clone(),\n        animationOffset: Math.random() * Math.PI * 2,\n        animationSpeed: 0.5 + Math.random() * 0.5,\n        animationRadius: 2 + Math.random() * 3,\n      }\n\n      this.scene.add(pointLight)\n\n      // Store reference for animation\n      if (!this.volumetricLights) {\n        this.volumetricLights = []\n      }\n      this.volumetricLights.push(pointLight)\n    }\n  }\n\n  createUnderwaterEnvironment() {\n    // Create water surface at Y=5 (matches depth meter calculation)\n    const waterSurfaceGeometry = new THREE.PlaneGeometry(200, 200)\n    const waterSurfaceMaterial = new THREE.MeshPhongMaterial({\n      color: 0x006994,\n      transparent: true,\n      opacity: 0.6,\n      shininess: 100,\n      specular: 0x87ceeb,\n      side: THREE.DoubleSide,\n    })\n    const waterSurface = new THREE.Mesh(\n      waterSurfaceGeometry,\n      waterSurfaceMaterial\n    )\n    waterSurface.rotation.x = -Math.PI / 2\n    waterSurface.position.y = 5 // Water surface level used by depth meter\n    waterSurface.receiveShadow = true\n    this.scene.add(waterSurface)\n\n    // Create ocean floor with enhanced material\n    const floorGeometry = new THREE.PlaneGeometry(100, 100)\n    const floorMaterial = new THREE.MeshPhongMaterial({\n      color: 0x8b4513,\n      shininess: 30,\n      specular: 0x222222,\n    })\n    const floor = new THREE.Mesh(floorGeometry, floorMaterial)\n    floor.rotation.x = -Math.PI / 2\n    floor.position.y = -5\n    floor.receiveShadow = true\n    this.scene.add(floor)\n\n    // Create physics body for floor\n    const floorPhysicsBody = this.physicsEngine.createBoxBody(\n      new THREE.Vector3(0, -5, 0),\n      new THREE.Vector3(100, 0.1, 100),\n      true // Static\n    )\n    floorPhysicsBody.type = 'environment'\n    this.physicsEngine.addRigidBody(floorPhysicsBody)\n\n    // Add coral/rocks with enhanced materials and lighting\n    for (let i = 0; i < 10; i++) {\n      const radius = 0.5 + Math.random() * 1.5\n      const geometry = new THREE.SphereGeometry(radius)\n\n      // Use MeshPhongMaterial for better lighting on all platforms\n      const hue = Math.random() * 0.3\n      const material = new THREE.MeshPhongMaterial({\n        color: new THREE.Color().setHSL(hue, 0.7, 0.5),\n        shininess: 60 + Math.random() * 40,\n        specular: new THREE.Color().setHSL(hue, 0.3, 0.8),\n        // Add slight transparency for underwater effect\n        transparent: true,\n        opacity: 0.9,\n      })\n\n      const coral = new THREE.Mesh(geometry, material)\n\n      const position = new THREE.Vector3(\n        (Math.random() - 0.5) * 80,\n        -4 + Math.random() * 2,\n        (Math.random() - 0.5) * 80\n      )\n      coral.position.copy(position)\n      coral.castShadow = true\n      coral.receiveShadow = true\n      this.scene.add(coral)\n\n      // Add physics body for collision\n      const coralPhysicsBody = this.physicsEngine.createSphereBody(\n        position,\n        radius * 1.2, // Slightly larger for collision detection\n        true // Static\n      )\n      coralPhysicsBody.type = 'environment'\n      coralPhysicsBody.mesh = coral // Reference to visual representation\n      this.physicsEngine.addRigidBody(coralPhysicsBody)\n      this.environmentObjects.push({\n        mesh: coral,\n        physicsBody: coralPhysicsBody,\n      })\n    }\n  }\n\n  createPlayer() {\n    // Create enhanced player with physics\n    this.player = new Player(this.scene, this.physicsEngine)\n    console.log('ð Player created with physics')\n  }\n\n  /**\n   * Create the level completion gate\n   */\n  createGate() {\n    // Position gate at the back of the level\n    const gatePosition = new THREE.Vector3(0, 2, -20)\n    this.gate = new Gate(this.scene, this.physicsEngine, gatePosition)\n    console.log('ðª Gate created')\n  }\n\n  createSampleStars() {\n    this.stars = []\n\n    // Create star geometry variants for visual variety\n    const starVariants = StarGeometry.createVariants()\n\n    // Create actual star-shaped collectibles with enhanced materials\n    for (let i = 0; i < 5; i++) {\n      // Use a random star variant for variety\n      const variant = starVariants[i % starVariants.length]\n      const starGeometry = variant.geometry.clone()\n      const starMaterial = variant.material.clone()\n\n      const star = new THREE.Mesh(starGeometry, starMaterial)\n      const position = new THREE.Vector3(\n        (Math.random() - 0.5) * 20,\n        Math.random() * 8 - 2,\n        (Math.random() - 0.5) * 20\n      )\n      star.position.copy(position)\n      star.castShadow = true\n\n      // Add physics body for collision detection\n      const starPhysicsBody = this.physicsEngine.createSphereBody(\n        position,\n        0.5, // Slightly larger for easier collection\n        true // Static - stars don't move\n      )\n      starPhysicsBody.type = 'collectible'\n      starPhysicsBody.mesh = star\n      starPhysicsBody.collected = false\n      this.physicsEngine.addRigidBody(starPhysicsBody)\n\n      // Add enhanced rotation animation and floating effect\n      star.userData = {\n        rotationSpeed: 0.02 + Math.random() * 0.02,\n        floatSpeed: 0.01 + Math.random() * 0.01,\n        floatOffset: Math.random() * Math.PI * 2,\n        originalY: position.y,\n        physicsBody: starPhysicsBody,\n        rotationAxis: new THREE.Vector3(\n          Math.random() - 0.5,\n          Math.random() - 0.5,\n          Math.random() - 0.5\n        ).normalize(),\n      }\n\n      this.stars.push({ mesh: star, physicsBody: starPhysicsBody })\n      this.scene.add(star)\n    }\n  }\n\n  setupEventListeners() {\n    // Handle window resize\n    window.addEventListener('resize', () => this.onWindowResize(), {\n      passive: true,\n    })\n\n    // Enhanced input handling\n    window.addEventListener('keydown', event => this.onKeyDown(event))\n    window.addEventListener('keyup', event => this.onKeyUp(event))\n\n    // Touch controls for mobile\n    if (this.isMobile) {\n      this.setupTouchControls()\n    }\n\n    // Settings modal functionality\n    this.setupSettingsModal()\n  }\n\n  onKeyDown(event) {\n    // Initialize audio on first user interaction\n    this.tryInitializeAudio()\n\n    switch (event.code) {\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.keys.forward = true\n        break\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.keys.backward = true\n        break\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.keys.left = true\n        break\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.keys.right = true\n        break\n      case 'Space':\n        this.inputState.keys.up = true\n        event.preventDefault()\n        break\n      case 'ShiftLeft':\n        this.inputState.keys.down = true\n        break\n    }\n  }\n\n  onKeyUp(event) {\n    switch (event.code) {\n      case 'ArrowUp':\n      case 'KeyW':\n        this.inputState.keys.forward = false\n        break\n      case 'ArrowDown':\n      case 'KeyS':\n        this.inputState.keys.backward = false\n        break\n      case 'ArrowLeft':\n      case 'KeyA':\n        this.inputState.keys.left = false\n        break\n      case 'ArrowRight':\n      case 'KeyD':\n        this.inputState.keys.right = false\n        break\n      case 'Space':\n        this.inputState.keys.up = false\n        break\n      case 'ShiftLeft':\n        this.inputState.keys.down = false\n        break\n    }\n  }\n\n  setupTouchControls() {\n    // Setup virtual joystick\n    this.setupVirtualJoystick()\n\n    // Setup mobile action buttons\n    this.setupMobileButtons()\n\n    // Touch control state for general canvas interactions\n    this.touchState = {\n      startX: 0,\n      startY: 0,\n      currentX: 0,\n      currentY: 0,\n      isActive: false,\n    }\n\n    // General canvas touch events (for swipe gestures)\n    this.canvas.addEventListener('touchstart', event => {\n      event.preventDefault()\n\n      // Initialize audio on first touch\n      this.tryInitializeAudio()\n\n      if (event.touches.length > 0) {\n        const touch = event.touches[0]\n        this.touchState.startX = touch.clientX\n        this.touchState.startY = touch.clientY\n        this.touchState.currentX = touch.clientX\n        this.touchState.currentY = touch.clientY\n        this.touchState.isActive = true\n      }\n    })\n\n    this.canvas.addEventListener('touchmove', event => {\n      event.preventDefault()\n      if (event.touches.length > 0 && this.touchState.isActive) {\n        const touch = event.touches[0]\n        this.touchState.currentX = touch.clientX\n        this.touchState.currentY = touch.clientY\n\n        // Calculate movement delta for swipe gestures\n        const deltaX = this.touchState.currentX - this.touchState.startX\n        const deltaY = this.touchState.currentY - this.touchState.startY\n\n        // Apply gentle swipe-based movement (subtle effect)\n        const moveSpeed = 0.05\n        const sensitivity = 3\n\n        if (Math.abs(deltaX) > 20) {\n          this.player.position.x += (deltaX / sensitivity) * moveSpeed * 0.01\n        }\n\n        if (Math.abs(deltaY) > 20) {\n          this.player.position.z += (deltaY / sensitivity) * moveSpeed * 0.01\n        }\n\n        this.updateCamera()\n      }\n    })\n\n    this.canvas.addEventListener('touchend', event => {\n      event.preventDefault()\n      this.touchState.isActive = false\n    })\n\n    this.canvas.addEventListener('touchcancel', event => {\n      event.preventDefault()\n      this.touchState.isActive = false\n    })\n  }\n\n  setupVirtualJoystick() {\n    const joystick = document.getElementById('virtualJoystick')\n    const knob = document.getElementById('joystickKnob')\n\n    if (!joystick || !knob) {\n      return\n    }\n\n    const joystickState = {\n      isActive: false,\n      centerX: 0,\n      centerY: 0,\n      currentX: 0,\n      currentY: 0,\n    }\n\n    joystick.addEventListener('touchstart', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (event.touches.length > 0) {\n        const touch = event.touches[0]\n        const rect = joystick.getBoundingClientRect()\n\n        joystickState.isActive = true\n        joystickState.centerX = rect.left + rect.width / 2\n        joystickState.centerY = rect.top + rect.height / 2\n        joystickState.currentX = touch.clientX\n        joystickState.currentY = touch.clientY\n\n        // Visual feedback - highlight joystick when active\n        joystick.style.borderColor = 'rgba(255, 255, 255, 0.6)'\n        joystick.style.background = 'rgba(0, 17, 34, 0.7)'\n\n        this.updateJoystickKnob(knob, joystickState, rect)\n      }\n    })\n\n    joystick.addEventListener('touchmove', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      if (event.touches.length > 0 && joystickState.isActive) {\n        const touch = event.touches[0]\n        const rect = joystick.getBoundingClientRect()\n\n        joystickState.currentX = touch.clientX\n        joystickState.currentY = touch.clientY\n\n        // Calculate movement vector\n        const deltaX = joystickState.currentX - joystickState.centerX\n        const deltaY = joystickState.currentY - joystickState.centerY\n        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)\n        const maxDistance = rect.width / 2 - 20\n\n        // Normalize and apply movement\n        if (distance > 5) {\n          const normalizedX = deltaX / maxDistance\n          const normalizedY = deltaY / maxDistance\n\n          // Update input state with improved sensitivity for mobile\n          this.inputState.joystick.x = Math.max(\n            -1,\n            Math.min(1, normalizedX * 1.2)\n          )\n          this.inputState.joystick.y = Math.max(\n            -1,\n            Math.min(1, normalizedY * 1.2)\n          )\n        } else {\n          this.inputState.joystick.x = 0\n          this.inputState.joystick.y = 0\n        }\n\n        this.updateJoystickKnob(knob, joystickState, rect)\n      }\n    })\n\n    joystick.addEventListener('touchend', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      joystickState.isActive = false\n      this.inputState.joystick.x = 0\n      this.inputState.joystick.y = 0\n\n      // Reset visual feedback\n      joystick.style.borderColor = 'rgba(255, 255, 255, 0.3)'\n      joystick.style.background = 'rgba(0, 17, 34, 0.5)'\n      knob.style.transform = 'translate(-50%, -50%)'\n    })\n\n    joystick.addEventListener('touchcancel', event => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      joystickState.isActive = false\n      this.inputState.joystick.x = 0\n      this.inputState.joystick.y = 0\n\n      // Reset visual feedback\n      joystick.style.borderColor = 'rgba(255, 255, 255, 0.3)'\n      joystick.style.background = 'rgba(0, 17, 34, 0.5)'\n      knob.style.transform = 'translate(-50%, -50%)'\n    })\n  }\n\n  updateJoystickKnob(knob, joystickState, rect) {\n    const deltaX = joystickState.currentX - joystickState.centerX\n    const deltaY = joystickState.currentY - joystickState.centerY\n    const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY)\n    const maxDistance = rect.width / 2 - 20\n\n    if (distance <= maxDistance) {\n      knob.style.transform = `translate(calc(-50% + ${deltaX}px), calc(-50% + ${deltaY}px))`\n    } else {\n      const angle = Math.atan2(deltaY, deltaX)\n      const x = Math.cos(angle) * maxDistance\n      const y = Math.sin(angle) * maxDistance\n      knob.style.transform = `translate(calc(-50% + ${x}px), calc(-50% + ${y}px))`\n    }\n  }\n\n  setupMobileButtons() {\n    const swimUpBtn = document.getElementById('swimUpBtn')\n    const swimDownBtn = document.getElementById('swimDownBtn')\n\n    if (swimUpBtn) {\n      // Add more responsive event handling\n      swimUpBtn.addEventListener('touchstart', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = true\n        swimUpBtn.style.background = 'rgba(255, 255, 255, 0.4)'\n      })\n\n      swimUpBtn.addEventListener('touchend', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = false\n        swimUpBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n\n      swimUpBtn.addEventListener('touchcancel', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimUp = false\n        swimUpBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n    }\n\n    if (swimDownBtn) {\n      // Add more responsive event handling\n      swimDownBtn.addEventListener('touchstart', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = true\n        swimDownBtn.style.background = 'rgba(255, 255, 255, 0.4)'\n      })\n\n      swimDownBtn.addEventListener('touchend', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = false\n        swimDownBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n\n      swimDownBtn.addEventListener('touchcancel', event => {\n        event.preventDefault()\n        event.stopPropagation()\n        this.inputState.mobileButtons.swimDown = false\n        swimDownBtn.style.background = 'rgba(0, 17, 34, 0.6)'\n      })\n    }\n  }\n\n  setupSettingsModal() {\n    const settingsButton = document.getElementById('settingsButton')\n    const settingsModal = document.getElementById('settingsModal')\n    const closeSettings = document.getElementById('closeSettings')\n\n    if (settingsButton && settingsModal && closeSettings) {\n      // Open settings\n      const openSettings = event => {\n        if (event) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        settingsModal.classList.remove('hidden')\n        // Prevent body scrolling when modal is open\n        document.body.style.overflow = 'hidden'\n      }\n\n      // Close settings\n      const closeModal = event => {\n        if (event) {\n          event.preventDefault()\n          event.stopPropagation()\n        }\n        settingsModal.classList.add('hidden')\n        // Restore body scrolling\n        document.body.style.overflow = ''\n      }\n\n      // Simple event handling - click events work on both desktop and mobile\n      settingsButton.addEventListener('click', openSettings)\n      closeSettings.addEventListener('click', closeModal)\n\n      // Close on background click - simplified and more reliable detection\n      settingsModal.addEventListener('click', event => {\n        // Check if the click target is the modal background itself (not a child element)\n        if (event.target === settingsModal) {\n          closeModal(event)\n        }\n      })\n\n      // Close on escape key\n      document.addEventListener('keydown', event => {\n        if (\n          event.key === 'Escape' &&\n          !settingsModal.classList.contains('hidden')\n        ) {\n          closeModal()\n        }\n      })\n    }\n  }\n\n  onWindowResize() {\n    this.camera.aspect = window.innerWidth / window.innerHeight\n    this.camera.updateProjectionMatrix()\n    this.renderer.setSize(window.innerWidth, window.innerHeight)\n  }\n\n  updateCamera() {\n    // Enhanced camera follow logic\n    const playerPosition = this.player.getPosition()\n    const offset = new THREE.Vector3(0, 5, 10)\n    const targetPosition = playerPosition.clone().add(offset)\n\n    this.camera.position.lerp(targetPosition, 0.1)\n    this.camera.lookAt(playerPosition)\n  }\n\n  startGameLoop() {\n    const animate = currentTime => {\n      requestAnimationFrame(animate)\n\n      // Calculate delta time\n      const deltaTime =\n        this.lastTime > 0 ? (currentTime - this.lastTime) / 1000 : 0.016\n      this.lastTime = currentTime\n\n      this.update(deltaTime)\n      this.render()\n    }\n    animate(0)\n  }\n\n  update(deltaTime) {\n    if (!this.isLoaded) {\n      return\n    }\n\n    // Clamp delta time to prevent large jumps\n    deltaTime = Math.min(deltaTime, 0.033) // Max 30fps equivalent\n\n    // Update physics engine\n    this.physicsEngine.update(deltaTime)\n\n    // Update player with input and check for movement sounds\n    const previousPosition = this.player.getPosition().clone()\n    this.player.handleInput(this.inputState)\n    this.player.update()\n\n    // Play swimming sounds when player is moving\n    if (this.audioEngine && this.audioEngine.isInitialized) {\n      const currentPosition = this.player.getPosition()\n      const movementDistance = previousPosition.distanceTo(currentPosition)\n\n      // Play swimming sound if moving fast enough\n      if (movementDistance > 0.01) {\n        // Only play swimming sound occasionally to avoid spam\n        if (Math.random() < 0.05) {\n          // 5% chance per frame when moving\n          this.audioEngine.playSound('swimming', currentPosition)\n        }\n      }\n    }\n\n    // Update particle system\n    this.particleSystem.update(deltaTime)\n\n    // Update gate animations\n    if (this.gate) {\n      this.gate.update(deltaTime)\n    }\n\n    // Update audio system\n    if (this.audioEngine && this.audioEngine.isInitialized) {\n      const playerPos = this.player.getPosition()\n      const forward = this.camera.getWorldDirection(new THREE.Vector3())\n      const up = this.camera.up\n      this.audioEngine.updateListenerPosition(playerPos, forward, up)\n    }\n\n    // Update camera\n    this.updateCamera()\n\n    // Update UI (including depth meter)\n    this.updateUI()\n\n    // Animate stars with enhanced floating and rotation effects\n    this.stars.forEach(starData => {\n      const star = starData.mesh\n      const userData = star.userData\n\n      // Enhanced rotation animation using the custom rotation axis\n      if (userData.rotationAxis) {\n        star.rotateOnAxis(userData.rotationAxis, userData.rotationSpeed)\n      } else {\n        // Fallback rotation\n        star.rotation.y += userData.rotationSpeed\n        star.rotation.x += userData.rotationSpeed * 0.5\n      }\n\n      // Floating animation\n      const time = Date.now() * 0.001\n      const floatY =\n        userData.originalY +\n        Math.sin(time * userData.floatSpeed + userData.floatOffset) * 0.3\n      star.position.y = floatY\n\n      // Pulsing emissive effect with more dynamic variation\n      const pulseFactor = 0.3 + Math.sin(time * 2 + userData.floatOffset) * 0.1\n      star.material.emissiveIntensity = pulseFactor\n    })\n\n    // Animate volumetric lights for underwater caustics effect\n    if (this.volumetricLights) {\n      const time = Date.now() * 0.001\n      this.volumetricLights.forEach(light => {\n        const userData = light.userData\n        const animationTime =\n          time * userData.animationSpeed + userData.animationOffset\n\n        // Create gentle swaying motion\n        const offsetX = Math.sin(animationTime) * userData.animationRadius\n        const offsetZ = Math.cos(animationTime * 1.3) * userData.animationRadius\n        const offsetY = Math.sin(animationTime * 0.7) * 1\n\n        light.position.x = userData.originalPosition.x + offsetX\n        light.position.y = userData.originalPosition.y + offsetY\n        light.position.z = userData.originalPosition.z + offsetZ\n\n        // Subtle intensity variation for flickering water caustics\n        const intensityVariation = 0.8 + Math.sin(animationTime * 3) * 0.2\n        light.intensity = (this.isMobile ? 0.6 : 0.8) * intensityVariation\n      })\n    }\n\n    // Check star collection using collision detection\n    this.checkStarCollection()\n\n    // Check gate collision\n    this.checkGateCollision()\n  }\n\n  checkStarCollection() {\n    // Get player collisions from physics engine\n    const playerCollisions = this.physicsEngine.collisionSystem.checkCollisions(\n      this.player.physicsBody\n    )\n\n    for (const collision of playerCollisions) {\n      if (collision.type === 'collectible' && !collision.collected) {\n        // Collect star\n        collision.collected = true\n\n        // Find and remove the star from scene and physics\n        const starData = this.stars.find(s => s.physicsBody === collision)\n        if (starData) {\n          // Remove from scene\n          this.scene.remove(starData.mesh)\n\n          // Remove from physics\n          this.physicsEngine.removeRigidBody(starData.physicsBody)\n\n          // Remove from stars array\n          const index = this.stars.indexOf(starData)\n          if (index !== -1) {\n            this.stars.splice(index, 1)\n          }\n\n          // Update game state\n          this.starCount++\n          this.updateUI()\n\n          // Play collection sound\n          if (this.audioEngine) {\n            this.audioEngine.playSound('starCollect', starData.mesh.position)\n          }\n\n          // Create collection effect\n          this.particleSystem.createBurst(starData.mesh.position, {\n            count: 15,\n            life: 1.5,\n            velocity: new THREE.Vector3(0, 2, 0),\n            velocityVariation: new THREE.Vector3(3, 3, 3),\n            color: new THREE.Color(0xffd700),\n            size: { min: 3, max: 8 },\n          })\n\n          console.log(`â­ Star collected! Total: ${this.starCount}`)\n\n          // Check if all stars collected - activate gate\n          if (this.stars.length === 0) {\n            this.activateGate()\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Activate the gate when all stars are collected\n   */\n  activateGate() {\n    if (this.gate && !this.gate.getIsActivated()) {\n      this.gate.activate()\n\n      // Play gate activation sound\n      if (this.audioEngine) {\n        this.audioEngine.playSound('gateActivate', this.gate.getPosition())\n      }\n\n      console.log('ðª Gate activated! Swim through to complete level!')\n    }\n  }\n\n  /**\n   * Check for gate collision and level completion\n   */\n  checkGateCollision() {\n    if (!this.gate || !this.gate.getIsActivated()) {\n      return\n    }\n\n    // Get player collisions from physics engine\n    const playerCollisions = this.physicsEngine.collisionSystem.checkCollisions(\n      this.player.physicsBody\n    )\n\n    for (const collision of playerCollisions) {\n      if (collision.type === 'gate' && collision.gate) {\n        const levelCompleted = collision.gate.onPlayerEnter()\n        if (levelCompleted) {\n          this.levelComplete()\n          break\n        }\n      }\n    }\n  }\n\n  levelComplete() {\n    console.log('ð Level Complete!')\n\n    // Play level completion sound\n    if (this.audioEngine) {\n      this.audioEngine.playSound('levelComplete')\n    }\n\n    this.levelNumber++\n\n    // Reset gate for next level\n    if (this.gate) {\n      this.gate.reset()\n    }\n\n    // Reset level with new stars\n    this.createSampleStars()\n    this.updateUI()\n  }\n\n  updateUI() {\n    document.getElementById('starCount').textContent = this.starCount\n    document.getElementById('levelNumber').textContent = this.levelNumber\n\n    // Update depth meter based on player Y position\n    if (this.player) {\n      const playerPosition = this.player.getPosition()\n      // Water surface is at Y=5, so depth = surface level - current Y position\n      const waterSurface = 5.0\n      const depth = Math.max(0, waterSurface - playerPosition.y)\n      document.getElementById('depthMeter').textContent = depth.toFixed(1)\n    }\n  }\n\n  render() {\n    try {\n      if (this.renderer && this.scene && this.camera) {\n        this.renderer.render(this.scene, this.camera)\n      }\n    } catch (error) {\n      // Silently handle WebGL render errors to prevent spam\n      if (this.webglErrorCount < 5) {\n        console.warn('WebGL render error:', error)\n        this.webglErrorCount = (this.webglErrorCount || 0) + 1\n      }\n    }\n  }\n\n  hideLoading() {\n    const loadingElement = document.getElementById(CONFIG.loadingId)\n    if (loadingElement) {\n      loadingElement.classList.add('hidden')\n    }\n  }\n\n  showUI() {\n    const uiElement = document.getElementById(CONFIG.uiId)\n    if (uiElement) {\n      uiElement.classList.remove('hidden')\n    }\n    this.updateUI()\n  }\n\n  showError(message) {\n    const loadingElement = document.getElementById(CONFIG.loadingId)\n    if (loadingElement) {\n      loadingElement.innerHTML = `\n        <div style=\"color: #ff4444; text-align: center;\">\n          <h3>â ï¸ Error Loading Game</h3>\n          <p>${message}</p>\n          <p style=\"margin-top: 20px; font-size: 14px; color: #ccc;\">\n            Please check the browser console for more details and try refreshing the page.\n          </p>\n        </div>\n      `\n      loadingElement.classList.remove('hidden')\n    }\n  }\n\n  detectMobile() {\n    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n      navigator.userAgent\n    )\n  }\n}\n\n// Initialize the game when the page loads\nwindow.addEventListener(\n  'DOMContentLoaded',\n  async () => {\n    try {\n      console.log('ð Ocean Adventure - Starting initialization...')\n      const game = new OceanAdventure()\n      await game.initialize()\n    } catch (error) {\n      console.error('â Critical error during game initialization:', error)\n      // Show error in loading div if game initialization fails\n      const loadingElement = document.getElementById('loading')\n      if (loadingElement) {\n        loadingElement.innerHTML = `\n          <div style=\"color: #ff4444; text-align: center;\">\n            <h3>â ï¸ Critical Error</h3>\n            <p>Failed to initialize Ocean Adventure: ${error.message}</p>\n            <p style=\"margin-top: 20px; font-size: 14px; color: #ccc;\">\n              Please check the browser console for more details and try refreshing the page.\n            </p>\n          </div>\n        `\n      }\n    }\n  },\n  { passive: true }\n)\n\n// Handle WebGL context loss\nwindow.addEventListener(\n  'webglcontextlost',\n  event => {\n    event.preventDefault()\n    console.warn('WebGL context lost')\n  },\n  { passive: false }\n)\n\nwindow.addEventListener(\n  'webglcontextrestored',\n  () => {\n    console.log('WebGL context restored')\n    // Reinitialize game here if needed\n  },\n  { passive: true }\n)\n\n// Performance optimization: Pause game when page is hidden\ndocument.addEventListener(\n  'visibilitychange',\n  () => {\n    if (document.hidden) {\n      // Page is hidden, reduce performance\n      console.log('Game paused due to page visibility')\n    } else {\n      // Page is visible, resume normal performance\n      console.log('Game resumed')\n    }\n  },\n  { passive: true }\n)\n"],"names":["CollisionSystem","collider","isStatic","index","objectA","objectB","sphereA","sphereB","distance","radiusSum","boxA","boxB","minA","maxA","minB","maxB","sphere","box","boxMin","boxMax","closestPoint","THREE.Vector3","object","collisions","UnderwaterPhysics","body","deltaTime","buoyancy","currentStrength","currentForce","PhysicsEngine","previousPosition","gravityForce","velocityDelta","collision","collisionPairs","i","bodyA","bodyB","position","radius","size","Particle","velocity","life","color","ParticleSystem","scene","maxParticles","particle","THREE.Color","THREE.BufferGeometry","THREE.BufferAttribute","THREE.ShaderMaterial","THREE.AdditiveBlending","THREE.Points","canvas","context","gradient","texture","THREE.Texture","emitterConfig","emitter","p","config","count","velocityVariation","burstVelocity","particleSize","emissionInterval","activeCount","index3","type","active","e","AudioEngine","error","soundName","currentTime","oscillator","gainNode","lfo","lfoGain","envelope","attackTime","decayTime","sustainLevel","releaseTime","harmonicOscillators","harmonic","harmonicOsc","harmonicGain","panner","noteDuration","frequency","startTime","note","layer","forward","up","volume","Player","physicsEngine","geometry","THREE.CapsuleGeometry","material","THREE.MeshPhongMaterial","THREE.Mesh","inputState","force","targetRotation","THREE.MathUtils","time","floatingOffset","collectible","obstacle","direction","Gate","gateGeometry","THREE.TorusGeometry","gateMaterial","portalGeometry","THREE.PlaneGeometry","portalMaterial","THREE.MeshBasicMaterial","THREE.DoubleSide","THREE.PointLight","numRimLights","angle","rimLight","lightRadius","ringRadius","segments","x","y","segmentPosition","segmentBody","light","visible","pulseIntensity","userData","animationTime","pulseFactor","wobble","StarGeometry","innerRadius","outerRadius","points","depth","starShape","THREE.Shape","halfAngleStep","extrudeSettings","starGeometry","THREE.ExtrudeGeometry","emissiveIntensity","variants","CONFIG","OceanAdventure","steps","step","stepError","THREE.WebGLRenderer","THREE.BasicShadowMap","THREE.PCFSoftShadowMap","THREE.SRGBColorSpace","THREE.ACESFilmicToneMapping","gl","THREE.Scene","THREE.PerspectiveCamera","ambientLight","THREE.AmbientLight","directionalLight","THREE.DirectionalLight","shadowMapSize","lightColors","lightCount","pointLight","waterSurfaceGeometry","waterSurfaceMaterial","waterSurface","floorGeometry","floorMaterial","floor","floorPhysicsBody","THREE.SphereGeometry","hue","coral","coralPhysicsBody","gatePosition","starVariants","variant","starMaterial","star","starPhysicsBody","event","touch","deltaX","deltaY","moveSpeed","sensitivity","joystick","knob","joystickState","rect","maxDistance","normalizedX","normalizedY","swimUpBtn","swimDownBtn","settingsButton","settingsModal","closeSettings","openSettings","closeModal","playerPosition","offset","targetPosition","animate","currentPosition","playerPos","starData","floatY","offsetX","offsetZ","offsetY","intensityVariation","playerCollisions","loadingElement","uiElement","message"],"mappings":"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"}