import{W as v,P as g,S,a as b,A as L,D as M,b as E,M as d,c as l,d as w,C,e as x,V as D}from"./three-C8DEJ8Nj.js";function I(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))e(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const p={canvasId:"gameCanvas",loadingId:"loading",uiId:"ui"};class B{constructor(){this.scene=null,this.camera=null,this.renderer=null,this.canvas=null,this.isLoaded=!1,this.isMobile=this.detectMobile(),this.starCount=0,this.levelNumber=1,console.log("üåä Ocean Adventure - Initializing...")}async initialize(){try{this.setupCanvas(),this.setupRenderer(),this.setupScene(),this.setupCamera(),this.setupLights(),this.setupEventListeners(),this.hideLoading(),this.showUI(),this.startGameLoop(),this.isLoaded=!0,console.log("üéÆ Ocean Adventure - Ready to play!")}catch(t){console.error("‚ùå Failed to initialize game:",t)}}setupCanvas(){if(this.canvas=document.getElementById(p.canvasId),!this.canvas)throw new Error("Game canvas not found")}setupRenderer(){this.renderer=new v({canvas:this.canvas,antialias:!this.isMobile,alpha:!1}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.setClearColor(4386,1),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=g}setupScene(){this.scene=new S,this.createUnderwaterEnvironment(),this.createPlayer(),this.createSampleStars()}setupCamera(){this.camera=new b(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,5,10),this.camera.lookAt(0,0,0)}setupLights(){const t=new L(4210816,.4);this.scene.add(t);const s=new M(8900331,.8);s.position.set(0,50,0),s.castShadow=!0,s.shadow.mapSize.width=2048,s.shadow.mapSize.height=2048,this.scene.add(s)}createUnderwaterEnvironment(){const t=new E(100,100),s=new d({color:9127187}),e=new l(t,s);e.rotation.x=-Math.PI/2,e.position.y=-5,e.receiveShadow=!0,this.scene.add(e);for(let n=0;n<10;n++){const i=new w(.5+Math.random()*1.5),o=new d({color:new C().setHSL(Math.random()*.3,.7,.5)}),a=new l(i,o);a.position.set((Math.random()-.5)*80,-4+Math.random()*2,(Math.random()-.5)*80),a.castShadow=!0,this.scene.add(a)}}createPlayer(){const t=new x(.5,1.5),s=new d({color:65416});this.player=new l(t,s),this.player.position.set(0,0,0),this.player.castShadow=!0,this.scene.add(this.player)}createSampleStars(){this.stars=[];for(let t=0;t<5;t++){const s=new w(.3),e=new d({color:16766720,emissive:16766720,emissiveIntensity:.3}),n=new l(s,e);n.position.set((Math.random()-.5)*20,Math.random()*8-2,(Math.random()-.5)*20),n.userData={rotationSpeed:.02+Math.random()*.02},this.stars.push(n),this.scene.add(n)}}setupEventListeners(){window.addEventListener("resize",()=>this.onWindowResize()),window.addEventListener("keydown",t=>this.onKeyDown(t)),this.isMobile&&this.setupTouchControls()}setupTouchControls(){this.setupVirtualJoystick(),this.setupMobileButtons(),this.touchState={startX:0,startY:0,currentX:0,currentY:0,isActive:!1},this.canvas.addEventListener("touchstart",t=>{if(t.preventDefault(),t.touches.length>0){const s=t.touches[0];this.touchState.startX=s.clientX,this.touchState.startY=s.clientY,this.touchState.currentX=s.clientX,this.touchState.currentY=s.clientY,this.touchState.isActive=!0}}),this.canvas.addEventListener("touchmove",t=>{if(t.preventDefault(),t.touches.length>0&&this.touchState.isActive){const s=t.touches[0];this.touchState.currentX=s.clientX,this.touchState.currentY=s.clientY;const e=this.touchState.currentX-this.touchState.startX,n=this.touchState.currentY-this.touchState.startY,i=.05,o=3;Math.abs(e)>20&&(this.player.position.x+=e/o*i*.01),Math.abs(n)>20&&(this.player.position.z+=n/o*i*.01),this.updateCamera()}}),this.canvas.addEventListener("touchend",t=>{t.preventDefault(),this.touchState.isActive=!1}),this.canvas.addEventListener("touchcancel",t=>{t.preventDefault(),this.touchState.isActive=!1})}setupVirtualJoystick(){const t=document.getElementById("virtualJoystick"),s=document.getElementById("joystickKnob");if(!t||!s)return;const e={isActive:!1,centerX:0,centerY:0,currentX:0,currentY:0},n=.15;t.addEventListener("touchstart",i=>{if(i.preventDefault(),i.stopPropagation(),i.touches.length>0){const o=i.touches[0],a=t.getBoundingClientRect();e.isActive=!0,e.centerX=a.left+a.width/2,e.centerY=a.top+a.height/2,e.currentX=o.clientX,e.currentY=o.clientY,this.updateJoystickKnob(s,e,a)}}),t.addEventListener("touchmove",i=>{if(i.preventDefault(),i.stopPropagation(),i.touches.length>0&&e.isActive){const o=i.touches[0],a=t.getBoundingClientRect();e.currentX=o.clientX,e.currentY=o.clientY;const r=e.currentX-e.centerX,c=e.currentY-e.centerY,u=Math.sqrt(r*r+c*c),m=a.width/2-20;if(u>5){const f=r/m,y=c/m;this.player.position.x+=f*n*.03,this.player.position.z+=y*n*.03,this.updateCamera()}this.updateJoystickKnob(s,e,a)}}),t.addEventListener("touchend",i=>{i.preventDefault(),i.stopPropagation(),e.isActive=!1,s.style.transform="translate(-50%, -50%)"}),t.addEventListener("touchcancel",i=>{i.preventDefault(),i.stopPropagation(),e.isActive=!1,s.style.transform="translate(-50%, -50%)"})}updateJoystickKnob(t,s,e){const n=s.currentX-s.centerX,i=s.currentY-s.centerY,o=Math.sqrt(n*n+i*i),a=e.width/2-20;if(o<=a)t.style.transform="translate(calc(-50% + ".concat(n,"px), calc(-50% + ").concat(i,"px))");else{const r=Math.atan2(i,n),c=Math.cos(r)*a,u=Math.sin(r)*a;t.style.transform="translate(calc(-50% + ".concat(c,"px), calc(-50% + ").concat(u,"px))")}}setupMobileButtons(){const t=document.getElementById("swimUpBtn"),s=document.getElementById("swimDownBtn");t&&(t.addEventListener("touchstart",e=>{e.preventDefault(),e.stopPropagation(),this.mobileButtonState={swimUp:!0}}),t.addEventListener("touchend",e=>{e.preventDefault(),e.stopPropagation(),this.mobileButtonState={swimUp:!1}})),s&&(s.addEventListener("touchstart",e=>{e.preventDefault(),e.stopPropagation(),this.mobileButtonState={swimDown:!0}}),s.addEventListener("touchend",e=>{e.preventDefault(),e.stopPropagation(),this.mobileButtonState={swimDown:!1}})),this.mobileButtonState={swimUp:!1,swimDown:!1}}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onKeyDown(t){switch(t.code){case"ArrowUp":case"KeyW":this.player.position.z-=.2;break;case"ArrowDown":case"KeyS":this.player.position.z+=.2;break;case"ArrowLeft":case"KeyA":this.player.position.x-=.2;break;case"ArrowRight":case"KeyD":this.player.position.x+=.2;break;case"Space":this.player.position.y+=.2*.5;break;case"ShiftLeft":this.player.position.y-=.2*.5;break}this.updateCamera()}updateCamera(){const t=new D(0,5,10),s=this.player.position.clone().add(t);this.camera.position.lerp(s,.1),this.camera.lookAt(this.player.position)}startGameLoop(){const t=()=>{requestAnimationFrame(t),this.update(),this.render()};t()}update(){this.isLoaded&&(this.isMobile&&this.mobileButtonState&&(this.mobileButtonState.swimUp&&(this.player.position.y+=.2*.5,this.updateCamera()),this.mobileButtonState.swimDown&&(this.player.position.y-=.2*.5,this.updateCamera())),this.stars.forEach(t=>{t.rotation.y+=t.userData.rotationSpeed,t.rotation.x+=t.userData.rotationSpeed*.5}),this.checkStarCollection())}checkStarCollection(){this.stars.forEach((t,s)=>{this.player.position.distanceTo(t.position)<1&&(this.scene.remove(t),this.stars.splice(s,1),this.starCount++,this.updateUI(),console.log("‚≠ê Star collected! Total: ".concat(this.starCount)),this.stars.length===0&&this.levelComplete())})}levelComplete(){console.log("üéâ Level Complete!"),this.levelNumber++,this.createSampleStars(),this.updateUI()}updateUI(){document.getElementById("starCount").textContent=this.starCount,document.getElementById("levelNumber").textContent=this.levelNumber}render(){this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}hideLoading(){const t=document.getElementById(p.loadingId);t&&t.classList.add("hidden")}showUI(){const t=document.getElementById(p.uiId);t&&t.classList.remove("hidden"),this.updateUI()}detectMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}window.addEventListener("DOMContentLoaded",async()=>{await new B().initialize()});window.addEventListener("webglcontextlost",h=>{h.preventDefault(),console.warn("WebGL context lost")});window.addEventListener("webglcontextrestored",()=>{console.log("WebGL context restored")});export{I as __vite_legacy_guard};
//# sourceMappingURL=index-sHf8xng9.js.map
