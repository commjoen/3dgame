import{W as p,P as u,S as m,a as w,A as f,D as y,b as v,M as r,c as d,d as l,C as g,e as S,V as L}from"./three-DCYS8xdm.js";function M(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}})();const h={canvasId:"gameCanvas",loadingId:"loading",uiId:"ui"};class b{constructor(){this.scene=null,this.camera=null,this.renderer=null,this.canvas=null,this.isLoaded=!1,this.isMobile=this.detectMobile(),this.starCount=0,this.levelNumber=1,console.log("üåä Ocean Adventure - Initializing...")}async initialize(){try{this.setupCanvas(),this.setupRenderer(),this.setupScene(),this.setupCamera(),this.setupLights(),this.setupEventListeners(),this.hideLoading(),this.showUI(),this.startGameLoop(),this.isLoaded=!0,console.log("üéÆ Ocean Adventure - Ready to play!")}catch(e){console.error("‚ùå Failed to initialize game:",e)}}setupCanvas(){if(this.canvas=document.getElementById(h.canvasId),!this.canvas)throw new Error("Game canvas not found")}setupRenderer(){this.renderer=new p({canvas:this.canvas,antialias:!this.isMobile,alpha:!1}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.renderer.setClearColor(4386,1),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=u}setupScene(){this.scene=new m,this.createUnderwaterEnvironment(),this.createPlayer(),this.createSampleStars()}setupCamera(){this.camera=new w(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(0,5,10),this.camera.lookAt(0,0,0)}setupLights(){const e=new f(4210816,.4);this.scene.add(e);const s=new y(8900331,.8);s.position.set(0,50,0),s.castShadow=!0,s.shadow.mapSize.width=2048,s.shadow.mapSize.height=2048,this.scene.add(s)}createUnderwaterEnvironment(){const e=new v(100,100),s=new r({color:9127187}),n=new d(e,s);n.rotation.x=-Math.PI/2,n.position.y=-5,n.receiveShadow=!0,this.scene.add(n);for(let t=0;t<10;t++){const i=new l(.5+Math.random()*1.5),o=new r({color:new g().setHSL(Math.random()*.3,.7,.5)}),c=new d(i,o);c.position.set((Math.random()-.5)*80,-4+Math.random()*2,(Math.random()-.5)*80),c.castShadow=!0,this.scene.add(c)}}createPlayer(){const e=new S(.5,1.5),s=new r({color:65416});this.player=new d(e,s),this.player.position.set(0,0,0),this.player.castShadow=!0,this.scene.add(this.player)}createSampleStars(){this.stars=[];for(let e=0;e<5;e++){const s=new l(.3),n=new r({color:16766720,emissive:16766720,emissiveIntensity:.3}),t=new d(s,n);t.position.set((Math.random()-.5)*20,Math.random()*8-2,(Math.random()-.5)*20),t.userData={rotationSpeed:.02+Math.random()*.02},this.stars.push(t),this.scene.add(t)}}setupEventListeners(){window.addEventListener("resize",()=>this.onWindowResize()),window.addEventListener("keydown",e=>this.onKeyDown(e)),this.isMobile&&this.setupTouchControls()}setupTouchControls(){this.canvas.addEventListener("touchstart",e=>{e.preventDefault()}),this.canvas.addEventListener("touchmove",e=>{e.preventDefault()})}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}onKeyDown(e){switch(e.code){case"ArrowUp":case"KeyW":this.player.position.z-=.2;break;case"ArrowDown":case"KeyS":this.player.position.z+=.2;break;case"ArrowLeft":case"KeyA":this.player.position.x-=.2;break;case"ArrowRight":case"KeyD":this.player.position.x+=.2;break;case"Space":this.player.position.y+=.2*.5;break;case"ShiftLeft":this.player.position.y-=.2*.5;break}this.updateCamera()}updateCamera(){const e=new L(0,5,10),s=this.player.position.clone().add(e);this.camera.position.lerp(s,.1),this.camera.lookAt(this.player.position)}startGameLoop(){const e=()=>{requestAnimationFrame(e),this.update(),this.render()};e()}update(){this.isLoaded&&(this.stars.forEach(e=>{e.rotation.y+=e.userData.rotationSpeed,e.rotation.x+=e.userData.rotationSpeed*.5}),this.checkStarCollection())}checkStarCollection(){this.stars.forEach((e,s)=>{this.player.position.distanceTo(e.position)<1&&(this.scene.remove(e),this.stars.splice(s,1),this.starCount++,this.updateUI(),console.log("‚≠ê Star collected! Total: ".concat(this.starCount)),this.stars.length===0&&this.levelComplete())})}levelComplete(){console.log("üéâ Level Complete!"),this.levelNumber++,this.createSampleStars(),this.updateUI()}updateUI(){document.getElementById("starCount").textContent=this.starCount,document.getElementById("levelNumber").textContent=this.levelNumber}render(){this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)}hideLoading(){const e=document.getElementById(h.loadingId);e&&e.classList.add("hidden")}showUI(){const e=document.getElementById(h.uiId);e&&e.classList.remove("hidden"),this.updateUI()}detectMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}window.addEventListener("DOMContentLoaded",async()=>{await new b().initialize()});window.addEventListener("webglcontextlost",a=>{a.preventDefault(),console.warn("WebGL context lost")});window.addEventListener("webglcontextrestored",()=>{console.log("WebGL context restored")});export{M as __vite_legacy_guard};
//# sourceMappingURL=index-CV2QIRn2.js.map
